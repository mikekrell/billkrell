/*! Fri Dec 04 2020 14:40:27 GMT-0700 (Mountain Standard Time) * Copyright (c) 2020 Creative Market. All Rights Reserved. */
define("jquery",[],function(){return window.jQuery}),function(e){function t(i){function s(e){return e&&"object"==typeof e&&!Fn(e)&&tn.call(e,"__wrapped__")?e:new Y(e)}function N(e){var t=e.length,n=t>=c;if(n)for(var i={},r=-1;++r<t;){var s=l+e[r];(i[s]||(i[s]=[])).push(e[r])}return function(t){if(n){var r=l+t;return i[r]&&We(i[r],t)>-1}return We(e,t)>-1}}function q(e){return e.charCodeAt(0)}function R(e,t){var n=e.index,i=t.index;if(e=e.criteria,t=t.criteria,e!==t){if(e>t||"undefined"==typeof e)return 1;if(e<t||"undefined"==typeof t)return-1}return n<i?-1:1}function U(e,t,n,i){function r(){var i=arguments,c=o?this:t;if(s||(e=t[a]),n.length&&(i=i.length?(i=gn.call(i),l?i.concat(n):n.concat(i)):n),this instanceof r){G.prototype=e.prototype,c=new G,G.prototype=null;var u=e.apply(c,i);return de(u)?u:c}return e.apply(c,i)}var s=ue(e),o=!n,a=t;if(o){var l=i;n=t}else if(!s){if(!i)throw new Ht;t=e}return r}function z(){for(var e,t={shadowedProps:C,arrays:"isArray(iterable)",bottom:"",init:"iterable",loop:"",top:"",useHas:!0,useKeys:!!Tn},n=0;e=arguments[n];n++)for(var i in e)t[i]=e[i];var r=t.args;t.firstArg=/^[^,]+/.exec(r)[0];var o=qt("hasOwnProperty, isArguments, isArray, isString, keys, lodash, objectTypes","return function("+r+") {\n"+_n(t)+"\n}");return o(tn,X,Fn,ge,Tn,s,j)}function B(e){return"\\"+L[e]}function V(e){return Dn[e]}function H(e){return"function"!=typeof e.toString&&"string"==typeof(e+"")}function Y(e){this.__wrapped__=e}function G(){}function W(e){var t=!1;if(!e||on.call(e)!=E||!wn.argsClass&&X(e))return t;var n=e.constructor;return(ue(n)?n instanceof n:wn.nodeClass||!H(e))?wn.ownLast?(In(e,function(e,n,i){return t=tn.call(i,n),!1}),t===!0):(In(e,function(e,n){t=n}),t===!1||tn.call(e,t)):t}function J(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var i=-1,r=n-t||0,s=Lt(r<0?0:r);++i<r;)s[i]=e[t+i];return s}function K(e){return Pn[e]}function X(e){return on.call(e)==F}function Z(e,t,i,r,o,a){var l=e;if("function"==typeof t&&(r=i,i=t,t=!1),"function"==typeof i){if(i="undefined"==typeof r?i:s.createCallback(i,r,1),l=i(l),"undefined"!=typeof l)return l;l=e}var c=de(l);if(c){var u=on.call(l);if(!O[u]||!wn.nodeClass&&H(l))return l;var d=Fn(l)}if(!c||!t)return c?d?J(l):En({},l):l;var h=bn[u];switch(u){case T:case A:return new h((+l));case P:case I:return new h(l);case M:return h(l.source,m.exec(l))}o||(o=[]),a||(a=[]);for(var f=o.length;f--;)if(o[f]==e)return a[f];return l=d?h(l.length):{},d&&(tn.call(e,"index")&&(l.index=e.index),tn.call(e,"input")&&(l.input=e.input)),o.push(e),a.push(l),(d?De:On)(e,function(e,r){l[r]=Z(e,t,i,n,o,a)}),l}function Q(e,t,n){return Z(e,!0,t,n)}function ee(e,t,n){var i;return t=s.createCallback(t,n),On(e,function(e,n,r){if(t(e,n,r))return i=n,!1}),i}function te(e){var t=[];return In(e,function(e,n){ue(e)&&t.push(n)}),t.sort()}function ne(e,t){return!!e&&tn.call(e,t)}function ie(e){for(var t=-1,n=Tn(e),i=n.length,r={};++t<i;){var s=n[t];r[e[s]]=s}return r}function re(e){return e===!0||e===!1||on.call(e)==T}function se(e){return!!e&&("object"==typeof e&&on.call(e)==A)}function oe(e){return!!e&&1===e.nodeType}function ae(e){var t=!0;if(!e)return t;var n=on.call(e),i=e.length;return n==S||n==I||(wn.argsClass?n==F:X(e))||n==E&&"number"==typeof i&&ue(e.splice)?!i:(On(e,function(){return t=!1}),t)}function le(e,t,n,i,r,o){var l=n===a;if("function"==typeof n&&!l){n=s.createCallback(n,i,2);var c=n(e,t);if("undefined"!=typeof c)return!!c}if(e===t)return 0!==e||1/e==1/t;var u=typeof e,d=typeof t;if(e===e&&(!e||"function"!=u&&"object"!=u)&&(!t||"function"!=d&&"object"!=d))return!1;if(null==e||null==t)return e===t;var h=on.call(e),f=on.call(t);if(h==F&&(h=E),f==F&&(f=E),h!=f)return!1;switch(h){case T:case A:return+e==+t;case P:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case M:case I:return e==Vt(t)}var p=h==S;if(!p){if(tn.call(e,"__wrapped__ ")||tn.call(t,"__wrapped__"))return le(e.__wrapped__||e,t.__wrapped__||t,n,i,r,o);if(h!=E||!wn.nodeClass&&(H(e)||H(t)))return!1;var m=!wn.argsObject&&X(e)?zt:e.constructor,g=!wn.argsObject&&X(t)?zt:t.constructor;if(m!=g&&!(ue(m)&&m instanceof m&&ue(g)&&g instanceof g))return!1}r||(r=[]),o||(o=[]);for(var v=r.length;v--;)if(r[v]==e)return o[v]==t;var y=0;if(c=!0,r.push(e),o.push(t),p){if(v=e.length,y=t.length,c=y==e.length,!c&&!l)return c;for(;y--;){var b=v,w=t[y];if(l)for(;b--&&!(c=le(e[b],w,n,i,r,o)););else if(!(c=le(e[y],w,n,i,r,o)))break}return c}return In(t,function(t,s,a){if(tn.call(a,s))return y++,c=tn.call(e,s)&&le(e[s],t,n,i,r,o)}),c&&!l&&In(e,function(e,t,n){if(tn.call(n,t))return c=--y>-1}),c}function ce(e){return cn(e)&&!un(parseFloat(e))}function ue(e){return"function"==typeof e}function de(e){return!!e&&j[typeof e]}function he(e){return pe(e)&&e!=+e}function fe(e){return null===e}function pe(e){return"number"==typeof e||on.call(e)==P}function me(e){return!!e&&(j[typeof e]&&on.call(e)==M)}function ge(e){return"string"==typeof e||on.call(e)==I}function ve(e){return"undefined"==typeof e}function ye(e,t,n){var i=arguments,r=0,o=2;if(!de(e))return e;if(n===a)var l=i[3],c=i[4],u=i[5];else c=[],u=[],"number"!=typeof n&&(o=i.length),o>3&&"function"==typeof i[o-2]?l=s.createCallback(i[--o-1],i[o--],2):o>2&&"function"==typeof i[o-1]&&(l=i[--o]);for(;++r<o;)(Fn(i[r])?De:On)(i[r],function(t,n){var i,r,s=t,o=e[n];if(t&&((r=Fn(t))||jn(t))){for(var d=c.length;d--;)if(i=c[d]==t){o=u[d];break}if(!i){var h;l&&(s=l(o,t),(h="undefined"!=typeof s)&&(o=s)),h||(o=r?Fn(o)?o:[]:jn(o)?o:{}),c.push(t),u.push(o),h||(o=ye(o,t,a,l,c,u))}}else l&&(s=l(o,t),"undefined"==typeof s&&(s=t)),"undefined"!=typeof s&&(o=s);e[n]=o});return e}function be(e,t,n){var i="function"==typeof t,r={};if(i)t=s.createCallback(t,n);else var o=Zt.apply(Yt,gn.call(arguments,1));return In(e,function(e,n,s){(i?!t(e,n,s):We(o,n)<0)&&(r[n]=e)}),r}function we(e){for(var t=-1,n=Tn(e),i=n.length,r=Lt(i);++t<i;){var s=n[t];r[t]=[s,e[s]]}return r}function _e(e,t,n){var i={};if("function"!=typeof t)for(var r=-1,o=Zt.apply(Yt,gn.call(arguments,1)),a=de(e)?o.length:0;++r<a;){var l=o[r];l in e&&(i[l]=e[l])}else t=s.createCallback(t,n),In(e,function(e,n,r){t(e,n,r)&&(i[n]=e)});return i}function xe(e){for(var t=-1,n=Tn(e),i=n.length,r=Lt(i);++t<i;)r[t]=e[n[t]];return r}function Ce(e){var t=-1,n=Zt.apply(Yt,gn.call(arguments,1)),i=n.length,r=Lt(i);for(wn.unindexedChars&&ge(e)&&(e=e.split(""));++t<i;)r[t]=e[n[t]];return r}function ke(e,t,n){var i=-1,r=e?e.length:0,s=!1;return n=(n<0?hn(0,r+n):n)||0,"number"==typeof r?s=(ge(e)?e.indexOf(t,n):We(e,t,n))>-1:An(e,function(e){if(++i>=n)return!(s=e===t)}),s}function Fe(e,t,n){var i={};return t=s.createCallback(t,n),De(e,function(e,n,r){n=Vt(t(e,n,r)),tn.call(i,n)?i[n]++:i[n]=1}),i}function Se(e,t,n){var i=!0;if(t=s.createCallback(t,n),Fn(e))for(var r=-1,o=e.length;++r<o&&(i=!!t(e[r],r,e)););else An(e,function(e,n,r){return i=!!t(e,n,r)});return i}function Te(e,t,n){var i=[];if(t=s.createCallback(t,n),Fn(e))for(var r=-1,o=e.length;++r<o;){var a=e[r];t(a,r,e)&&i.push(a)}else An(e,function(e,n,r){t(e,n,r)&&i.push(e)});return i}function Ae(e,t,n){if(t=s.createCallback(t,n),!Fn(e)){var i;return An(e,function(e,n,r){if(t(e,n,r))return i=e,!1}),i}for(var r=-1,o=e.length;++r<o;){var a=e[r];if(t(a,r,e))return a}}function De(e,t,n){if(t&&"undefined"==typeof n&&Fn(e))for(var i=-1,r=e.length;++i<r&&t(e[i],i,e)!==!1;);else An(e,t,n);return e}function Pe(e,t,n){var i={};return t=s.createCallback(t,n),De(e,function(e,n,r){n=Vt(t(e,n,r)),(tn.call(i,n)?i[n]:i[n]=[]).push(e)}),i}function Ee(e,t){var n=gn.call(arguments,2),i=-1,r="function"==typeof t,s=e?e.length:0,o=Lt("number"==typeof s?s:0);return De(e,function(e){o[++i]=(r?t:e[t]).apply(e,n)}),o}function Me(e,t,n){var i=-1,r=e?e.length:0,o=Lt("number"==typeof r?r:0);if(t=s.createCallback(t,n),Fn(e))for(;++i<r;)o[i]=t(e[i],i,e);else An(e,function(e,n,r){o[++i]=t(e,n,r)});return o}function Ie(e,t,n){var i=-(1/0),r=i;if(!t&&Fn(e))for(var o=-1,a=e.length;++o<a;){var l=e[o];l>r&&(r=l)}else t=!t&&ge(e)?q:s.createCallback(t,n),An(e,function(e,n,s){var o=t(e,n,s);o>i&&(i=o,r=e)});return r}function Oe(e,t,n){var i=1/0,r=i;if(!t&&Fn(e))for(var o=-1,a=e.length;++o<a;){var l=e[o];l<r&&(r=l)}else t=!t&&ge(e)?q:s.createCallback(t,n),An(e,function(e,n,s){var o=t(e,n,s);o<i&&(i=o,r=e)});return r}function je(e,t,n,i){var r=arguments.length<3;if(t=s.createCallback(t,i,4),Fn(e)){var o=-1,a=e.length;for(r&&(n=e[++o]);++o<a;)n=t(n,e[o],o,e)}else An(e,function(e,i,s){n=r?(r=!1,e):t(n,e,i,s)});return n}function Le(e,t,n,i){var r=e,o=e?e.length:0,a=arguments.length<3;if("number"!=typeof o){var l=Tn(e);o=l.length}else wn.unindexedChars&&ge(e)&&(r=e.split(""));return t=s.createCallback(t,i,4),De(e,function(e,i,s){i=l?l[--o]:--o,n=a?(a=!1,r[i]):t(n,r[i],i,s)}),n}function $e(e,t,n){return t=s.createCallback(t,n),Te(e,function(e,n,i){return!t(e,n,i)})}function Ne(e){var t=-1,n=e?e.length:0,i=Lt("number"==typeof n?n:0);return De(e,function(e){var n=Qt(mn()*(++t+1));i[t]=i[n],i[n]=e}),i}function qe(e){var t=e?e.length:0;return"number"==typeof t?t:Tn(e).length}function Re(e,t,n){var i;if(t=s.createCallback(t,n),Fn(e))for(var r=-1,o=e.length;++r<o&&!(i=t(e[r],r,e)););else An(e,function(e,n,r){return!(i=t(e,n,r))});return!!i}function Ue(e,t,n){var i=-1,r=e?e.length:0,o=Lt("number"==typeof r?r:0);for(t=s.createCallback(t,n),De(e,function(e,n,r){o[++i]={criteria:t(e,n,r),index:i,value:e}}),r=o.length,o.sort(R);r--;)o[r]=o[r].value;return o}function ze(e){return e&&"number"==typeof e.length?wn.unindexedChars&&ge(e)?e.split(""):J(e):xe(e)}function Be(e){for(var t=-1,n=e?e.length:0,i=[];++t<n;){var r=e[t];r&&i.push(r)}return i}function Ve(e){for(var t=-1,n=e?e.length:0,i=Zt.apply(Yt,gn.call(arguments,1)),r=N(i),s=[];++t<n;){var o=e[t];r(o)||s.push(o)}return s}function He(e,t,n){var i=-1,r=e?e.length:0;for(t=s.createCallback(t,n);++i<r;)if(t(e[i],i,e))return i;return-1}function Ye(e,t,n){if(e){var i=0,r=e.length;if("number"!=typeof t&&null!=t){var o=-1;for(t=s.createCallback(t,n);++o<r&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e[0];return J(e,0,fn(hn(0,i),r))}}function Ge(e,t,n,i){var r=-1,o=e?e.length:0,a=[];for("boolean"!=typeof t&&null!=t&&(i=n,n=t,t=!1),null!=n&&(n=s.createCallback(n,i));++r<o;){var l=e[r];n&&(l=n(l,r,e)),Fn(l)?nn.apply(a,t?l:Ge(l)):a.push(l)}return a}function We(e,t,n){var i=-1,r=e?e.length:0;if("number"==typeof n)i=(n<0?hn(0,r+n):n||0)-1;else if(n)return i=tt(e,t),e[i]===t?i:-1;for(;++i<r;)if(e[i]===t)return i;return-1}function Je(e,t,n){if(!e)return[];var i=0,r=e.length;if("number"!=typeof t&&null!=t){var o=r;for(t=s.createCallback(t,n);o--&&t(e[o],o,e);)i++}else i=null==t||n?1:t||i;return J(e,0,fn(hn(0,r-i),r))}function Ke(e){var t=arguments,n=t.length,i={0:{}},r=-1,s=e?e.length:0,o=s>=c,a=[],u=a;e:for(;++r<s;){var d=e[r];if(o)var h=l+d,f=i[0][h]?!(u=i[0][h]):u=i[0][h]=[];if(f||We(u,d)<0){o&&u.push(d);for(var p=n;--p;)if(!(i[p]||(i[p]=N(t[p])))(d))continue e;a.push(d)}}return a}function Xe(e,t,n){if(e){var i=0,r=e.length;if("number"!=typeof t&&null!=t){var o=r;for(t=s.createCallback(t,n);o--&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e[r-1];return J(e,hn(0,r-i))}}function Ze(e,t,n){var i=e?e.length:0;for("number"==typeof n&&(i=(n<0?hn(0,i+n):fn(n,i-1))+1);i--;)if(e[i]===t)return i;return-1}function Qe(e,t,n){e=+e||0,n=+n||1,null==t&&(t=e,e=0);for(var i=-1,r=hn(0,Kt((t-e)/n)),s=Lt(r);++i<r;)s[i]=e,e+=n;return s}function et(e,t,n){if("number"!=typeof t&&null!=t){var i=0,r=-1,o=e?e.length:0;for(t=s.createCallback(t,n);++r<o&&t(e[r],r,e);)i++}else i=null==t||n?1:hn(0,t);return J(e,i)}function tt(e,t,n,i){var r=0,o=e?e.length:r;for(n=n?s.createCallback(n,i,1):kt,t=n(t);r<o;){var a=r+o>>>1;n(e[a])<t?r=a+1:o=a}return r}function nt(e){return Fn(e)||(arguments[0]=e?gn.call(e):Yt),it(Zt.apply(Yt,arguments))}function it(e,t,n,i){var r=-1,o=e?e.length:0,a=[],u=a;"boolean"!=typeof t&&null!=t&&(i=n,n=t,t=!1);var d=!t&&o>=c;if(d)var h={};for(null!=n&&(u=[],n=s.createCallback(n,i));++r<o;){var f=e[r],p=n?n(f,r,e):f;if(d)var m=l+p,g=h[m]?!(u=h[m]):u=h[m]=[];(t?!r||u[u.length-1]!==p:g||We(u,p)<0)&&((n||d)&&u.push(p),a.push(f))}return a}function rt(e){for(var t=-1,n=e?e.length:0,i=n?Ie(Ln(e,"length")):0,r=Lt(i);++t<n;)for(var s=-1,o=e[t];++s<i;)(r[s]||(r[s]=Lt(n)))[t]=o[s];return r}function st(e){return Ve(e,gn.call(arguments,1))}function ot(e){for(var t=-1,n=e?Ie(Ln(arguments,"length")):0,i=Lt(n);++t<n;)i[t]=Ln(arguments,t);return i}function at(e,t){for(var n=-1,i=e?e.length:0,r={};++n<i;){var s=e[n];t?r[s]=t[n]:r[s[0]]=s[1]}return r}function lt(e,t){return e<1?t():function(){if(--e<1)return t.apply(this,arguments)}}function ct(e,t){return wn.fastBind||an&&arguments.length>2?an.call.apply(an,arguments):U(e,t,gn.call(arguments,2))}function ut(e){for(var t=arguments.length>1?Zt.apply(Yt,gn.call(arguments,1)):te(e),n=-1,i=t.length;++n<i;){var r=t[n];e[r]=ct(e[r],e)}return e}function dt(e,t){return U(e,t,gn.call(arguments,2),a)}function ht(){var e=arguments;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}}function ft(e,t,n){if(null==e)return kt;var i=typeof e;if("function"!=i){if("object"!=i)return function(t){return t[e]};var r=Tn(e);return function(t){for(var n=r.length,i=!1;n--&&(i=le(t[r[n]],e[r[n]],a)););return i}}return"undefined"!=typeof t?1===n?function(n){return e.call(t,n)}:2===n?function(n,i){return e.call(t,n,i)}:4===n?function(n,i,r,s){return e.call(t,n,i,r,s)}:function(n,i,r){return e.call(t,n,i,r)}:e}function pt(e,t,n){function i(){s=l=null,c&&(o=e.apply(a,r))}var r,s,o,a,l,c=!0;if(n===!0){var u=!0;c=!1}else n&&j[typeof n]&&(u=n.leading,c="trailing"in n?n.trailing:c);return function(){return r=arguments,a=this,Xt(l),!s&&u?(s=!0,o=e.apply(a,r)):l=sn(i,t),o}}function mt(e){var t=gn.call(arguments,1);return sn(function(){e.apply(n,t)},1)}function gt(e,t){var i=gn.call(arguments,2);return sn(function(){e.apply(n,i)},t)}function vt(e,t){var n={};return function(){var i=l+(t?t.apply(this,arguments):arguments[0]);return tn.call(n,i)?n[i]:n[i]=e.apply(this,arguments)}}function yt(e){var t,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function bt(e){return U(e,gn.call(arguments,1))}function wt(e){return U(e,gn.call(arguments,1),null,a)}function _t(e,t,n){function i(){a=null,u&&(l=new Nt,s=e.apply(o,r))}var r,s,o,a,l=0,c=!0,u=!0;return n===!1?c=!1:n&&j[typeof n]&&(c="leading"in n?n.leading:c,u="trailing"in n?n.trailing:u),function(){var n=new Nt;a||c||(l=n);var u=t-(n-l);return r=arguments,o=this,u<=0?(Xt(a),a=null,l=n,s=e.apply(o,r)):a||(a=sn(i,u)),s}}function xt(e,t){return function(){var n=[e];return nn.apply(n,arguments),t.apply(this,n)}}function Ct(e){return null==e?"":Vt(e).replace(w,V)}function kt(e){return e}function Ft(e){De(te(e),function(t){var n=s[t]=e[t];s.prototype[t]=function(){var e=this.__wrapped__,t=[e];nn.apply(t,arguments);var i=n.apply(s,t);return e&&"object"==typeof e&&e==i?this:new Y(i)}})}function St(){return i._=Wt,this}function Tt(e,t){return null==e&&null==t&&(t=1),e=+e||0,null==t&&(t=e,e=0),e+Qt(mn()*((+t||0)-e+1))}function At(e,t){var i=e?e[t]:n;return ue(i)?e[t]():i}function Dt(e,t,i){var r=s.templateSettings;e||(e=""),i=Mn({},i,r);var o,a=Mn({},i.imports,r.imports),l=Tn(a),c=xe(a),f=0,m=i.interpolate||b,v="__p += '",y=Bt((i.escape||b).source+"|"+m.source+"|"+(m===g?p:b).source+"|"+(i.evaluate||b).source+"|$","g");e.replace(y,function(t,n,i,r,s,a){return i||(i=r),v+=e.slice(f,a).replace(_,B),n&&(v+="' +\n__e("+n+") +\n'"),s&&(o=!0,v+="';\n"+s+";\n__p += '"),i&&(v+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),f=a+t.length,t}),v+="';\n";var w=i.variable,x=w;x||(w="obj",v="with ("+w+") {\n"+v+"\n}\n"),v=(o?v.replace(u,""):v).replace(d,"$1").replace(h,"$1;"),v="function("+w+") {\n"+(x?"":w+" || ("+w+" = {});\n")+"var __t, __p = '', __e = _.escape"+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+v+"return __p\n}";var C="\n/*\n//# sourceURL="+(i.sourceURL||"/lodash/template/source["+k++ +"]")+"\n*/";try{var F=qt(l,"return "+v+C).apply(n,c)}catch(S){throw S.source=v,S}return t?F(t):(F.source=v,F)}function Pt(e,t,n){e=(e=+e)>-1?e:0;var i=-1,r=Lt(e);for(t=s.createCallback(t,n,1);++i<e;)r[i]=t(i);return r}function Et(e){return null==e?"":Vt(e).replace(f,K)}function Mt(e){var t=++o;return Vt(null==e?"":e)+t}function It(e,t){return t(e),e}function Ot(){return Vt(this.__wrapped__)}function jt(){return this.__wrapped__}i=i?$.defaults(e.Object(),i,$.pick(e,x)):e;var Lt=i.Array,$t=i.Boolean,Nt=i.Date,qt=i.Function,Rt=i.Math,Ut=i.Number,zt=i.Object,Bt=i.RegExp,Vt=i.String,Ht=i.TypeError,Yt=Lt(),Gt=zt(),Wt=i._,Jt=Bt("^"+Vt(Gt.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Kt=Rt.ceil,Xt=i.clearTimeout,Zt=Yt.concat,Qt=Rt.floor,en=Jt.test(en=zt.getPrototypeOf)&&en,tn=Gt.hasOwnProperty,nn=Yt.push,rn=i.setImmediate,sn=i.setTimeout,on=Gt.toString,an=Jt.test(an=on.bind)&&an,ln=Jt.test(ln=Lt.isArray)&&ln,cn=i.isFinite,un=i.isNaN,dn=Jt.test(dn=zt.keys)&&dn,hn=Rt.max,fn=Rt.min,pn=i.parseInt,mn=Rt.random,gn=Yt.slice,vn=Jt.test(i.attachEvent),yn=an&&!/\n|true/.test(an+vn),bn={};bn[S]=Lt,bn[T]=$t,bn[A]=Nt,bn[E]=zt,bn[P]=Ut,bn[M]=Bt,bn[I]=Vt;var wn=s.support={};!function(){var e=function(){this.x=1},t={0:1,length:1},n=[];e.prototype={valueOf:1,y:1};for(var i in new e)n.push(i);for(i in arguments);wn.argsObject=arguments.constructor==zt&&!(arguments instanceof Lt),wn.argsClass=X(arguments),wn.enumPrototypes=e.propertyIsEnumerable("prototype"),wn.fastBind=an&&!yn,wn.ownLast="x"!=n[0],wn.nonEnumArgs=0!=i,wn.nonEnumShadows=!/valueOf/.test(n),wn.spliceObjects=(Yt.splice.call(t,0,1),!t[0]),wn.unindexedChars="x"[0]+zt("x")[0]!="xx";try{wn.nodeClass=!(on.call(document)==E&&!({toString:0}+""))}catch(r){wn.nodeClass=!0}}(1),s.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:g,variable:"",imports:{_:s}};var _n=function(e){var t="var index, iterable = "+e.firstArg+", result = "+e.init+";\nif (!iterable) return result;\n"+e.top+";\n";if(e.arrays?(t+="var length = iterable.length; index = -1;\nif ("+e.arrays+") {  ",wn.unindexedChars&&(t+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),t+="\n  while (++index < length) {\n    "+e.loop+"\n  }\n}\nelse {  "):wn.nonEnumArgs&&(t+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+e.loop+"\n    }\n  } else {  "),wn.enumPrototypes&&(t+="\n  var skipProto = typeof iterable == 'function';\n  "),e.useHas&&e.useKeys)t+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] ? keys(iterable) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    ",wn.enumPrototypes&&(t+="if (!(skipProto && index == 'prototype')) {\n  "),t+=e.loop,wn.enumPrototypes&&(t+="}\n"),t+="  }  ";else if(t+="\n  for (index in iterable) {",(wn.enumPrototypes||e.useHas)&&(t+="\n    if (",wn.enumPrototypes&&(t+="!(skipProto && index == 'prototype')"),wn.enumPrototypes&&e.useHas&&(t+=" && "),e.useHas&&(t+="hasOwnProperty.call(iterable, index)"),t+=") {    "),t+=e.loop+";    ",(wn.enumPrototypes||e.useHas)&&(t+="\n    }"),t+="\n  }    ",wn.nonEnumShadows){t+="\n\n  var ctor = iterable.constructor;\n      ";for(var n=0;n<7;n++)t+="\n  index = '"+e.shadowedProps[n]+"';\n  if (","constructor"==e.shadowedProps[n]&&(t+="!(ctor && ctor.prototype === iterable) && "),t+="hasOwnProperty.call(iterable, index)) {\n    "+e.loop+"\n  }      "}return(e.arrays||wn.nonEnumArgs)&&(t+="\n}"),t+=e.bottom+";\nreturn result"},xn={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},Cn={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : lodash.createCallback(callback, thisArg)",arrays:"typeof length == 'number'",loop:"if (callback(iterable[index], index, collection) === false) return result"},kn={top:"if (!objectTypes[typeof iterable]) return result;\n"+Cn.top,arrays:!1};Y.prototype=s.prototype,wn.argsClass||(X=function(e){return!!e&&tn.call(e,"callee")});var Fn=ln||function(e){return!!e&&("object"==typeof e&&on.call(e)==S)},Sn=z({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)",arrays:!1}),Tn=dn?function(e){return de(e)?wn.enumPrototypes&&"function"==typeof e||wn.nonEnumArgs&&e.length&&X(e)?Sn(e):dn(e):[]}:Sn,An=z(Cn),Dn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Pn=ie(Dn),En=z(xn,{top:xn.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = lodash.createCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),Mn=z(xn),In=z(Cn,kn,{useHas:!1}),On=z(Cn,kn);ue(/x/)&&(ue=function(e){return"function"==typeof e&&on.call(e)==D});var jn=en?function(e){if(!e||on.call(e)!=E||!wn.argsClass&&X(e))return!1;var t=e.valueOf,n="function"==typeof t&&(n=en(t))&&en(n);return n?e==n||en(e)==n:W(e)}:W,Ln=Me,$n=Te;yn&&r&&"function"==typeof rn&&(mt=ct(rn,i));var Nn=8==pn(v+"08")?pn:function(e,t){return pn(ge(e)?e.replace(y,""):e,t||0)};return s.after=lt,s.assign=En,s.at=Ce,s.bind=ct,s.bindAll=ut,s.bindKey=dt,s.compact=Be,s.compose=ht,s.countBy=Fe,s.createCallback=ft,s.debounce=pt,s.defaults=Mn,s.defer=mt,s.delay=gt,s.difference=Ve,s.filter=Te,s.flatten=Ge,s.forEach=De,s.forIn=In,s.forOwn=On,s.functions=te,s.groupBy=Pe,s.initial=Je,s.intersection=Ke,s.invert=ie,s.invoke=Ee,s.keys=Tn,s.map=Me,s.max=Ie,s.memoize=vt,s.merge=ye,s.min=Oe,s.omit=be,s.once=yt,s.pairs=we,s.partial=bt,s.partialRight=wt,s.pick=_e,s.pluck=Ln,s.range=Qe,s.reject=$e,s.rest=et,s.shuffle=Ne,s.sortBy=Ue,s.tap=It,s.throttle=_t,s.times=Pt,s.toArray=ze,s.union=nt,s.uniq=it,s.unzip=rt,s.values=xe,s.where=$n,s.without=st,s.wrap=xt,s.zip=ot,s.zipObject=at,s.collect=Me,s.drop=et,s.each=De,s.extend=En,s.methods=te,s.object=at,s.select=Te,s.tail=et,s.unique=it,Ft(s),s.clone=Z,s.cloneDeep=Q,s.contains=ke,s.escape=Ct,s.every=Se,s.find=Ae,s.findIndex=He,s.findKey=ee,s.has=ne,s.identity=kt,s.indexOf=We,s.isArguments=X,s.isArray=Fn,s.isBoolean=re,s.isDate=se,s.isElement=oe,s.isEmpty=ae,s.isEqual=le,s.isFinite=ce,s.isFunction=ue,s.isNaN=he,s.isNull=fe,s.isNumber=pe,s.isObject=de,s.isPlainObject=jn,s.isRegExp=me,s.isString=ge,s.isUndefined=ve,s.lastIndexOf=Ze,s.mixin=Ft,s.noConflict=St,s.parseInt=Nn,s.random=Tt,s.reduce=je,s.reduceRight=Le,s.result=At,s.runInContext=t,s.size=qe,s.some=Re,s.sortedIndex=tt,s.template=Dt,s.unescape=Et,s.uniqueId=Mt,s.all=Se,s.any=Re,s.detect=Ae,s.foldl=je,s.foldr=Le,s.include=ke,s.inject=je,On(s,function(e,t){s.prototype[t]||(s.prototype[t]=function(){var t=[this.__wrapped__];return nn.apply(t,arguments),e.apply(s,t)})}),s.first=Ye,s.last=Xe,s.take=Ye,s.head=Ye,On(s,function(e,t){s.prototype[t]||(s.prototype[t]=function(t,n){var i=e(this.__wrapped__,t,n);return null==t||n&&"function"!=typeof t?i:new Y(i)})}),s.VERSION="1.2.1",s.prototype.toString=Ot,s.prototype.value=jt,s.prototype.valueOf=jt,An(["join","pop","shift"],function(e){var t=Yt[e];s.prototype[e]=function(){return t.apply(this.__wrapped__,arguments)}}),An(["push","reverse","sort","unshift"],function(e){var t=Yt[e];s.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),An(["concat","slice","splice"],function(e){var t=Yt[e];s.prototype[e]=function(){return new Y(t.apply(this.__wrapped__,arguments))}}),wn.spliceObjects||An(["pop","shift","splice"],function(e){var t=Yt[e],n="splice"==e;s.prototype[e]=function(){var e=this.__wrapped__,i=t.apply(e,arguments);return 0===e.length&&delete e[0],n?new Y(i):i}}),s}var n,i="object"==typeof exports&&exports,r="object"==typeof module&&module&&module.exports==i&&module,s="object"==typeof global&&global;s.global!==s&&s.window!==s||(e=s);var o=0,a={},l=+new Date+"",c=200,u=/\b__p \+= '';/g,d=/\b(__p \+=) '' \+/g,h=/(__e\(.*?\)|\b__t\)) \+\n'';/g,f=/&(?:amp|lt|gt|quot|#39);/g,p=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,m=/\w*$/,g=/<%=([\s\S]+?)%>/g,v=" \t\x0B\f \ufeff\n\r\u2028\u2029 ᠎             　",y=RegExp("^["+v+"]*0+(?=.$)"),b=/($^)/,w=/[&<>"']/g,_=/['\n\r\t\u2028\u2029\\]/g,x=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],C=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],k=0,F="[object Arguments]",S="[object Array]",T="[object Boolean]",A="[object Date]",D="[object Function]",P="[object Number]",E="[object Object]",M="[object RegExp]",I="[object String]",O={};O[D]=!1,O[F]=O[S]=O[T]=O[A]=O[P]=O[E]=O[M]=O[I]=!0;var j={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},L={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"},$=t();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(e._=$,define("underscore",[],function(){return $})):i&&!i.nodeType?r?(r.exports=$)._=$:i._=$:e._=$}(this),define("globals",["require","config","underscore"],function(e){var t=e("config"),n=e("underscore"),i={STATE:{EMPTY:0,UPLOADING:1,READY:2},PROCESS_STATE:{NORMAL:1,PURCHASE:2},msg:{isProductOwner:"Sorry, but you can't purchase your own products.",product:{tooltip:"Include ONLY product files for sale<br> (DO NOT INCLUDE<br> license, screenshots, etc).<br> Zip multiple files together.<br> Max of 1GB.",maxFileSize:"The file you uploaded was too large. Please keep files below 1GB.",cancelled:"The file upload was cancelled.",acceptFileRegEx:"Please select a file with the correct format.",uploadError:"There was an error while trying to upload your file. Please try again.",remove:"Are you sure you want to remove this file?",removeFreeGood:"This file cannot be deleted while the product is offered as a free good",unsupportedFileType:"This file type is not supported. Please try a JPG, PNG, or RAW file.",dimensions:"This file must be at least 580x386px."},screenshot:{maximumFiles:"A maximum of %d screenshots are allowed.",maxFileSize:"The screenshot you uploaded was too large. Please keep files below 5MB.",cancelled:"The screenshot upload was cancelled.",acceptFileRegEx:"Please select a file that's a JPG, PNG, or GIF image.",badImageSize:"Your screenshot image must be at least 580x386px.",uploadError:"There was an error while trying to upload your screenshot. Please try again.",remove:"Are you sure you want to remove this screenshot?"},gallery:{tooltip:"Show your product in action.<br> Screenshots must be at least 580x386px<br> in PNG, JPG or GIF format."},size:{invalid:'Your size input was invalid.<br> Make sure your size is something<br> like "2.3x2.3" (up to 4 decimal places) or "2x2"<br> Max 30000x30000'},dpi:{invalid:"Your DPI exceeds the maximum value: "},size_texture:{invalid:'Your texture resolution input was invalid. Make sure your size is something<br> like "250x250"'},browser:{invalid:"Your browser version is invalid.<br> Make sure the value is under 5 characters and<br> is a proper version number."},location:{empty:"Please fill out a location"},livePreview:{invalid:"Your preview URL is not a valid URL.<br> Ensure that it starts with http://<br> and is accessible via a web browser.",empty:"Please fill out a valid url in the Preview URL field on the right",preview:"Almost there! Hit <i>save</i> to see this preview URL in action."},session:{facebook_generic:"There was an error while communicating with Facebook <br>Please refresh the page and try again"},collections:{confirm:"Do you want to close without saving changes?"},generic:{tooltip:"Your input is invalid"}}};return n.extend(i,t)}),function(e,t){"undefined"!=typeof exports?t(e,exports,require("underscore")):"function"==typeof define&&define.amd?define("backbone",["underscore","jquery","exports"],function(n,i,r){e.Backbone=t(e,r,n,i)}):e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,i){var r=e.Backbone,s=[],o=s.push,a=s.slice,l=s.splice;t.VERSION="1.0.0",t.$=i,t.noConflict=function(){return e.Backbone=r,this},t.emulateHTTP=!1,t.emulateJSON=!1;var c=t.Events={on:function(e,t,n){if(!d(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,i){if(!d(this,"once",e,[t,i])||!t)return this;var r=this,s=n.once(function(){r.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,i)},off:function(e,t,i){var r,s,o,a,l,c,u,h;if(!this._events||!d(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(a=e?[e]:n.keys(this._events),l=0,c=a.length;l<c;l++)if(e=a[l],o=this._events[e]){if(this._events[e]=r=[],t||i)for(u=0,h=o.length;u<h;u++)s=o[u],(t&&t!==s.callback&&t!==s.callback._callback||i&&i!==s.context)&&r.push(s);r.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=a.call(arguments,1);if(!d(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&h(n,t),i&&h(i,arguments),this},stopListening:function(e,t,n){var i=this._listeners;if(!i)return this;var r=!t&&!n;"object"==typeof t&&(n=this),e&&((i={})[e._listenerId]=e);for(var s in i)i[s].off(t,n,this),r&&delete this._listeners[s];return this}},u=/\s+/,d=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)e[t].apply(e,[r,n[r]].concat(i));return!1}if(u.test(n)){for(var s=n.split(u),o=0,a=s.length;o<a;o++)e[t].apply(e,[s[o]].concat(i));return!1}return!0},h=function(e,t){var n,i=-1,r=e.length,s=t[0],o=t[1],a=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,s);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,s,o);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,s,o,a);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t)}},f={listenTo:"on",listenToOnce:"once"};n.each(f,function(e,t){c[t]=function(t,i,r){var s=this._listeners||(this._listeners={}),o=t._listenerId||(t._listenerId=n.uniqueId("l"));return s[o]=t,"object"==typeof i&&(r=this),t[e](i,r,this),this}}),c.bind=c.on,c.unbind=c.off,n.extend(t,c);var p=t.Model=function(e,t){var i,r=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},n.extend(this,n.pick(t,m)),t.parse&&(r=this.parse(r,t)||{}),(i=n.result(this,"defaults"))&&(r=n.defaults({},r,i)),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},m=["url","urlRoot","collection"];n.extend(p.prototype,c,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var r,s,o,a,l,c,u,d;if(null==e)return this;if("object"==typeof e?(s=e,i=t):(s={})[e]=t,i||(i={}),!this._validate(s,i))return!1;o=i.unset,l=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=n.clone(this.attributes),this.changed={}),d=this.attributes,u=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(r in s)t=s[r],n.isEqual(d[r],t)||a.push(r),n.isEqual(u[r],t)?delete this.changed[r]:this.changed[r]=t,o?delete d[r]:d[r]=t;if(!l){a.length&&(this._pending=!0);for(var h=0,f=a.length;h<f;h++)this.trigger("change:"+a[h],this,d[a[h]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{
unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&n.clone(this.changed);var t,i=!1,r=this._changing?this._previousAttributes:this.attributes;for(var s in e)n.isEqual(r[s],t=e[s])||((i||(i={}))[s]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return!!t.set(t.parse(n,e),e)&&(i&&i(t,n,e),void t.trigger("sync",t,n,e))},N(this,e),this.sync("read",this,e)},save:function(e,t,i){var r,s,o,a=this.attributes;if(null==e||"object"==typeof e?(r=e,i=t):(r={})[e]=t,r&&(!i||!i.wait)&&!this.set(r,i))return!1;if(i=n.extend({validate:!0},i),!this._validate(r,i))return!1;r&&i.wait&&(this.attributes=n.extend({},a,r)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(e){l.attributes=a;var t=l.parse(e,i);return i.wait&&(t=n.extend(r||{},t)),!(n.isObject(t)&&!l.set(t,i))&&(c&&c(l,e,i),void l.trigger("sync",l,e,i))},N(this,i),s=this.isNew()?"create":i.patch?"patch":"update","patch"===s&&(i.attrs=r),o=this.sync(s,this,i),r&&i.wait&&(this.attributes=a),o},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(n){(e.wait||t.isNew())&&r(),i&&i(t,n,e),t.isNew()||t.trigger("sync",t,n,e)},this.isNew())return e.success(),!1;N(this,e);var s=this.sync("delete",this,e);return e.wait||r(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||$();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return!i||(this.trigger("invalid",this,i,n.extend(t||{},{validationError:i})),!1)}});var g=["keys","values","pairs","invert","pick","omit"];n.each(g,function(e){p.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var v=t.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},y={add:!0,remove:!0,merge:!0},b={add:!0,merge:!1,remove:!1};n.extend(v.prototype,c,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.defaults(t||{},b))},remove:function(e,t){e=n.isArray(e)?e.slice():[e],t||(t={});var i,r,s,o;for(i=0,r=e.length;i<r;i++)o=this.get(e[i]),o&&(delete this._byId[o.id],delete this._byId[o.cid],s=this.indexOf(o),this.models.splice(s,1),this.length--,t.silent||(t.index=s,o.trigger("remove",o,this,t)),this._removeReference(o));return this},set:function(e,t){t=n.defaults(t||{},y),t.parse&&(e=this.parse(e,t)),n.isArray(e)||(e=e?[e]:[]);var i,r,s,a,c,u=t.at,d=this.comparator&&null==u&&t.sort!==!1,h=n.isString(this.comparator)?this.comparator:null,f=[],p=[],m={};for(i=0,r=e.length;i<r;i++)(s=this._prepareModel(e[i],t))&&((a=this.get(s))?(t.remove&&(m[a.cid]=!0),t.merge&&(a.set(s.attributes,t),d&&!c&&a.hasChanged(h)&&(c=!0))):t.add&&(f.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)));if(t.remove){for(i=0,r=this.length;i<r;++i)m[(s=this.models[i]).cid]||p.push(s);p.length&&this.remove(p,t)}if(f.length&&(d&&(c=!0),this.length+=f.length,null!=u?l.apply(this.models,[u,0].concat(f)):o.apply(this.models,f)),c&&this.sort({silent:!0}),t.silent)return this;for(i=0,r=f.length;i<r;i++)(s=f[i]).trigger("add",s,this,t);return c&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var i=0,r=this.models.length;i<r;i++)this._removeReference(this.models[i]);return t.previousModels=this.models,this._reset(),this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,n.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,n.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){if(null!=e)return this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,i){t||(t=this.comparator);var r=n.isFunction(t)?t:function(e){return e.get(t)};return n.sortedIndex(this.models,e,r,i)},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var r=e.reset?"reset":"set";i[r](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},N(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?n.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,r=t.success;return t.success=function(n){t.wait&&i.add(e,t),r&&r(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var w=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];n.each(w,function(e){v.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var _=["groupBy","countBy","sortBy"];n.each(_,function(e){v.prototype[e]=function(t,i){var r=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,r,i)}});var x=t.View=function(e){this.cid=n.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},C=/^(\S+)\s*(.*)$/,k=["model","collection","el","id","attributes","className","tagName","events"];n.extend(x.prototype,c,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[e[t]]),i){var r=t.match(C),s=r[1],o=r[2];i=n.bind(i,this),s+=".delegateEvents"+this.cid,""===o?this.$el.on(s,i):this.$el.on(s,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=n.extend({},n.result(this,"options"),e)),n.extend(this,n.pick(e,k)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var i=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,r){var s=F[e];n.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};if(r.url||(o.url=n.result(i,"url")||$()),null!=r.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),r.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",r.emulateJSON&&(o.data._method=s);var a=r.beforeSend;r.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",s),a)return a.apply(this,arguments)}}"GET"===o.type||r.emulateJSON||(o.processData=!1),"PATCH"!==o.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=r.xhr=t.ajax(n.extend(o,r));return i.trigger("request",i,l,r),l};var F={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var S=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},T=/\((.*?)\)/g,A=/(\(\?)?:\w+/g,D=/\*\w+/g,P=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(S.prototype,c,{initialize:function(){},route:function(e,i,r){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);r&&r.apply(s,o),s.trigger.apply(s,["route:"+i].concat(o)),s.trigger("route",i,o),t.history.trigger("route",s,i,o)}),this},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(P,"\\$&").replace(T,"(?:$1)?").replace(A,function(e,t){return t?e:"([^/]+)"}).replace(D,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e){return e?decodeURIComponent(e):null})}});var E=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,I=/^\/+|\/+$/g,O=/msie [\w.]+/,j=/\/$/;E.started=!1,n.extend(E.prototype,c,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(j,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(M,"")},start:function(e){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=n.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),r=document.documentMode,s=O.exec(navigator.userAgent.toLowerCase())&&(!r||r<=7);this.root=("/"+this.root+"/").replace(I,"/"),s&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var o=this.location,a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&a&&o.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),E.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t!==this.fragment&&(this.iframe&&this.navigate(t),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(e){var t=this.fragment=this.getFragment(e),i=n.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return i},navigate:function(e,t){if(!E.started)return!1;if(t&&t!==!0||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new E;var L=function(e,t){var i,r=this;i=e&&n.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};p.extend=v.extend=S.extend=x.extend=E.extend=L;var $=function(){throw new Error('A "url" property or function must be specified')},N=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}};return t}),define("event_bus",["underscore","backbone"],function(e,t){return window.EventBus=e.extend({},t.Events),EventBus}),define("shared/cookies",["require","exports","module","underscore"],function(e,t,n){var i=e("underscore"),r=t.set=function(e,t,n){var r=location.hostname.toLowerCase(),s=new Date,o=e+"="+escape(t)+"; ";n&&!i.isNaN(n)&&(s.setTime((new Date).getTime()+1e3*n),o+="expires="+s.toGMTString()+"; "),o+="path=/; domain=."+r,document.cookie=o};t.get=function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return unescape(r.substring(t.length,r.length))}return null},t.destroy=function(e){r(e,"",-1)}}),define("shared/csrf_request",["require","jquery","shared/cookies"],function(e){var t=e("jquery"),n=e("shared/cookies"),i=function(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)},r=function(e){var t=document.location.host,n=document.location.protocol,i="//"+t,r=n+i;return e===r||e.slice(0,r.length+1)===r+"/"||e===i||e.slice(0,i.length+1)===i+"/"||!/^(\/\/|http:|https:).*/.test(e)};t(document).ajaxSend(function(e,t,s){if(!i(s.type)&&r(s.url)){var o=n.get("cmcsr")||n.get("csrftoken"),a=!!(APP&&APP.GLOBALS&&APP.GLOBALS.csrfSignature)&&APP.GLOBALS.csrfSignature;t.setRequestHeader("X-CSRF-Token",a||o)}})}),define("shared/extend_natives",["require","exports","module"],function(e,t,n){Function.prototype.bind&&window.console&&"object"==typeof window.console.log&&["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){window.console[e]=this.call(window.console[e],console)},Function.prototype.bind),String.prototype.stripLowerASCII=function(){return this.replace(/([\x00-\x08\x0b-\x0c\x0e-\x19])/g,"")},String.prototype.base64Decode=function(){for(var e,t,n,i,r,s,o,a="",l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,u=this.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<u.length;)i=l.indexOf(u.charAt(c++)),r=l.indexOf(u.charAt(c++)),s=l.indexOf(u.charAt(c++)),o=l.indexOf(u.charAt(c++)),e=i<<2|r>>4,t=(15&r)<<4|s>>2,n=(3&s)<<6|o,a+=String.fromCharCode(e),64!=s&&(a+=String.fromCharCode(t)),64!=o&&(a+=String.fromCharCode(n));return a.utf8Decode()},String.prototype.utf8Decode=function(){for(var e="",t=0,n=0,i=0,r=0,s=this;t<this.length;)n=s.charCodeAt(t),n<128?(e+=String.fromCharCode(n),t++):n>191&&n<224?(i=s.charCodeAt(t+1),e+=String.fromCharCode((31&n)<<6|63&i),t+=2):(i=s.charCodeAt(t+1),r=s.charCodeAt(t+2),e+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&r),t+=3);return e}}),define("shared/regex",["require","exports","module"],function(e,t,n){t.EMAIL_ADDRESS=/^[a-z0-9!#$%&\'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[a-z]{2,15})\b$/i,t.USERNAME=/^[^\x00-\x2C\x3A-\x40\x5B-\x5E\x7B-\x7F`\/]{2,20}$/,t.URL=/^https?:\/\/([\-\w\.]+)+(:\d+)?(\/([\w\/_\.]*(\?\S+)?)?)?/,t.PHONE_NUMBER=/^(?:[0-9] ?){6,14}[0-9]$/}),function(e){"function"==typeof define&&define.amd?define("vendor/jquery/tipsy",["jquery"],e):e(jQuery)}(function(e){function t(e,t){return"function"==typeof e?e.call(t):e}function n(e){for(;e=e.parentNode;)if(e==document)return!0;return!1}function i(t,n){this.$element=e(t),this.options=n,this.enabled=!0,this.fixTitle()}i.prototype={show:function(){var n=this.getTitle();if(n&&this.enabled){var i=this.tip();i.find(".tipsy-inner")[this.options.html?"html":"text"](n),i[0].className="tipsy";var r;r=null===this.options.target?document.body:this.options.target,i.remove().css({top:0,left:0,visibility:"hidden",display:"block",position:this.options.cssPosition}).prependTo(r),this.options.className&&i.addClass(t(this.options.className,this.$element[0]));var s,o=e.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),a=i[0].offsetWidth,l=i[0].offsetHeight,c=t(this.options.gravity,this.$element[0]);switch(c.charAt(0)){case"n":s={top:o.top+o.height+this.options.offset,left:o.left+o.width/2-a/2};break;case"s":s={top:o.top-l-this.options.offset,left:o.left+o.width/2-a/2};break;case"e":s={top:o.top+o.height/2-l/2,left:o.left-a-this.options.offset};break;case"w":s={top:o.top+o.height/2-l/2,left:o.left+o.width+this.options.offset}}if(2==c.length&&("w"==c.charAt(1)?s.left=o.left+o.width/2-15:s.left=o.left+o.width/2-a+15),i.css(s).addClass("tipsy-"+c),i.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+c.charAt(0),this.options.fade){i.stop().css({opacity:0,display:"block",visibility:"visible"});var u="function"==typeof e.fn.transit?"transition":"animate";i[u]({opacity:this.options.opacity},this.options.fadeSpeed)}else i.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){e(this).remove()}):this.tip().remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("original-title"))&&e.attr("original-title",e.attr("title")||"").removeAttr("title")},getTitle:function(){var e,t=this.$element,n=this.options;this.fixTitle();var e,n=this.options;return"string"==typeof n.title?e=t.attr("title"==n.title?"original-title":n.title):"function"==typeof n.title&&(e=n.title.call(t[0])),e=(""+e).replace(/(^\s*|\s*$)/,""),e||n.fallback},tip:function(){return this.$tip||(this.$tip=e('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>'),this.$tip.data("tipsy-pointee",this.$element[0])),this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},e.fn.tipsy=function(t){function n(n){var r=e.data(n,"tipsy");return r||(r=new i(n,e.fn.tipsy.elementOptions(n,t)),e.data(n,"tipsy",r)),r}function r(){var e=n(this);e.hoverState="in",0===t.delayIn?e.show():(e.fixTitle(),setTimeout(function(){"in"==e.hoverState&&e.show()},t.delayIn))}function s(){var e=n(this);e.hoverState="out",0===t.delayOut?e.hide():setTimeout(function(){"out"==e.hoverState&&e.hide()},t.delayOut)}if(t===!0)return this.data("tipsy");if("string"==typeof t){var o=this.data("tipsy");return o&&o[t](),this}if(t=e.extend({},e.fn.tipsy.defaults,t),t.live||this.each(function(){n(this)}),"manual"!=t.trigger){var a=t.live?"live":"bind",l="hover"==t.trigger?"mouseenter":"focus",c="hover"==t.trigger?"mouseleave":"blur";this[a](l,r)[a](c,s)}return this},e.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fadeSpeed:600,fallback:"",gravity:"s",html:!1,live:!1,offset:8,opacity:1,title:"title",trigger:"hover",target:null,cssPosition:"absolute"},e.fn.tipsy.revalidate=function(){e(".tipsy").each(function(){var t=e.data(this,"tipsy-pointee");t&&n(t)||e(this).remove()})},e.fn.tipsy.elementOptions=function(t,n){return e.metadata?e.extend({},n,e(t).metadata()):n},e.fn.tipsy.autoNS=function(){return e(this).offset().top>e(document).scrollTop()+e(window).height()/2?"s":"n"},e.fn.tipsy.autoWE=function(){return e(this).offset().left>e(document).scrollLeft()+e(window).width()/2?"e":"w"},e.fn.tipsy.autoBounds=function(t,n){return function(){var i={ns:n[0],ew:n.length>1&&n[1]},r=e(document).scrollTop()+t,s=e(document).scrollLeft()+t,o=e(this);return o.offset().top<r&&(i.ns="n"),o.offset().left<s&&(i.ew="w"),e(window).width()+e(document).scrollLeft()-o.offset().left<t&&(i.ew="e"),e(window).height()+e(document).scrollTop()-o.offset().top<t&&(i.ns="s"),i.ns+(i.ew?i.ew:"")}}}),define("shared/tooltip",["require","exports","module","jquery","underscore","vendor/jquery/tipsy"],function(e,t,n){var i=e("jquery"),r=e("underscore");e("vendor/jquery/tipsy");t.DEFAULT_OPTS={gravity:"w",offset:8,fade:!1,html:!0,trigger:"manual"},t.quickDisplay=function(e,t,n){n||(n={}),e=i(e),e.data("tipsy")||e.tipsy(r.extend({fade:!0,trigger:"manual"},n)),t&&e.attr("original-title",t),e.tipsy("show"),setTimeout(function(){e.tipsy("hide")},5e3)}}),define("shared/util",["require","exports","module","jquery","underscore","shared/tooltip","shared/regex"],function(e,t,n){var i=e("jquery"),r=(e("underscore"),e("shared/tooltip")),s=e("shared/regex");t.strcmp=function(e,t){return e&&e.localeCompare?e.localeCompare(t):e>t?1:e<t?-1:0},t.formatPrice=function(e,t,n){return n=n||!1,e=parseFloat(e),0===e?n?"":"Free":(e="$"+parseFloat(e).toFixed(2).toString(),t===!0&&(e=e.replace(/\.00$/,"")),e)},t.toggleAll=function(e,t){i("."+e).each(function(){i(this).prop("checked",i(t).prop("checked"))})},t.confirmRedirect=function(e,t){return!!confirm(e)&&(window.location.href=t,!0)},t.formatFileSize=function(e){return"number"!=typeof e?"":e>=1e9?(e/1e9).toFixed(2)+" GB":e>=1e6?(e/1e6).toFixed(2)+" MB":(e/1e3).toFixed(2)+" KB"},t.buildAjaxUpdaterRequest=function(e,t){e=e||{},e.page="/_page_"+a(e.page).toString(),e.args="string"==typeof e.args?"/"+e.args:"",e.params="string"==typeof e.params?i.parseJSON(e.params):"",e.fadeIn=void 0!==e.fadeIn&&!!e.fadeIn,"string"==typeof e.elementID?""===e.params?e.params={contentElementID:e.elementID}:e.params.contentElementID=e.elementID:e.elementID=e.file;var n=i("#"+e.elementID);if(0===n.length)throw new Error("Cannot find element #"+e.elementID);i.get("/ajax/"+e.file+e.args+e.page,e.params,function(i){e.fadeIn?n.fadeOut(100,function(){n.html(i),window.cmPictureFill(),n.fadeIn(250)}):(n.html(i),window.cmPictureFill()),"function"==typeof e.success&&e.success(),"function"==typeof t&&t(i),void 0!==e.anchor&&o(e.anchor)})};var o=t.goToAnchor=function(e){if(""!==i.trim(e)||e instanceof i){e=e instanceof i?e:"#"+e;var t=i("#toolbar-status"),n=0;0!==t.length&&(n+=t.height()),i.scrollTo(e,600,{offset:n*-1,margin:!0})}},a=(t.centerWindow=function(e,t){if(e instanceof i){t=t||600;var n=e.offset().top,r=e.height(),s=i(window).height(),o=n;r<s&&(o=n-(s/2-r/2)),i("html, body").animate({scrollTop:o},t)}},t.intval=function(e,t){return e=parseInt(e,t||10),isNaN(e)?0:e});t.truncate=function(e,t,n){if(e.length<=t)return e;n=n||"...";var i=n.length,r=t-i,s=Math.ceil(r/2),o=Math.floor(r/2);return e.substr(0,s)+n+e.substr(e.length-o)},t.md5=function(e){function t(e,t,n,i,r,s){return t=d(d(t,e),d(i,s)),d(t<<r|t>>>32-r,n)}function n(e,n,i,r,s,o,a){return t(n&i|~n&r,e,n,s,o,a)}function i(e,n,i,r,s,o,a){return t(n&r|i&~r,e,n,s,o,a)}function r(e,n,i,r,s,o,a){return t(n^i^r,e,n,s,o,a)}function s(e,n,i,r,s,o,a){return t(i^(n|~r),e,n,s,o,a)}function o(e,t){var o=e[0],a=e[1],l=e[2],c=e[3];o=n(o,a,l,c,t[0],7,-680876936),c=n(c,o,a,l,t[1],12,-389564586),l=n(l,c,o,a,t[2],17,606105819),a=n(a,l,c,o,t[3],22,-1044525330),o=n(o,a,l,c,t[4],7,-176418897),c=n(c,o,a,l,t[5],12,1200080426),l=n(l,c,o,a,t[6],17,-1473231341),a=n(a,l,c,o,t[7],22,-45705983),o=n(o,a,l,c,t[8],7,1770035416),c=n(c,o,a,l,t[9],12,-1958414417),l=n(l,c,o,a,t[10],17,-42063),a=n(a,l,c,o,t[11],22,-1990404162),o=n(o,a,l,c,t[12],7,1804603682),c=n(c,o,a,l,t[13],12,-40341101),l=n(l,c,o,a,t[14],17,-1502002290),a=n(a,l,c,o,t[15],22,1236535329),o=i(o,a,l,c,t[1],5,-165796510),c=i(c,o,a,l,t[6],9,-1069501632),l=i(l,c,o,a,t[11],14,643717713),a=i(a,l,c,o,t[0],20,-373897302),o=i(o,a,l,c,t[5],5,-701558691),c=i(c,o,a,l,t[10],9,38016083),l=i(l,c,o,a,t[15],14,-660478335),a=i(a,l,c,o,t[4],20,-405537848),o=i(o,a,l,c,t[9],5,568446438),c=i(c,o,a,l,t[14],9,-1019803690),l=i(l,c,o,a,t[3],14,-187363961),a=i(a,l,c,o,t[8],20,1163531501),o=i(o,a,l,c,t[13],5,-1444681467),c=i(c,o,a,l,t[2],9,-51403784),l=i(l,c,o,a,t[7],14,1735328473),a=i(a,l,c,o,t[12],20,-1926607734),o=r(o,a,l,c,t[5],4,-378558),c=r(c,o,a,l,t[8],11,-2022574463),l=r(l,c,o,a,t[11],16,1839030562),a=r(a,l,c,o,t[14],23,-35309556),o=r(o,a,l,c,t[1],4,-1530992060),c=r(c,o,a,l,t[4],11,1272893353),l=r(l,c,o,a,t[7],16,-155497632),a=r(a,l,c,o,t[10],23,-1094730640),o=r(o,a,l,c,t[13],4,681279174),c=r(c,o,a,l,t[0],11,-358537222),l=r(l,c,o,a,t[3],16,-722521979),a=r(a,l,c,o,t[6],23,76029189),o=r(o,a,l,c,t[9],4,-640364487),c=r(c,o,a,l,t[12],11,-421815835),l=r(l,c,o,a,t[15],16,530742520),a=r(a,l,c,o,t[2],23,-995338651),o=s(o,a,l,c,t[0],6,-198630844),c=s(c,o,a,l,t[7],10,1126891415),l=s(l,c,o,a,t[14],15,-1416354905),a=s(a,l,c,o,t[5],21,-57434055),o=s(o,a,l,c,t[12],6,1700485571),c=s(c,o,a,l,t[3],10,-1894986606),l=s(l,c,o,a,t[10],15,-1051523),a=s(a,l,c,o,t[1],21,-2054922799),o=s(o,a,l,c,t[8],6,1873313359),c=s(c,o,a,l,t[15],10,-30611744),l=s(l,c,o,a,t[6],15,-1560198380),a=s(a,l,c,o,t[13],21,1309151649),o=s(o,a,l,c,t[4],6,-145523070),c=s(c,o,a,l,t[11],10,-1120210379),l=s(l,c,o,a,t[2],15,718787259),a=s(a,l,c,o,t[9],21,-343485551),e[0]=d(o,e[0]),e[1]=d(a,e[1]),e[2]=d(l,e[2]),e[3]=d(c,e[3])}function a(e){var t,n=e.length,i=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=n;t+=64)o(i,l(e.substring(t-64,t)));e=e.substring(t-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s=e.length;for(t=0;t<s;t++)r[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(o(i,r),t=16;t--;)r[t]=0;return r[14]=8*n,o(i,r),i}function l(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function c(e){for(var t="",n=0;n<4;n++)t+=h[e>>8*n+4&15]+h[e>>8*n&15];return t}function u(e){for(var t=e.length,n=0;n<t;n++)e[n]=c(e[n]);return e.join("")}function d(e,t){return e+t&4294967295}function d(e,t){var n=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(n>>16);return i<<16|65535&n}var h="0123456789abcdef".split("");return"5d41402abc4b2a76b9719d911017c592"!=u(a("hello")),u(a(e))},t.showThenHideTipsy=r.quickDisplay,t.prefixedEvent=function(e,t,n){for(var i=["webkit","moz","MS","o",""],r=0,s=i.length;r<s;r++)i[r]||(t=t.toLowerCase()),e.on(t,n)},t.getRandStr=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",n=t.length,i="",r=0;r<e;r++)i+=t.substr(Math.floor(Math.random()*n),1);return i},t.getQueryParams=function(){for(var e=window.location.search.substring(1),t=e.split("&"),n={},i=0;i<t.length;i++){var r=t[i].indexOf("=");if(r>0){var s=t[i].substring(0,r),o=t[i].substring(r+1);n[s]=decodeURIComponent(o)}}return n},t.containsLinks=function(e){for(var t=e.split(/\s+/),n=0;n<t.length;n++)if(t[n].match(s.URL))return!0;return!1};var l=t.stripAllLowerASCII=function(e,t){return t=t||"",e.replace(/[\x00-\x1F\x7F]+/g,t)},c=t.stripHtml=function(e){return e.replace(/<\/?[^>]*>/g,"")};t.sanitize=function(e){return e=l(e),e=c(e),e=e.replace(/(<|>)/,"")},t.ucFirst=function(e){return e=String(e),e.charAt(0).toUpperCase()+e.slice(1)}}),function(e){"function"==typeof define&&define.amd?define("vendor/jquery/select2",["jquery"],e):e(jQuery)}(function(e){var t=e;!function(e){"undefined"==typeof e.fn.each2&&e.fn.extend({each2:function(t){for(var n=e([0]),i=-1,r=this.length;++i<r&&(n.context=n[0]=this[i])&&t.call(n[0],i,n)!==!1;);return this}})}(t),function(e,t){"use strict";function n(e,t){var n,i=0,r=t.length;if("undefined"==typeof e)return-1;if(e.constructor===String){for(;i<r;i+=1)if(0===e.localeCompare(t[i]))return i}else for(;i<r;i+=1)if(n=t[i],n.constructor===String){if(0===n.localeCompare(e))return i}else if(n===e)return i;return-1}function i(e,n){return e===n||e!==t&&n!==t&&(null!==e&&null!==n&&(e.constructor===String?0===e.localeCompare(n):n.constructor===String&&0===n.localeCompare(e)))}function r(t,n){var i,r,s;if(null===t||t.length<1)return[];for(i=t.split(n),r=0,s=i.length;r<s;r+=1)i[r]=e.trim(i[r]);return i}function s(e){return e.outerWidth(!1)-e.width()}function o(n){var i="keyup-change-value";n.bind("keydown",function(){e.data(n,i)===t&&e.data(n,i,n.val())}),n.bind("keyup",function(){var r=e.data(n,i);r!==t&&n.val()!==r&&(e.removeData(n,i),n.trigger("keyup-change"))})}function a(n){n.bind("mousemove",function(n){var i=D;i!==t&&i.x===n.pageX&&i.y===n.pageY||e(n.target).trigger("mousemove-filtered",n)})}function l(e,n,i){i=i||t;var r;return function(){var t=arguments;window.clearTimeout(r),r=window.setTimeout(function(){n.apply(i,t)},e)}}function c(e){var t,n=!1;return function(){return n===!1&&(t=e(),n=!0),t}}function u(e,t){var i=l(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){n(e.target,t.get())>=0&&i(e)})}function d(e){e.preventDefault(),e.stopPropagation()}function h(e){e.preventDefault(),e.stopImmediatePropagation()}function f(t){if(!A){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);A=e("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),e("body").append(A)}return A.text(t.val()),A.width()}function p(e,t,n){var i=e.toUpperCase().indexOf(t.toUpperCase()),r=t.length;return i<0?void n.push(e):(n.push(e.substring(0,i)),n.push("<span class='select2-match'>"),n.push(e.substring(i,i+r)),n.push("</span>"),void n.push(e.substring(i+r,e.length)))}function m(t){var n,i=0,r=null,s=t.quietMillis||100;return function(o){window.clearTimeout(n),n=window.setTimeout(function(){i+=1;var n=i,s=t.data,a=t.transport||e.ajax,l=t.traditional||!1,c=t.type||"GET";s=s.call(this,o.term,o.page,o.context),null!==r&&r.abort(),r=a.call(null,{url:t.url,dataType:t.dataType,data:s,type:c,traditional:l,success:function(e){if(!(n<i)){var r=t.results(e,o.page);o.callback(r)}}})},s)};
}function g(t){var n,i=t,r=function(e){return""+e.text};return e.isArray(i)||(r=i.text,e.isFunction(r)||(n=i.text,r=function(e){return e[n]}),i=i.results),function(t){var n,s=t.term,o={results:[]};return""===s?void t.callback({results:i}):(n=function(i,o){var a,l;if(i=i[0],i.children){a={};for(l in i)i.hasOwnProperty(l)&&(a[l]=i[l]);a.children=[],e(i.children).each2(function(e,t){n(t,a.children)}),(a.children.length||t.matcher(s,r(a)))&&o.push(a)}else t.matcher(s,r(i))&&o.push(i)},e(i).each2(function(e,t){n(t,o.results)}),void t.callback(o))}}function v(n){return e.isFunction(n)?n:function(i){var r=i.term,s={results:[]};e(n).each(function(){var e=this.text!==t,n=e?this.text:this;(""===r||i.matcher(r,n))&&s.results.push(e?this:{id:this,text:this})}),i.callback(s)}}function y(t,n){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error("formatterName must be a function or a falsy value")}function b(t){return e.isFunction(t)?t():t}function w(t){var n=0;return e.each(t,function(e,t){t.children?n+=w(t.children):n++}),n}function _(e,n,r,s){var o,a,l,c,u,d=e,h=!1;if(!s.createSearchChoice||!s.tokenSeparators||s.tokenSeparators.length<1)return t;for(;;){for(a=-1,l=0,c=s.tokenSeparators.length;l<c&&(u=s.tokenSeparators[l],a=e.indexOf(u),!(a>=0));l++);if(a<0)break;if(o=e.substring(0,a),e=e.substring(a+u.length),o.length>0&&(o=s.createSearchChoice(o,n),o!==t&&null!==o&&s.id(o)!==t&&null!==s.id(o))){for(h=!1,l=0,c=n.length;l<c;l++)if(i(s.id(o),s.id(n[l]))){h=!0;break}h||r(o)}}return 0!=d.localeCompare(e)?e:void 0}function x(t,n){var i=function(){};return i.prototype=new t,i.prototype.constructor=i,i.prototype.parent=t.prototype,i.prototype=e.extend(i.prototype,n),i}if(window.Select2===t){var C,k,F,S,T,A,D,P;C={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case C.LEFT:case C.RIGHT:case C.UP:case C.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case C.SHIFT:case C.CTRL:case C.ALT:return!0}return!!e.metaKey},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&e<=123}},P=e(document),T=function(){var e=1;return function(){return e++}}(),P.bind("mousemove",function(e){D={x:e.pageX,y:e.pageY}}),P.ready(function(){P.bind("mousedown touchend",function(n){var i,r=e(n.target).closest("div.select2-container").get(0);r?P.find("div.select2-container-active").each(function(){this!==r&&e(this).data("select2").blur()}):(r=e(n.target).closest("div.select2-drop").get(0),P.find("div.select2-drop-active").each(function(){this!==r&&e(this).data("select2").blur()})),r=e(n.target),i=r.attr("for"),"LABEL"===n.target.tagName&&i&&i.length>0&&(i=i.replace(/([\[\].])/g,"\\$1"),r=e("#"+i),r=r.data("select2"),r!==t&&(r.focus(),n.preventDefault()))})}),k=x(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var i,r,s=".select2-results";this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&null!==n.element.data("select2")&&this.destroy(),this.enabled=!0,this.container=this.createContainer(),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+T()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=c(function(){return n.element.closest("body")}),n.element.attr("class")!==t&&this.container.addClass(n.element.attr("class").replace(/validate\[[\S ]+] ?/,"")),this.container.css(b(n.containerCss)),this.container.addClass(b(n.containerCssClass)),this.opts.element.data("select2",this).hide().before(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(b(n.dropdownCssClass)),this.dropdown.data("select2",this),this.results=i=this.container.find(s),this.search=r=this.container.find("input.select2-input"),r.attr("tabIndex",this.opts.element.attr("tabIndex")),r.attr("placeholder",b(n.searchPlaceholderText)),this.resultsPage=0,this.context=null,this.initContainer(),this.initContainerWidth(),a(this.results),this.dropdown.delegate(s,"mousemove-filtered",this.bind(this.highlightUnderEvent)),u(80,this.results),this.dropdown.delegate(s,"scroll-debounced",this.bind(this.loadMoreIfNeeded)),e.fn.mousewheel&&i.mousewheel(function(e,t,n,r){var s=i.scrollTop();r>0&&s-r<=0?(i.scrollTop(0),d(e)):r<0&&i.get(0).scrollHeight-i.scrollTop()+r<=i.height()&&(i.scrollTop(i.get(0).scrollHeight-i.height()),d(e))}),o(r),r.bind("keyup-change",this.bind(this.updateResults)),r.bind("focus",function(){r.addClass("select2-focused")," "===r.val()&&r.val("")}),r.bind("blur",function(){r.removeClass("select2-focused")}),this.dropdown.delegate(s,"mouseup",this.bind(function(t){e(t.target).closest(".select2-result-selectable:not(.select2-disabled)").length>0?(this.highlightUnderEvent(t),this.selectHighlighted(t)):this.focusSearch(),d(t)})),this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),(n.element.is(":disabled")||n.element.is("[readonly='readonly']"))&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");e!==t&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeData("select2").unbind(".select2").show())},prepareOpts:function(n){var s,o,a,l;if(s=n.element,"select"===s.get(0).tagName.toLowerCase()&&(this.select=o=n.element),o&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(i,r,s){var o,a=this.opts.id,l=this;(o=function(i,r,c){var u,d,h,f,p,m,g,v,y;for(u=0,d=i.length;u<d;u+=1)h=i[u],f=a(h)!==t,p=h.children&&h.children.length>0,m=e("<li></li>"),m.addClass("select2-results-dept-"+c),m.addClass("select2-result"),m.addClass(f?"select2-result-selectable":"select2-result-unselectable"),p&&m.addClass("select2-result-with-children"),m.addClass(l.opts.formatResultCssClass(h)),g=e("<div></div>"),g.addClass("select2-result-label"),y=n.formatResult(h,g,s),y!==t&&g.html(l.opts.escapeMarkup(y)),m.append(g),p&&(v=e("<ul></ul>"),v.addClass("select2-result-sub"),o(h.children,v,c+1),m.append(v)),m.data("select2-data",h),r.append(m)})(r,i,0)}},e.fn.select2.defaults,n),"function"!=typeof n.id&&(a=n.id,n.id=function(e){return e[a]}),o?(n.query=this.bind(function(n){var i,r,o,a={results:[],more:!1},l=n.term;o=function(e,t){var i;e.is("option")?n.matcher(l,e.text(),e)&&t.push({id:e.attr("value"),text:e.text(),element:e.get(),css:e.attr("class")}):e.is("optgroup")&&(i={text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")},e.children().each2(function(e,t){o(t,i.children)}),i.children.length>0&&t.push(i))},i=s.children(),this.getPlaceholder()!==t&&i.length>0&&(r=i[0],""===e(r).text()&&(i=i.not(r))),i.each2(function(e,t){o(t,a.results)}),n.callback(a)}),n.id=function(e){return e.id},n.formatResultCssClass=function(e){return e.css}):"query"in n||("ajax"in n?(l=n.element.data("ajax-url"),l&&l.length>0&&(n.ajax.url=l),n.query=m(n.ajax)):"data"in n?n.query=g(n.data):"tags"in n&&(n.query=v(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(e){return{id:e,text:e}}),n.initSelection=function(t,s){var o=[];e(r(t.val(),n.separator)).each(function(){var t=this,r=this,s=n.tags;e.isFunction(s)&&(s=s()),e(s).each(function(){if(i(this.id,t))return r=this.text,!1}),o.push({id:t,text:r})}),s(o)})),"function"!=typeof n.query)throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(e){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()}))},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},enable:function(){this.enabled||(this.enabled=!0,this.container.removeClass("select2-container-disabled"),this.opts.element.removeAttr("disabled"))},disable:function(){this.enabled&&(this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"),this.opts.element.attr("disabled","disabled"))},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,n,i,r=this.container.offset(),s=this.container.outerHeight(!1),o=this.container.outerWidth(!1),a=this.dropdown.outerHeight(!1),l=e(window).scrollLeft()+document.documentElement.clientWidth,c=e(window).scrollTop()+document.documentElement.clientHeight,u=r.top+s,d=r.left,h=u+a<=c,f=r.top-a>=this.body().scrollTop(),p=this.dropdown.outerWidth(!1),m=d+p<=l,g=this.dropdown.hasClass("select2-drop-above");"static"!==this.body().css("position")&&(t=this.body().offset(),u-=t.top,d-=t.left),g?(n=!0,!f&&h&&(n=!1)):(n=!1,!h&&f&&(n=!0)),m||(d=r.left+o-p),this.opts.forceBottom&&(n=!1),n?(u=r.top-a,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")),i=e.extend({top:u,left:d,width:o},b(this.opts.dropdownCss)),this.dropdown.css(i)},shouldOpen:function(){var t;return!this.opened()&&(t=e.Event("open"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(window.setTimeout(this.bind(this.opening),1),!0)},opening:function(){var t=this.containerId,n=this.containerSelector,i="scroll."+t,r="resize."+t,s=this;this.container.parents().each(function(){e(this).bind(i,function(){var t=e(n);0==t.length&&e(this).unbind(i),t.select2("close")})}),window.setTimeout(function(){e(window).bind(r,function(){var t=e(n);0==t.length&&e(window).unbind(r),t.select2("close")})},10),this.clearDropdownAlignmentPreference()," "===this.search.val()&&this.search.val(""),this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.updateResults(!0),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active"),this.ensureHighlightVisible(),this.focusSearch(),this.opts.rePositionOnScroll&&e(window).on("scroll.rePositionOnScroll  scrollstart.rePositionOnScroll",function(){s.positionDropdown()}),this.opts.closeOnScroll&&e(window).on("scroll.closeOnScroll  scrollstart.closeOnScroll",function(){s.close()})},close:function(){if(this.opened()){var t=this;this.opts.rePositionOnScroll&&e(window).off("scroll.rePositionOnScroll  scrollstart.rePositionOnScroll",function(){t.positionDropdown()}),this.opts.closeOnScroll&&e(window).off("scroll.closeOnScroll  scrollstart.closeOnScroll",function(){t.close()}),this.container.parents().each(function(){e(this).unbind("scroll."+t.containerId)}),e(window).unbind("resize."+this.containerId),this.clearDropdownAlignmentPreference(),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.opts.element.trigger(e.Event("close"))}},clearSearch:function(){},ensureHighlightVisible:function(){var t,n,i,r,s,o,a,l=this.results;if(n=this.highlight(),!(n<0)){if(0==n)return void l.scrollTop(0);t=l.find(".select2-result-selectable"),i=e(t[n]),r=i.offset().top+i.outerHeight(!0),n===t.length-1&&(a=l.find("li.select2-more-results"),a.length>0&&(r=a.offset().top+a.outerHeight(!0))),s=l.offset().top+l.outerHeight(!0),r>s&&l.scrollTop(l.scrollTop()+(r-s)),o=i.offset().top-l.offset().top,o<0&&"none"!=i.css("display")&&l.scrollTop(l.scrollTop()+o)}},moveHighlight:function(t){for(var n=this.results.find(".select2-result-selectable"),i=this.highlight();i>-1&&i<n.length;){i+=t;var r=e(n[i]);if(r.hasClass("select2-result-selectable")&&!r.hasClass("select2-disabled")){this.highlight(i);break}}},highlight:function(t){var i=this.results.find(".select2-result-selectable").not(".select2-disabled");return 0===arguments.length?n(i.filter(".select2-highlighted")[0],i.get()):(t>=i.length&&(t=i.length-1),t<0&&(t=0),i.removeClass("select2-highlighted"),e(i[t]).addClass("select2-highlighted"),void this.ensureHighlightVisible())},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var i=this.results.find(".select2-result-selectable");this.highlight(i.index(n))}else 0==n.length&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var e,t=this.results,n=t.find("li.select2-more-results"),i=this.resultsPage+1,r=this,s=this.search.val(),o=this.context;0!==n.length&&(e=n.offset().top-t.offset().top-t.height(),e<=0&&(n.addClass("select2-active"),this.opts.query({term:s,page:i,context:o,matcher:this.opts.matcher,callback:this.bind(function(e){r.opened()&&(r.opts.populateResults.call(this,t,e.results,{term:s,page:i,context:o}),e.more===!0?(n.detach().appendTo(t).text(r.opts.formatLoadMore(i+1)),window.setTimeout(function(){r.loadMoreIfNeeded()},10)):n.remove(),r.positionDropdown(),r.resultsPage=i)})})))},tokenize:function(){},updateResults:function(n){function r(){c.scrollTop(0),l.removeClass("select2-active"),d.positionDropdown()}function s(e){c.html(d.opts.escapeMarkup(e)),r()}var o,a,l=this.search,c=this.results,u=this.opts,d=this;if(n===!0||this.showSearchInput!==!1&&this.opened()){if(""===l.val()&&u.onlyShowOnSearch)return void s("");if(l.addClass("select2-active"),u.maximumSelectionSize>=1&&(o=this.data(),e.isArray(o)&&o.length>=u.maximumSelectionSize&&y(u.formatSelectionTooBig,"formatSelectionTooBig")))return void s("<li class='select2-selection-limit'>"+u.formatSelectionTooBig(u.maximumSelectionSize)+"</li>");if(l.val().length<u.minimumInputLength)return void s(y(u.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+u.formatInputTooShort(l.val(),u.minimumInputLength)+"</li>":"");u.formatSearching()&&s("<li class='select2-searching'>"+u.formatSearching()+"</li>"),a=this.tokenize(),a!=t&&null!=a&&l.val(a),this.resultsPage=1,u.query({term:l.val(),page:this.resultsPage,context:null,matcher:u.matcher,callback:this.bind(function(o){var a;if(this.opened()){if(this.context=o.context===t?null:o.context,this.opts.createSearchChoice&&""!==l.val()&&(a=this.opts.createSearchChoice.call(null,l.val(),o.results),a!==t&&null!==a&&d.id(a)!==t&&null!==d.id(a)&&0===e(o.results).filter(function(){return i(d.id(this),d.id(a))}).length&&o.results.unshift(a)),0===o.results.length&&y(u.formatNoMatches,"formatNoMatches"))return void s("<li class='select2-no-results'>"+u.formatNoMatches(l.val())+"</li>");c.empty(),d.opts.populateResults.call(this,c,o.results,{term:l.val(),page:this.resultsPage,context:null}),o.more===!0&&y(u.formatLoadMore,"formatLoadMore")&&(c.append("<li class='select2-more-results'>"+d.opts.escapeMarkup(u.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){d.loadMoreIfNeeded()},10)),this.postprocessResults(o,n),r()}})})}},cancel:function(){this.close()},blur:function(){this.close(),this.container.removeClass("select2-container-active"),this.dropdown.removeClass("select2-drop-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.opts.element.triggerHandler("blur")},focusSearch:function(){this.search.show(),this.search.focus(),window.setTimeout(this.bind(function(){this.search.show(),this.search.focus(),this.search.val(this.search.val())}),10)},selectHighlighted:function(){var e=this.highlight(),t=this.results.find(".select2-highlighted").not(".select2-disabled"),n=t.closest(".select2-result-selectable").data("select2-data");n&&(t.addClass("select2-disabled"),this.highlight(e),this.onSelect(n))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function n(){var n,i,r,s,o;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(n=this.opts.element.attr("style"),n!==t)for(i=n.split(";"),s=0,o=i.length;s<o;s+=1)if(r=i[s].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/),null!==r&&r.length>=1)return r[1];return"resolve"===this.opts.width?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var i=n.call(this);null!==i&&this.container.attr("style","width: "+i)}}),F=x(k,{createContainer:function(){var t=e("<div></div>",{"class":"select2-container"}).html(["    <a href='javascript:void(0)' onclick='return false;' class='select2-choice'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","    <div class='select2-drop select2-offscreen'>","   <div class='select2-search'>","       <i class='select2-search-icon' />","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},opening:function(){this.search.show(),this.parent.opening.apply(this,arguments),this.dropdown.removeClass("select2-offscreen")},close:function(){this.opened()&&(this.opts.focusAfterClose||this.search.blur(),this.parent.close.apply(this,arguments),this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show())},focus:function(){this.close(),this.opts.focusAfterClose&&this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments),this.opts.focusAfterClose&&this.selection.focus()},initContainer:function(){var e,t=this.container,n=this.dropdown,i=!1;this.selection=e=t.find(".select2-choice"),this.search.bind("keydown",this.bind(function(e){if(this.enabled){if(e.which===C.PAGE_UP||e.which===C.PAGE_DOWN)return void d(e);if(this.opened())switch(e.which){case C.UP:case C.DOWN:return this.moveHighlight(e.which===C.UP?-1:1),void d(e);case C.TAB:case C.ENTER:return this.selectHighlighted(),void d(e);case C.ESC:return this.cancel(e),void d(e)}else{if(e.which===C.TAB||C.isControl(e)||C.isFunctionKey(e)||e.which===C.ESC)return;if(this.opts.openOnEnter===!1&&e.which===C.ENTER)return;if(this.open(),e.which===C.ENTER)return}}})),this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1")})),this.search.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active"),window.setTimeout(this.bind(function(){var e=this.opts.element.attr("tabIndex");e?this.selection.attr("tabIndex",e):this.selection.removeAttr("tabIndex")}),10)})),e.delegate("abbr","mousedown",this.bind(function(e){this.enabled&&(this.clear(),h(e),this.close(),this.triggerChange(),this.opts.focusAfterClose&&this.selection.focus())})),e.bind("mousedown",this.bind(function(e){i=!0,this.opened()?(this.close(),this.opts.focusAfterClose&&this.selection.focus()):this.enabled&&this.open(),i=!1})),n.bind("mousedown",this.bind(function(){this.search.focus()})),e.bind("focus",this.bind(function(){this.container.addClass("select2-container-active"),this.search.attr("tabIndex","-1")})),e.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active"),window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)})),e.bind("keydown",this.bind(function(e){if(this.enabled)return e.which==C.DOWN||e.which==C.UP||e.which==C.ENTER&&this.opts.openOnEnter?(this.open(),void d(e)):e.which==C.DELETE||e.which==C.BACKSPACE?(this.opts.allowClear&&this.clear(),void d(e)):void 0})),e.bind("keypress",this.bind(function(e){var t=String.fromCharCode(e.which);this.search.val(t),this.open()})),this.setPlaceholder(),this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}))},clear:function(){this.opts.element.val(""),this.selection.find("span").empty(),this.selection.removeData("select2-data"),this.setPlaceholder()},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text())this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.setPlaceholder())})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return"select"===t.element.get(0).tagName.toLowerCase()&&(t.initSelection=function(t,n){var i=t.find(":selected");e.isFunction(n)&&n({id:i.attr("value"),text:i.text(),element:i})}),t},setPlaceholder:function(){var e=this.getPlaceholder();if(""===this.opts.element.val()&&e!==t){if(this.select&&""!==this.select.find("option:first").text())return;this.selection.find("span").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide()}},postprocessResults:function(t,n){var r=0,s=this,o=!0;this.results.find(".select2-result-selectable").each2(function(e,t){if(i(s.id(t.data("select2-data")),s.opts.element.val()))return r=e,!1}),this.highlight(r),n===!0&&(o=this.showSearchInput=w(t.results)>=this.opts.minimumResultsForSearch,this.dropdown.find(".select2-search")[o?"removeClass":"addClass"]("select2-search-hidden"),e(this.dropdown,this.container)[o?"addClass":"removeClass"]("select2-with-searchbox"))},onSelect:function(e){var t=this.opts.element.val();this.opts.element.val(this.id(e)),this.updateSelection(e),this.close(),this.opts.focusAfterClose&&this.selection.focus(),i(t,this.id(e))||this.triggerChange()},updateSelection:function(e){var n,i=this.selection.find("span");this.selection.data("select2-data",e),i.empty(),n=this.opts.formatSelection(e,i),n!==t&&i.append(this.opts.escapeMarkup(n)),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.selection.find("abbr").show()},val:function(){var e,n=null,i=this;if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],this.select)this.select.val(e).find(":selected").each2(function(e,t){return n={id:t.attr("value"),text:t.text()},!1}),this.updateSelection(n),this.setPlaceholder(),this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");if(!e)return this.clear(),void this.triggerChange();this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),i.triggerChange()})}},clearSearch:function(){this.search.val("")},data:function(e){var n;return 0===arguments.length?(n=this.selection.data("select2-data"),n==t&&(n=null),n):void(e&&""!==e?(this.opts.element.val(e?this.id(e):""),this.updateSelection(e)):this.clear())}}),S=x(k,{createContainer:function(){var t=e("<div></div>",{"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return"select"===t.element.get(0).tagName.toLowerCase()&&(t.initSelection=function(t,n){var i=[];t.find(":selected").each2(function(e,t){i.push({id:t.attr("value"),text:t.text(),element:t})}),e.isFunction(n)&&n(i)}),t},initContainer:function(){var t,n=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(n),this.search.bind("keydown",this.bind(function(e){if(this.enabled){if(e.which===C.BACKSPACE&&""===this.search.val()){this.close();var n,i=t.find(".select2-search-choice-focus");if(i.length>0)return this.unselect(i.first()),this.search.width(10),void d(e);n=t.find(".select2-search-choice:not(.select2-locked)"),n.length>0&&n.last().addClass("select2-search-choice-focus")}else t.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");if(this.opened())switch(e.which){case C.UP:case C.DOWN:return this.moveHighlight(e.which===C.UP?-1:1),void d(e);case C.ENTER:case C.TAB:return this.selectHighlighted(),void d(e);case C.ESC:return this.cancel(e),void d(e)}e.which===C.TAB||C.isControl(e)||C.isFunctionKey(e)||e.which===C.BACKSPACE||e.which===C.ESC||this.opts.openOnEnter===!1&&e.which===C.ENTER||(this.open(),e.which!==C.PAGE_UP&&e.which!==C.PAGE_DOWN||d(e))}})),this.search.bind("keyup",this.bind(this.resizeSearch)),this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.clearSearch(),e.stopImmediatePropagation()})),this.container.delegate(n,"mousedown",this.bind(function(t){this.enabled&&(e(t.target).closest(".select2-search-choice").length>0||(this.clearPlaceholder(),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.delegate(n,"focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.clearSearch()},enable:function(){this.enabled||(this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled"))},disable:function(){this.enabled&&(this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0))},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder();e!==t&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.resizeSearch()):this.search.val(" ").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")?this.search.val("").removeClass("select2-default"):" "===this.search.val()&&this.search.val("")},opening:function(){this.parent.opening.apply(this,arguments),this.clearPlaceholder(),this.resizeSearch(),this.focusSearch()},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var i=[],r=[],s=this;e(t).each(function(){n(s.id(this),i)<0&&(i.push(s.id(this)),r.push(this))}),t=r,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){s.addSelectedChoice(this)}),s.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts),null!=e&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e){this.addSelectedChoice(e),!this.select&&this.opts.closeOnSelect||this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.positionDropdown()):this.close(),this.triggerChange({added:e}),this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var i,r=!n.locked,s=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),o=e("<li class='select2-search-choice select2-locked'><div></div></li>"),a=r?s:o,l=this.id(n),c=this.getVal();i=this.opts.formatSelection(n,a.find("div")),i!=t&&a.find("div").replaceWith("<div>"+this.opts.escapeMarkup(i)+"</div>"),r&&a.find(".select2-search-choice-close").bind("mousedown",d).bind("click dblclick",this.bind(function(t){this.enabled&&(e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),d(t))})).bind("focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),a.data("select2-data",n),a.insertBefore(this.searchContainer),c.push(l),this.setVal(c)},unselect:function(e){var t,i,r=this.getVal();if(e=e.closest(".select2-search-choice"),0===e.length)throw"Invalid argument: "+e+". Must be .select2-search-choice";t=e.data("select2-data"),i=n(this.id(t),r),i>=0&&(r.splice(i,1),this.setVal(r),this.select&&this.postprocessResults()),e.remove(),this.triggerChange({removed:t})},postprocessResults:function(){var e=this.getVal(),t=this.results.find(".select2-result-selectable"),i=this.results.find(".select2-result-with-children"),r=this;t.each2(function(t,i){var s=r.id(i.data("select2-data"));n(s,e)>=0?i.addClass("select2-disabled").removeClass("select2-result-selectable"):i.removeClass("select2-disabled").addClass("select2-result-selectable")}),i.each2(function(e,t){t.is(".select2-result-selectable")||0!=t.find(".select2-result-selectable").length?t.removeClass("select2-disabled"):t.addClass("select2-disabled")}),this.highlight()==-1&&t.each2(function(e,t){if(!t.hasClass("select2-disabled")&&t.hasClass("select2-result-selectable"))return r.highlight(0),!1})},resizeSearch:function(){var e,t,n,i,r,o=s(this.search);e=f(this.search)+10,t=this.search.offset().left,n=this.selection.width(),i=this.selection.offset().left,r=n-(t-i)-o,r<e&&(r=n-o),r<40&&(r=n-o),this.search.width(r)},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),r(e,this.opts.separator))},setVal:function(t){var i;this.select?this.select.val(t):(i=[],e(t).each(function(){n(this,i)<0&&i.push(this)}),this.opts.element.val(0===i.length?"":i.join(this.opts.separator)))},val:function(){var n,i=[],r=this;if(0===arguments.length)return this.getVal();if(n=arguments[0],!n)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void this.triggerChange();if(this.setVal(n),this.select)this.select.find(":selected").each(function(){i.push({id:e(this).attr("value"),text:e(this).text()})}),this.updateSelection(i),this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e(t).map(r.id);r.setVal(n),r.updateSelection(t),r.clearSearch(),r.triggerChange()})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t){var n,i=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){
return e(this).data("select2-data")}).get():(t||(t=[]),n=e.map(t,function(e){return i.opts.id(e)}),this.setVal(n),this.updateSelection(t),this.clearSearch(),void 0)}}),e.fn.select2=function(){var i,r,s,o,a=Array.prototype.slice.call(arguments,0),l=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];return this.each(function(){if(0===a.length||"object"==typeof a[0])i=0===a.length?{}:e.extend({},a[0]),i.element=e(this),"select"===i.element.get(0).tagName.toLowerCase()?o=i.element.attr("multiple"):(o=i.multiple||!1,"tags"in i&&(i.multiple=o=!0)),r=o?new S:new F,r.init(i);else{if("string"!=typeof a[0])throw"Invalid arguments to select2 plugin: "+a;if(n(a[0],l)<0)throw"Unknown method: "+a[0];if(s=t,r=e(this).data("select2"),r===t)return;if(s="container"===a[0]?r.container:r[a[0]].apply(r,a.slice(1)),s!==t)return!1}}),s===t?this:s},e.fn.select2.defaults={width:"copy",closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n){var i=[];return p(e.text,n.term,i),i.join("")},formatSelection:function(e,n){return e?e.text:t},formatResultCssClass:function(e){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(1==n?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(e){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return t.toUpperCase().indexOf(e.toUpperCase())>=0},onlyShowOnSearch:!1,rePositionOnScroll:!1,closeOnScroll:!1,forceBottom:!1,focusAfterClose:!0,searchPlaceholderText:"",separator:",",tokenSeparators:[],tokenizer:_,escapeMarkup:function(e){return e&&"string"==typeof e?e.replace(/&/g,"&amp;"):e},blurOnChange:!1},window.Select2={query:{ajax:m,local:g,tags:v},util:{debounce:l,markMatch:p},"class":{"abstract":k,single:F,multi:S}}}}(t)}),function(e){"use strict";e("vendor/jquery/scrollto",["jquery"],function(e){function t(t){return e.isFunction(t)||e.isPlainObject(t)?t:{top:t,left:t}}var n=e.scrollTo=function(t,n,i){return e(window).scrollTo(t,n,i)};return n.defaults={axis:"xy",duration:0,limit:!0},n.window=function(){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,n=!t.nodeName||e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])!==-1;if(!n)return t;var i=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||"BackCompat"===i.compatMode?i.body:i.documentElement})},e.fn.scrollTo=function(i,r,s){return"object"==typeof r&&(s=r,r=0),"function"==typeof s&&(s={onAfter:s}),"max"===i&&(i=9e9),s=e.extend({},n.defaults,s),r=r||s.duration,s.queue=s.queue&&s.axis.length>1,s.queue&&(r/=2),s.offset=t(s.offset),s.over=t(s.over),this._scrollable().each(function(){function o(e){c.animate(d,r,s.easing,e&&function(){e.call(this,u,s)})}if(null!==i){var a,l=this,c=e(l),u=i,d={},h=c.is("html,body");switch(typeof u){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(u)){u=t(u);break}if(u=h?e(u):e(u,this),!u.length)return;case"object":(u.is||u.style)&&(a=(u=e(u)).offset())}var f=e.isFunction(s.offset)&&s.offset(l,u)||s.offset;e.each(s.axis.split(""),function(e,t){var i="x"===t?"Left":"Top",r=i.toLowerCase(),p="scroll"+i,m=l[p],g=n.max(l,t);if(a)d[p]=a[r]+(h?0:m-c.offset()[r]),s.margin&&(d[p]-=parseInt(u.css("margin"+i),10)||0,d[p]-=parseInt(u.css("border"+i+"Width"),10)||0),d[p]+=f[r]||0,s.over[r]&&(d[p]+=u["x"===t?"width":"height"]()*s.over[r]);else{var v=u[r];d[p]=v.slice&&"%"===v.slice(-1)?parseFloat(v)/100*g:v}s.limit&&/^\d+$/.test(d[p])&&(d[p]=d[p]<=0?0:Math.min(d[p],g)),!e&&s.queue&&(m!==d[p]&&o(s.onAfterFirst),delete d[p])}),o(s.onAfter)}}).end()},n.max=function(t,n){var i="x"===n?"Width":"Height",r="scroll"+i;if(!e(t).is("html,body"))return t[r]-e(t)[i.toLowerCase()]();var s="client"+i,o=t.ownerDocument.documentElement,a=t.ownerDocument.body;return Math.max(o[r],a[r])-Math.min(o[s],a[s])},n})}("function"==typeof define&&define.amd?define:function(e,t){"use strict";"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}),define("shared/plugins/text_width",["require","exports","module"],function(e,t,n){$.fn.getTextWidth=function(){var e=this.val()+"M",t={"font-family":this.css("font-family"),"font-size":this.css("font-size"),"font-style":this.css("font-style"),letterspacing:this.css("letterspacing"),"font-weight":this.css("font-weight"),"white-space":"pre",padding:0,margin:0,position:"absolute"},n=$("<span>").html(e).css(t).appendTo("body"),i=parseInt(n.width(),10);return n.remove(),i}}),function(e,t,n){"use strict";var i,r;if(e.uaMatch=function(e){e=e.toLowerCase();var t=/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||/(windows phone)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/i.exec(e)||[];return{browser:t[3]||t[1]||"",version:t[2]||"0",platform:n[0]||""}},i=e.uaMatch(t.navigator.userAgent),r={},i.browser&&(r[i.browser]=!0,r.version=i.version,r.versionNumber=parseInt(i.version)),i.platform&&(r[i.platform]=!0),(r.android||r.ipad||r.iphone||r["windows phone"])&&(r.mobile=!0),(r.cros||r.mac||r.linux||r.win)&&(r.desktop=!0),(r.chrome||r.opr||r.safari)&&(r.webkit=!0),r.rv){var s="msie";i.browser=s,r[s]=!0}if(r.opr){var o="opera";i.browser=o,r[o]=!0}if(r.safari&&r.android){var a="android";i.browser=a,r[a]=!0}r.name=i.browser,r.platform=i.platform,e.browser=r}(jQuery,window),define("vendor/jquery/jquery.browser",function(){}),define("shared/plugins/auto_resize",["require","exports","module","jquery","vendor/jquery/jquery.browser"],function(e,t,n){var i=e("jquery");e("vendor/jquery/jquery.browser");!function(e,t){function n(t){var n=e(t),i=n.val(),r=n.val("").height(),s=t.scrollHeight,o=s>r?s-r:0;return n.data("minHeight",r),n.data("scrollOffset",o),n.css("overflow-y","hidden"),e.browser.msie&&n.css("overflow-y","hidden").scroll(function(){this.scrollTop=0}),n.val(i)}function i(){var n,i=e(this),r=i.height(),s=i.data("scrollOffset"),o=(i.data("minHeight"),t.scrollTop());i.height("0"),n=i.prop("scrollHeight")-s+(parseInt(i.css("padding-top"),10)+parseInt(i.css("padding-bottom"),10)),i.height(n),t.scrollTop(o),r!==n&&i.trigger("autoresize:resize",n)}function r(){n(this).bind(o,i),i.call(this)}var s="textarea",o="keyup change paste input";e.fn.autoResize=function(){return this.filter(s).each(r)}}(i,i(window))}),define("shared/plugins/auto_resize_text_input",["require","exports","module","jquery","shared/util"],function(e,t,n){function i(e){return c.html(s.val().replace(/</gm,"&lt;").replace(/>/gm,"&gt;")+"&nbsp;"),Math.min(Math.max(d.intval(c.width())+l,o),a)}function r(e){var t=i();s.css({width:t,overflow:t===a&&a!==-1?"auto":"hidden"})}var s,o,a,l,c,u=e("jquery"),d=e("shared/util"),h={init:function(e){s=u(this),o=d.intval(e.min),a=d.intval(e.max),l=d.intval(e.adjust);for(var t={position:"absolute",top:"-999999em",left:"-999999em"},n=["line-height","font-weight","font-size","font-size-adjust","font-family","font-stretch","font-variant","font-style","text-transform","letter-spacing","text-indent","word-spacing","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-style","border-right-style","border-bottom-style","border-left-style","padding-top","padding-right","padding-bottom","padding-left","height"],i=0,h=n.length;i<h;++i)t[n[i]]=s.css(n[i]);return c=u("<div>").css(t),s.after(c).on("keyup input change beforepaste blur focus",r).trigger("keyup"),this}};u.fn.autoResizeTextInput=function(e){return h[e]?h[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(u.error("Method "+e+" does not exist on jQuery.autoResizeTextInput"),this):h.init.apply(this,arguments)}}),define("shared/plugins/checkbox_range",["require","exports","module","jquery"],function(e,t,n){var i=e("jquery");i.fn.createCheckboxRange=function(e){var t=jQuery.extend(e&&e.constructor==Object?e:{bind:"shiftKey",click:e},e),n=0,r=this,s=i.isFunction(t.click);return s&&this.each(function(){t.click.apply(this,[i.event.fix({type:null}),i(this).is(":checked")])}),this.each(function(){if("checkbox"!=this.type)return!1;var e=function(e){n=r.index(e.target)},o=function(e){var i=this.checked,o=r.index(e.target),a=Math.min(n,o),l=Math.max(n+1,o);if(s&&t.click.apply(this,[e,i]),e[t.bind]){for(var c=a;c<l;c++){var u=r.eq(c).attr("checked",i).trigger("change");s&&t.click.apply(u[0],[e,i])}return!0}};return i(this).unbind("click.createCheckboxRange").bind("click.createCheckboxRange",o).bind("click.createCheckboxRange",e),!0})}}),function(e){"function"==typeof define&&define.amd?define("vendor/jquery/mentions_input",["jquery","underscore"],e):e(jQuery,_)}(function(e,t,n){var i={BACKSPACE:8,TAB:9,RETURN:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,COMMA:188,SPACE:32,HOME:36,END:35},r={triggerChar:"@",onDataRequest:e.noop,minChars:2,maxOptions:0,showAvatars:!0,elastic:!1,onCaret:!1,parseValue:function(e){return e.name},classes:{autoCompleteItemActive:"active"},templates:{wrapper:t.template('<div class="mentions-input-box"></div>'),autocompleteList:t.template('<div class="mentions-autocomplete-list"></div>'),autocompleteListItem:t.template('<li data-ref-id="<%= id %>" data-ref-type="<%= type %>" data-display="<%= display %>"><%= content %></li>'),autocompleteListItemAvatar:t.template('<img src="<%= avatar %>" />'),autocompleteListItemIcon:t.template('<div class="icon <%= icon %>"></div>'),mentionsOverlay:t.template('<div class="mentions"><div></div></div>'),mentionItemSyntax:t.template("@[<%= value %>](<%= type %>:<%= id %>)"),mentionItemHighlight:t.template("<strong><span><%= value %></span></strong>")}},s={htmlEncode:function(e){return t.escape(e)},highlightTerm:function(e,t){return t||t.length?e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>"):e},setCaratPosition:function(e,t){if(e.createTextRange){var n=e.createTextRange();n.move("character",t),n.select()}else e.selectionStart?(e.focus(),e.setSelectionRange(t,t)):e.focus()},getCaratPosition:function(e){if(e.selectionStart)return e.selectionStart;if(e.ownerDocument.selection){var t=e.ownerDocument.selection.createRange();if(!t)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(t.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}},rtrim:function(e){return e.replace(/\s+$/,"")}},o=function(n){function o(){D=e(A),"true"!=D.attr("data-mentions-input")&&(P=D.parent(),M=e(n.templates.wrapper()),D.wrapAll(M),M=P.find("> div"),D.attr("data-mentions-input","true"),D.bind("keydown",_),D.bind("keypress",w),D.bind("input",b),D.bind("click",v),D.bind("blur",y),n.elastic&&D.elastic())}function a(){E=e(n.templates.autocompleteList()),E.appendTo(M),E.delegate("li","mousedown",m),E.delegate("li","mouseenter",g)}function l(){I=e(n.templates.mentionsOverlay()),I.prependTo(M)}function c(){var e=f();t.each(L,function(t){var i=n.templates.mentionItemSyntax(t);e=e.replace(t.value,i)});var i=s.htmlEncode(e);t.each(L,function(e){var r=t.extend({},e,{value:s.htmlEncode(e.value)}),o=n.templates.mentionItemSyntax(r),a=n.templates.mentionItemHighlight(r);i=i.replace(o,a)}),i=i.replace(/\n/g,"<br />"),i=i.replace(/ {2}/g,"&nbsp; "),D.data("messageText",e),I.find("div").html(i)}function u(){N=[]}function d(){var e=f();L=t.reject(L,function(t,n){return!t.value||e.indexOf(t.value)==-1}),L=t.compact(L)}function h(e){var t=f(),i=s.getCaratPosition(D[0]),r=t.substr(0,i).lastIndexOf(n.triggerChar),o=r+j.length,a=t.substr(0,r),l=t.substr(o+1,t.length),d=(a+e.value).length+1;L.push(e),u(),j="",x();var h=a+e.value+" "+l;D.val(h),c(),D.focus(),s.setCaratPosition(D[0],d)}function f(){return e.trim(D.val())}function p(t){var i,r,s,o,a,l,c,u,d,h,f;if((d=t[0])&&e(d).is("textarea")&&null!=d.selectionEnd){for(c={position:"absolute",overflow:"auto",whiteSpace:"pre-wrap",wordWrap:"break-word",boxSizing:"content-box",top:0,left:-9999},u=["boxSizing","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","textDecoration","textIndent","textTransform","width","word-spacing"],h=0,f=u.length;h<f;h++)a=u[h],c[a]=e(d).css(a);return r=d.value.substring(0,d.selectionEnd),r=r.substring(0,r.lastIndexOf(n.triggerChar)),s=document.createElement("div"),e(s).css(c),e(d).after(s),r=document.createTextNode(r),i=document.createTextNode(d.value.substring(d.selectionEnd)),o=document.createElement("span"),o.innerHTML="&nbsp;",s.appendChild(r),s.appendChild(o),s.appendChild(i),s.scrollTop=d.scrollTop,l=e(o).position(),e(s).remove(),l}}function m(t){var n=e(this),i=$[n.attr("data-uid")];return h(i),!1}function g(t){C(e(this))}function v(e){u()}function y(e){x()}function b(e){c(),d();var i=t.lastIndexOf(N,n.triggerChar);i>-1&&(j=N.slice(i+1).join(""),j=s.rtrim(j),t.defer(t.bind(S,this,j)))}function w(e){if(e.keyCode!==i.BACKSPACE){var t=String.fromCharCode(e.which||e.keyCode);N.push(t)}}function _(n){if(n.keyCode==i.LEFT||n.keyCode==i.RIGHT||n.keyCode==i.HOME||n.keyCode==i.END)return t.defer(u),void(navigator.userAgent.indexOf("MSIE 9")>-1&&t.defer(c));if(n.keyCode==i.BACKSPACE)return void(N=N.slice(0,-1+N.length));if(!E.is(":visible"))return!0;switch(n.keyCode){case i.UP:case i.DOWN:var r=null;return r=n.keyCode==i.DOWN?O&&O.length?O.next():E.find("li").first():e(O).prev(),r.length&&C(r),!1;case i.RETURN:case i.TAB:if(O&&O.length)return O.trigger("mousedown"),!1}return!0}function x(){O=null,E.empty().hide()}function C(e){O&&O[0]===e[0]||(e.addClass(n.classes.autoCompleteItemActive),e.siblings().removeClass(n.classes.autoCompleteItemActive),O=e)}function k(i,r){var o=t.pluck(L,"value");if(r=t.reject(r,function(e){return t.include(o,e.name)}),!r.length)return void x();E.empty();var a,l,c,u,d,h=e("<ul>").appendTo(E).hide(),f=n.maxOptions?Math.min(n.maxOptions,r.length):r.length;for(a=0;a<f;a++)c=r[a],l=t.uniqueId("mention_"),$[l]=t.extend({},c,{value:n.parseValue(c)}),u=e(n.templates.autocompleteListItem({id:s.htmlEncode(c.id),display:s.htmlEncode(c.name),type:s.htmlEncode(c.type),content:s.highlightTerm(c.display?c.display:c.name,i)})).attr("data-uid",l),0===a&&C(u),n.showAvatars&&(d=e(c.avatar?n.templates.autocompleteListItemAvatar({avatar:c.avatar}):n.templates.autocompleteListItemIcon({icon:c.icon})),d.prependTo(u)),u.appendTo(h);E.show(),n.onCaret&&F(E,D),h.show()}function F(e,t){var n=p(t),i=parseInt(t.css("line-height"),10)||18;e.css("left",n.left),e.css("top",i+n.top)}function S(e){e&&e.length&&e.length>=n.minChars?n.onDataRequest.call(this,"search",e,function(t){k(e,t)}):x()}function T(t){if(t){L=[];for(var i,r=t,s=(e.isArray(n.triggerChar)?n.triggerChar.join("|"):n.triggerChar,new RegExp("\\[("+n.triggerChar+")(.*?)\\]\\((.*?):(.*?)\\)","gi")),o=r;null!=(i=s.exec(r));)o=o.replace(i[0],i[1]+i[2]),L.push({id:i[4],type:i[3],value:i[1]+i[2],trigger:i[1]});D.val(o),c()}else D.val(""),L=[],c()}var A,D,P,E,M,I,O,j,L=[],$={},N=[];return n=e.extend(!0,{},r,n),{init:function(e){A=e,o(),a(),l(),T(f()),n.prefillMention&&h(n.prefillMention)},val:function(e){if(t.isFunction(e)){var n=L.length?D.data("messageText"):f();e.call(this,n)}},reset:function(e){T(e)},getMentions:function(e){t.isFunction(e)&&e.call(this,L)}}};e.fn.mentionsInput=function(n,i){var r=arguments;return"object"!=typeof n&&n||(i=n),this.each(function(){var s=e.data(this,"mentionsInput")||e.data(this,"mentionsInput",new o(i));return t.isFunction(s[n])?s[n].apply(this,Array.prototype.slice.call(r,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist"):s.init.call(this,this)})}}),define("shared/plugins/mentions",["require","jquery","underscore","vendor/jquery/mentions_input"],function(e){var t=e("jquery"),n=e("underscore"),i=(e("vendor/jquery/mentions_input"),{}),r=[],s={},o=function(e){return e.username===e.name?e.name:e.name+" <span>("+e.username+")</span>"};return i.fetchFollowing=function(){var e=[],n=!1,i=!1,r=[];return function(s){return i?s(e):(r.push(s),void(n||(n=!0,t.getJSON("/ajax/following",function(t){for(var n=0;n<t.length;n++)e.push({id:t[n].ID,name:t[n].name,username:t[n].username,avatar:t[n].avatar,type:"user"});for(i=!0;r.length;)r.pop()(e)}))))}}(),i.init=function(e){i.fetchFollowing(i.add),e.each(function(){var e=t(this),i=e.mentionsInput({onDataRequest:function(e,t,i){t=t.toLowerCase();var s=n.filter(r,function(e){return e.name.toLowerCase().indexOf(t)>-1||e.username.toLowerCase().indexOf(t)>-1});i.call(this,s)},parseValue:function(e){return"@"+e.name},onCaret:!0,templates:{wrapper:n.template('<div class="mentions-input-box"></div>'),autocompleteList:n.template('<div class="mentions-autocomplete-list"></div>'),autocompleteListItem:n.template('<li data-ref-id="<%= id %>" data-ref-type="<%= type %>" data-display="<%= display %>"><%= content %></li>'),autocompleteListItemAvatar:n.template('<img src="<%= avatar %>" />'),autocompleteListItemIcon:n.template('<div class="icon <%= icon %>"></div>'),mentionsOverlay:n.template('<div class="mentions"><div id="textarea-value"></div></div>'),mentionItemSyntax:n.template("[<%= value %>](<%= type %>:<%= id %>)"),mentionItemHighlight:n.template("<strong><span><%= value %></span></strong>")}});e.data("mentions",i)})},i.add=function(e){var t,n;for(t=0;t<e.length;t++)n=e[t].id,s.hasOwnProperty(n)||(s[n]=!0,e[t].type="user",e[t].display=o(e[t]),r.push(e[t]))},i}),define("adamantium/validation/validators",["require","exports","module"],function(e,t,n){return function(e){var t={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},n={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",pattern:"{0} must be a valid {1}"},i={none:function(e){return e},sentenceCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toUpperCase():" "+e.toLowerCase()}).replace("_"," ")},label:function(e,t){return t.labels[e]||i.sentenceCase(e,t)}},r=function(e){return String(e).replace(/^\s+|\s+$/,"")},s=function(t,n){return i[e](t,n)},o=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.replace(/\{(\d+)\}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})},a=function(e){return _.isNumber(e)||_.isString(e)&&e.match(t.number)},l=function(e){return!(_.isNull(e)||_.isUndefined(e)||_.isString(e)&&""===r(e))};return{fn:function(e,t,n,i,r){return _.isString(n)&&(n=i[n]),n.call(i,e,t,r)},required:function(e,t,i,r,a){var c=_.isFunction(i)?i.call(r,e,t,a):i;return!(!c&&!l(e))&&(c&&!l(e)?o(n.required,s(t,r)):void 0)},acceptance:function(e,t,i,r){if("true"!==e&&(!_.isBoolean(e)||e===!1))return o(n.acceptance,s(t,r))},min:function(e,t,i,r){if(!a(e)||e<i)return o(n.min,s(t,r),i)},max:function(e,t,i,r){if(!a(e)||e>i)return o(n.max,s(t,r),i)},range:function(e,t,i,r){if(!a(e)||e<i[0]||e>i[1])return o(n.range,s(t,r),i[0],i[1])},length:function(e,t,i,a){if(!l(e)||r(e).length!==i)return o(n.length,s(t,a),i)},minLength:function(e,t,i,a){if(!l(e)||r(e).length<i)return o(n.minLength,s(t,a),i)},maxLength:function(e,t,i,a){if(!l(e)||r(e).length>i)return o(n.maxLength,s(t,a),i)},rangeLength:function(e,t,i,a){if(!l(e)||r(e).length<i[0]||r(e).length>i[1])return o(n.rangeLength,s(t,a),i[0],i[1])},oneOf:function(e,t,i,r){if(!_.include(i,e))return o(n.oneOf,s(t,r),i.join(", "))},equalTo:function(e,t,i,r,a){if(e!==a[i])return o(n.equalTo,s(t,r),s(i,r))},pattern:function(e,i,r,a){if(!l(e)||!e.toString().match(t[r]||r))return o(n.pattern,s(i,a),r)}}}}),define("adamantium/validation/validation",["require","exports","module","underscore","adamantium/validation/validators"],function(e,t,n){var i=e("underscore"),r=e("adamantium/validation/validators"),s={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase"},o=i.extend({},s),a=function(){return r(o.labelFormatter)},l=function(e,t){return e&&e[t]?i.isFunction(e[t])?e[t]():e[t]:null},c=function(e){return i.reduce(i.keys(l(e,"validation")||{}),function(e,t){return e[t]=void 0,e},{})},u=function(e,t){var n=l(e,"validation")?l(e,"validation")[t]||{}:{};return(i.isFunction(n)||i.isString(n))&&(n={fn:n}),i.isArray(n)||(n=[n]),i.reduce(n,function(e,t){return i.each(i.without(i.keys(t),"msg"),function(n){e.push({fn:a()[n],val:t[n],msg:t.msg})}),e},[])},d=function(e,t,n,r){return i.reduce(u(e,t),function(i,s){var o=s.fn.call(a(),n,t,s.val,e,r);return o!==!1&&i!==!1&&(o&&!i?s.msg||o:i)},"")},h=function(e,t){var n,r,s={},o=!0,a=i.clone(t);for(r in t)n=d(e,r,t[r],a),n&&(s[r]=n,o=!1);return{invalidAttrs:s,isValid:o}};return{preValidate:function(e,t){return d(this,e,t,i.extend({},this.attributes))},isValid:function(e){if(i.isString(e))return!d(this,e,this.get(e),i.extend({},this.attributes));if(i.isArray(e)){for(var t=0;t<e.length;t++)if(d(this,e[t],this.get(e[t]),i.extend({},this.attributes)))return!1;return!0}return e===!0&&this.validate(),!this.validation||this._isValid},validate:function(e,t){o=i.extend({},s,this.validationOptions,t);var n=this,r=!e,a=i.extend(c(n),n.attributes,e),l=e||a,u=h(n,a);n._isValid=u.isValid;for(var d in a){var f=u.invalidAttrs.hasOwnProperty(d),p=l.hasOwnProperty(d);f&&(p||r)&&n.trigger("invalid",d,u.invalidAttrs[d],o.selector),f||n.trigger("valid",d,o.selector)}if(i.defer(function(){n.trigger("validated",n._isValid,n,u.invalidAttrs),n.trigger("validated:"+(n._isValid?"valid":"invalid"),n,u.invalidAttrs)}),!o.forceUpdate&&i.intersection(i.keys(u.invalidAttrs),i.keys(l)).length>0)return u.invalidAttrs}}}),define("adamantium/model",["require","exports","module","backbone","adamantium/validation/validation"],function(e,t,n){var i=e("backbone"),r=e("adamantium/validation/validation"),s=i.Model.extend(r,{});return s}),define("shared/feature_switch",["require","config","shared/util"],function(e){var t=e("config"),n=e("shared/util"),i=t.featureSwitches||{},r={},s={};return s.isEnabled=function(e){var t=r[e]||n.md5(e);return r[e]=t,i.hasOwnProperty(t)&&i[t]},s}),define("apis/facebook",["require","exports","module","globals","underscore","jquery","shared/cookies","backbone","shared/feature_switch"],function(e,t,n){var i=e("globals"),r=e("underscore"),s=e("jquery"),o=e("shared/cookies"),a=e("backbone"),l=(e("shared/feature_switch"),!1),c=!1,u="email,user_location",d=r.extend({},a.Events,{onLoad:function(){var e={appId:i.FACEBOOK_APP_ID,channelUrl:"//"+window.location.host+"/channel.html",status:!0,cookie:!0,xfbml:!0,version:"v3.2"};FB.init(e),c=!0,this.trigger("facebook_initialized",FB)},loadScript:function(){if(!l){var e,t=window.document,n=t.createElement("div");e=t.createElement("script"),e.async=!0,e.src="//connect.facebook.com/en_US/sdk.js",n.setAttribute("id","fb-root"),n.appendChild(e),t.body.appendChild(n),l=!0}},before:function(e){var t=this;if(c)e(FB);else{var n=function(i){t.off("facebook_initialized",n),e(i)};this.loadScript(),this.on("facebook_initialized",n)}},onFB:function(e,t){this.before(function(n){n.Event.subscribe(e,t)})},loginStatus:function(){var e=new s.Deferred;return this.before(function(){FB.getLoginStatus(function(t){e.resolve(t)})}),e.promise()},isConnected:function(){var e=new s.Deferred;return this.loginStatus().then(function(t){"connected"===t.status?e.resolve(t):e.reject(t)}),e.promise()},login:function(e){var t=new s.Deferred;return this.before(function(){FB.login(function(e){"connected"===e.status?t.resolve(e):t.reject(e)},{scope:u})}),t.promise()},loginPages:function(e){var t=new s.Deferred;return this.before(function(){FB.login(function(e){"connected"===e.status?t.resolve(e):t.reject(e)},{scope:"pages_show_list"})}),t.promise()},approvePublish:function(e){var t=new s.Deferred,n="silence_publish_actions_"+e;return o.get(n)?(t.resolve(),t.promise()):(this.isConnected().then(function(){FB.login(function(e){"connected"===e.status?(o.set(n,1,1296e3),t.resolve(e)):t.reject(e)},{scope:"publish_actions"})}),t.promise())},logout:function(){var e=new s.Deferred,t=this;return this.before(function(){t.loginStatus().then(function(t){"connected"===t.status?FB.logout(function(t){e.resolve(t)}):e.resolve()},function(){e.resolve()})}),e.promise()},deletePermissions:function(){var e=new s.Deferred;return this.loginStatus().then(function(t){"connected"===t.status?FB.api("me/permissions","delete",function(t){!t||t.error?e.reject(t):e.resolve(t)}):e.reject()}),e.promise()},getUserInfo:function(){var e=new s.Deferred;return this.before(function(){FB.api("/me",function(t){t.error?e.reject(t):e.resolve(t)})}),e.promise()},getUserPagesInfo:function(){var e=new s.Deferred;return this.before(function(){FB.api("/me/accounts",function(t){t.error?e.reject(t):e.resolve(t)})}),e.promise()},getUserAvatar:function(){var e=new s.Deferred;return this.before(function(){FB.api("/me/picture?redirect=false&width=200&height=200",function(t){t.error?e.reject(t):e.resolve(t)})}),e.promise()},connectAccount:function(){var e,t=new s.Deferred,n=this;return this.login().then(function(t){return e=t.authResponse,n.getUserInfo()}).then(function(t){return t.username=t.name,s.post("/ajax/add/facebook-user",r.extend({},t,e))}).then(function(e){t.resolve(e)}).fail(function(){t.reject.apply(t,arguments)}),t.promise()},requestPages:function(){var e=new s.Deferred,t=this;return this.loginPages().then(function(e){return t.getUserPagesInfo()}).then(function(t){e.resolve(t)}).fail(function(){e.reject.apply(e,arguments)}),e.promise()},connectPage:function(e){var t=s.ajax({url:"/ajax/add/facebook-business-page",type:"post",data:e});return t},like:function(e){var t=new s.Deferred;return this.loginStatus().then(function(n){"connected"===n.status?FB.api("me/og.likes","post",{object:e},function(e){!e||e.error?t.reject(e):t.resolve(e)}):t.reject()}),t.promise()},share:function(e){var t=new s.Deferred;return FB.ui({method:"share",href:e},function(e){e.post_id?t.resolve(e):t.reject(e)}),t.promise()}});return window.fbAsyncInit=r.bind(d.onLoad,d),d}),define("shared/utm",["require","underscore","shared/util","shared/cookies"],function(e){var t=e("underscore"),n=e("shared/util"),i=e("shared/cookies"),r={init:function(){var e=this.getParams();t.isEmpty(e)||i.set("cm_utms_last",JSON.stringify(e))},utmMap:{utm_campaign:"UTM Campaign",utm_content:"UTM Content",utm_medium:"UTM Medium",utm_source:"UTM Source",utm_term:"UTM Term"},getParams:function(){var e=t.keys(this.utmMap);return t.pick(n.getQueryParams(),e)},getCookieLast:function(){var e=JSON.parse(i.get("cm_utms_last"));return e},getDefault:function(){if(!window.mixpanel)return{};var e={};return t(this.utmMap).forEach(function(t,n){var i=window.mixpanel.get_property(n);i&&(e[t]=i)}),e},getFirst:function(){var e=this.getDefault(),n={};return t.isEmpty(e)||t(this.utmMap).forEach(function(t,i){n[t+" First"]=e[t]||"N/A"}),n},getLast:function(){var e=this.getCookieLast(),n=this.utmMap,i={};return e&&t(n).forEach(function(t,n){var r=e[n]||"N/A";i[t+" Last"]=r}),i},isEmpty:function(){return t.isEmpty(this.getParams())}};return r.init(),r}),define("shared/models/session",["require","jquery","underscore","adamantium/model","../../event_bus","globals","apis/facebook","shared/utm"],function(e){var t=e("jquery"),n=e("underscore"),i=e("adamantium/model"),r=e("../../event_bus"),s=e("globals"),o=e("apis/facebook"),a=e("shared/utm"),l=i.extend({NAME_MIN_LEN:2,USERNAME_MIN_LENGTH:2,USERNAME_MAX_LENGTH:20,PASSWORD_MIN_LENGTH:4,PASSWORD_SIGNUP_MIN_LENGTH:8,NAME_MAX_LENGTH:128,_validating:{},_valuesChecked:{},_requesting:{},sessionDisabled:!1,sessionMethod:null,sessionSource:null,sessionModule:null,fbLoginStatus:!1,fbAuthResponse:!1,requestMethods:{facebook_signin:"/session/facebook/signin",facebook_link:"/session/facebook/link"},disable:function(){this.sessionDisabled=!0},validation:function(){var e={userName:{required:!0,minLength:this.USERNAME_MIN_LENGTH},password:{required:!0,minLength:this.PASSWORD_MIN_LENGTH}};return"signup"===this.sessionMethod&&(e=n.extend({},e,{firstName:{required:!0,minLength:this.NAME_MIN_LEN,maxLength:this.NAME_MAX_LENGTH},lastName:{required:!0,minLength:this.NAME_MIN_LEN,maxLength:this.NAME_MAX_LENGTH},email:{required:!0,pattern:"email"},password:{required:!0,minLength:this.PASSWORD_SIGNUP_MIN_LENGTH}})),e},labels:{userName:"Username",password:"Password",firstName:"First Name",lastName:"Last Name",email:"Email Address"},initialize:function(e,t){t||(t={}),this.on("sync",this.onSync,this),window.EventBus.on("session:hydrate",this.hydrate,this),window.analytics&&window.analytics._readied?this.identify():r.on("analytics:ready",this.identify,this)},isLoggedIn:function(){return!this.isNew()},url:function(){var e=this.requestMethods[this.sessionMethod];return s.isProduct?"signup"===this.sessionMethod?e+=s.purchase.isFreeGood?"/free-goods":"/product":"signin"===this.sessionMethod&&(e+="/product"):s.isBundle?e+="/product":this.sessionSource&&(e+="/"+this.sessionSource),e},toJSON:function(e){return n.extend(n.clone(this.attributes),{token:s._session_token})},fullName:function(){return this.get("firstName")+" "+this.get("lastName")},shopUrl:function(){return"/"+this.get("userName");
},numCredits:function(){return this.get("numCredits")||0},alias:function(){window.analytics.alias(this.id)},shouldFetchProperties:function(){var e=parseInt(this.get("dlt"),10);return n.isNaN(e)&&(e=0),!e||Date.now()/1e3-e>43200},identify:function(){var e=a.getFirst(),i=a.getLast(),r=APP.GLOBALS.abTests,o={URL:window.location.pathname,"Page Name":document.title,"Page Type":s.page_type_text,"Signed In":!!this.id,"Is First Time Visitor":!!this.get("ftv"),"Server Name":APP.GLOBALS.deviceInfo?APP.GLOBALS.deviceInfo.id:null};if(r&&r!==[]&&Object.keys(r).forEach(function(e){o[e]=r[e]}),n.isEmpty(e)||(window.mixpanel.register_once(e),window.mixpanel.people.set_once(e)),n.isEmpty(i)||n.extend(o,i),this.isLoggedIn()){var l={id:this.id,firstName:this.get("firstName"),lastName:this.get("lastName"),email:this.get("email"),createdAt:this.get("createdAt"),username:this.get("userName"),displayName:this.get("userName"),"User Id":this.id,"Name First":this.get("firstName"),"Name Last":this.get("lastName"),"Profile URL":"https://"+s.domain+this.get("resourcePath"),"Is Shop Owner":!!this.get("hasShop"),"Is Affiliate":!!this.get("isAffiliate"),"Credit Balance":this.numCredits()>0?Math.abs(this.numCredits()/100):0,"Digital Tax Opt In":Boolean(s.user.digitalTaxFormConsent)};n.extend(o,l),this.get("nps")&&!n.isUndefined(window.drift)&&window.drift.identify(this.id,o),this.shouldFetchProperties()?t.ajax({url:"/ajax/properties"}).then(function(e){n.isObject(e)&&n.has(e,"tracking")&&(e.tracking["Is Fraudster"]=e.tracking.isCcCustomer,delete e.tracking.isCcCustomer,n.extend(o,e.tracking))}).always(function(){window.analytics.identify(this.id,o)}):window.analytics.identify(this.id,o)}else window.analytics.identify(o)},checkAuthPane:function(){t("#modal-sign-in").is(":visible")||(this.sessionMethod="signup")},facebookSignIn:function(e,t){var i,r,a=this;this.sessionMethod="facebook_signin",this.sessionSource=e,"purchase_process"===e?this.purchase&&(this.sessionModule="Checkout - Standard",s.purchase.isFreeGood&&(this.sessionModule="Checkout - Free Good")):this.sessionModule=t||"Modal - Standard",this.trigger("facebook_auth:start"),o.login().then(function(e){return i=e.authResponse,o.getUserInfo()}).then(function(e){return r=e,o.getUserAvatar()}).then(function(e){var t=n.omit(n.extend({},i,r,{avatar:e.data}),"id");a.clear({silent:!0}),a.setProductID(),a.save(t)}).fail(n.once(n.bind(function(){this._throwFacebookError()},this)))},finishFacebookSignIn:function(){if(this.fbAuthResponse!==!1&&"connected"===this.fbLoginStatus){this.trigger("facebook_auth:start"),this.sessionMethod="facebook_signin",this.sessionSource="auto_login";var e=n.omit(this.fbAuthResponse,"id");this.clear({silent:!0}),this.setProductID(),this.save(e)}},facebookLink:function(e){this.sessionMethod="facebook_link",this.sessionSource=e,this.save()},facebookAutoLogin:function(){if(!this.sessionDisabled){var e=this;this.isLoggedIn()||o.loginStatus().then(function(t){if("connected"===t.status){e.sessionMethod="facebook_signin",e.sessionSource="auto_login";var i=n.omit(t.authResponse,"id");e.clear({silent:!0}),e.setProductID(),e.save(i)}})}},setFacebookLoginStatus:function(){var e=this;o.loginStatus().then(function(t){e.fbLoginStatus=t.status,e.fbAuthResponse=t.authResponse})},_throwFacebookError:function(e){this.trigger("facebook_auth:error",e)},setProductID:function(){s.isProduct&&this.purchase?this.set("productID",this.purchase.id,{silent:!0}):APP.GLOBALS.contextID&&"product"===APP.GLOBALS.contextType&&this.set("productID",APP.GLOBALS.contextID,{silent:!0})},track:function(e){var t={UserId:this.id,Module:this.sessionModule,url:window.location.href};switch(/^facebook/.test(this.sessionMethod)?t.Method="Facebook":t.Method="Email",this.sessionMethod){case"signin":case"facebook_signin":case"facebook_link":window.analytics.track("Signed In",t);break;case"signup":case"facebook_signup":var i=a.getLast(),r={},s={};if(n(i).forEach(function(e,t){/^UTM.*Last$/.test(t)&&(r[t.replace(/Last$/,"SU")]=e)}),!n.isEmpty(r)){var o=n.keys(r);n.extend(t,r),s.Mixpanel={peopleProperties:o,superProperties:o}}t["Affiliate Referred Sign Up"]=this.get("hasActiveAffiliate"),window.analytics.track("Signed Up",t,s)}e&&setTimeout(function(){e()},200)},authenticate:function(e,n,i){var r=new t.Deferred;e||(e="sign-in"),null==n&&(n={}),i=i||"",r.resolve(this)},sync:function(e,i,s){var o=this,a=n.extend({type:"POST",contentType:"application/x-www-form-urlencoded",url:i.url(),beforeSend:function(e){e.setRequestHeader("Accept","application/json")}},s);a.success=function(e){try{e=t.parseJSON(e)}catch(n){}if(o.set(e,{silent:!0}),e.sessionMethod&&(o.sessionMethod=e.sessionMethod),e.link_auth)r.trigger("facebook_auth:link");else{/signup/.test(o.sessionMethod)&&o.alias(),o.identify();var i=this,a=arguments;o.track(function(){s.success.apply(i,a)})}},a.error=function(e){if(403!==e.status){var t=e.responseJSON;t&&t.error&&t.error.param&&"facebook"===t.error.param&&o._throwFacebookError(),s.error&&s.error.apply(this,arguments)}},a.statusCode={},a.statusCode[403]=function(e){t("#pane-session").find("[type=submit]").hide(),t("#pane-session").append('<div class="error"><i class="svg-icon-error"></i> Something went wrong!</div><button class="btn btn-full" type="button" tabindex="3" onClick="window.location.reload();">Click Here to reload page</button>')},this.sessionDisabled&&this.set({noSession:!0},{silent:!0}),a.data={model:JSON.stringify(i.toJSON())},t.ajax(a)},onSync:function(e,t,n){this._setPurchaseRating(),this._clearPasswords()},_setPurchaseRating:function(){var e=this.get("purchase");if(this.purchase&&n.isObject(e)){var t=e.userRating;delete e.userRating,this.purchase.set(e).set("userRating",t,{silent:!0}),this.unset("purchase",{silent:!0})}},_clearPasswords:function(){this.isNew()||(this.unset("password",{silent:!0}),this.unset("passwordConfirm",{silent:!0}))},hydrate:function(e,t){this.set(e,{silent:!0}),this.sessionMethod=t,this.sessionModule="Checkout - Standard",this.identify(),this.track()}}),c=new l(s.session);return window.APP.sessionSingleton=c,c}),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("text!shared/templates/follow_btn.tmpl",[],function(){return'<a href="#" data-follow="toggle" class="btn btn-small with-text btn-follow not-loaded" data-user-id="<%= id %>">\n\t<span class="following"><i class="icon-check-large-white"></i>Following</span>\n\t<span class="follow"><i class="icon-plus-dark3"></i>Follow</span>\n</a>'}),define("shared/plugins/follow_btn",["require","exports","module","jquery","underscore","shared/models/session","../../event_bus","text!shared/templates/follow_btn.tmpl","backbone"],function(e,t,n){function i(e,t){var n="/ajax/add/user-follower/"+e;t&&(n="/ajax/rm/user-follower/"+e),r.post(n),a.trigger("follow",e,!t),t||analytics.track("Followed",{"Followee ID":e,"Follower ID":o.id})}var r=e("jquery"),s=e("underscore"),o=e("shared/models/session"),a=e("../../event_bus"),l=e("text!shared/templates/follow_btn.tmpl"),c=e("backbone");c.$=window.$,t.render=s.template(l),t.load=function(){var e,t,n=[],i=r(".btn-follow.not-loaded"),s=function(e){var t,n,r;for(t=0,n=i.length;t<n;t++)r=i.eq(t).removeClass("not-loaded").attr("data-user-id"),a.trigger("follow",r,!!e[r])};for(e=0,t=i.length;e<t;e++)n.push(i.eq(e).attr("data-user-id"));o.isLoggedIn()?n.length>0&&r.ajax({url:"/ajax/following",dataType:"json",data:{user_ids:n.join(",")},success:s}):s({})},a.on("follow",function(e,t){r(".btn-follow[data-user-id="+e+"]").toggleClass("is-following",t).toggleClass("is-not-following btn-grey",!t).blur();var n=r(".num-followers[data-user-id="+e+"]");if(n.length){var i=parseInt(n.html().replace(/,/,""),10);n.html(i+(t?1:-1))}}),r(document).on("click",'[data-follow="toggle"]',function(e){e.preventDefault();var t=r(this).data("user-id"),n=r(this).hasClass("is-following");if(!o.attributes.isAuthenticated){window.sessionStorage.setItem("postAuth","follow:"+t);const s=encodeURIComponent(window.location.pathname);return void window.location.assign("/sign-up?r="+s)}i(t,n)});const u=window.sessionStorage.hasOwnProperty("postAuth");if(u){const d=window.sessionStorage.getItem("postAuth");[delayedAction,id]=d.split(":"),"follow"===delayedAction&&(window.sessionStorage.removeItem("postAuth"),o.attributes.isAuthenticated&&i(id,!1))}r(t.load)}),define("shared/popup",["require","exports","module"],function(e,t,n){var i=window.popup=function(e){var t=($(window),e.w||400),n=e.h||300,i="undefined"!=typeof window.screenX?window.screenX:window.screenLeft,r="undefined"!=typeof window.screenY?window.screenY:window.screenTop,s="undefined"!=typeof window.outerWidth?window.outerWidth:document.documentElement.clientWidth,o="undefined"!=typeof window.outerHeight?window.outerHeight:document.documentElement.clientHeight-22,a=i<0?window.screen.width+i:i,l=parseInt(a+(s-t)/2,10),c=parseInt(r+(o-n)/2.5,10),u=window.open(e.u,e.n||"","scrollbars=no,menubar=no,resizable=yes,toolbar=no,location=no,status=yes,left="+l+",top="+c+",width="+t+",height="+n);return u&&u.focus(),u};return i}),define("shared/template_loader",["require","underscore"],function(e){var t=e("underscore"),n=function(e,t,n){this.view=e,this.options=t,this.url=n,this.templates=[]};return n.prototype.register=function(e,n){n=n&&t.once(n);var i,r=[],s=function(e){return i?e(i):void r.push(e)};return this.templates.push({name:e,callback:function(e){for(i=e;r.length;)r.pop()(e);n&&n(e)}}),s},n.prototype.reset=function(e){this.xhr&&this.xhr.abort(),this.templates=[],this.options=e||{}},n.prototype.execute=function(e){var n=this;n.xhr=$.ajax({method:n.options.server_method||"GET",url:n.url||"/ajax/render",data:{view:n.view,template:t.uniq(t.pluck(n.templates,"name")),options:JSON.stringify(n.options)},success:function(t){n.onResponse(t),e&&e()}})},n.prototype.onResponse=function(e){var n,i,r=this,s=function(e,t){for(var n=0,i=e.length;n<i;n++)e[n].callback(t)};if("string"==typeof e)return s(r.templates,e);for(n in e)e.hasOwnProperty(n)&&(i=t.filter(r.templates,{name:n}),s(i,e[n]))},n}),define("shared/keyboard",["require","underscore"],function(e){var t=e("underscore"),n=function(e){this.key=e.originalEvent.which||e.keyCode,this.typedChar=String.fromCharCode(this.key),this.shiftKey=e.shiftKey,this.ctrlKey=e.ctrlKey,this.metaKey=e.metaKey};return t.extend(n.prototype,{charCodes:{backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,esc:27,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftsuper:91,rightsuper:92,select:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalpoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},name:function(){return this.typedChar},is:function(e){return this.charCodes[e]===this.key},isNot:function(e){return!this.is(e)},isModifier:function(){return this.is("delete")||this.is("backspace")||this.is("tab")||this.is("esc")||this.is("enter")||(this.ctrlKey===!0||this.metaKey===!0)&&(this.is("a")||this.is("r")||this.is("l"))||this.is("leftsuper")||this.is("rightsuper")||this.is("select")||this.key>=35&&this.key<=39},isNotModifier:function(){return!this.isModifier()},isNotNumber:function(e){return e?this.key<48||this.key>57:this.shiftKey||(this.key<48||this.key>57)&&(this.key<96||this.key>105)},isNumber:function(){return!this.isNotANumber()}}),n}),define("adamantium/view",["require","jquery","underscore","globals","backbone","shared/template_loader","shared/feature_switch","shared/keyboard"],function(e){var t=e("jquery"),n=e("underscore"),i=(e("globals"),e("backbone")),r=e("shared/template_loader"),s=(e("shared/feature_switch"),e("shared/keyboard")),o=i.View.extend({serverView:null,serverTemplate:null,serverViewOptions:null,autoReload:!0,templateLoaderUrl:null,autoReloadDelay:100,autoPaging:!1,autoPagingKeys:["page"],autoScroll:!0,linkedViews:[],historyMethod:"replace",reloadMethod:"replace",_rendered:!1,html:function(e){return n.isUndefined(e)?this.$el.html():void this.$el.html(e)},delegateEvents:function(){var e=this.events;return"function"==typeof e&&(e=e.apply(this,[])),this.autoPaging&&(e=n.extend({},e,{"click.adamantium a[data-page]":"_onPageClick","click.adamantium [rel=next]":"_onNextClick","click.adamantium [rel=prev]":"_onPrevClick","click.adamantium [rel=more]":"_onMoreClick"})),i.View.prototype.delegateEvents.apply(this,[e])},setElement:function(){var e=i.View.prototype.setElement.apply(this,arguments),t=this.getViewOptions();return t.set(this._getViewOptions(),{silent:!0}),e},undelegateEvents:function(){return this.$el.off(".adamantium"),i.View.prototype.undelegateEvents.apply(this,arguments)},_handleKeyPress:function(e){if(!(t('a[rel="more"]').length>0)){var n=this.getViewOptions(),i=n.get("page");void 0===i&&n.set({page:1},{silent:!0});var r=new s(e);r.is("right")?this._onNextClick(e):r.is("left")&&this._onPrevClick(e)}},_onPrevClick:function(e){return!t(e.currentTarget).hasClass("disabled")&&(e.preventDefault(),void this._advance(-1))},_onNextClick:function(e){return!t(e.currentTarget).hasClass("disabled")&&(e.preventDefault(),void this._advance(1))},_onPageClick:function(e){var n=t(e.currentTarget);if(n.hasClass("disabled"))return!1;var i=parseInt(n.attr("data-page"),10);e.preventDefault(),this._page(i)},_onMoreClick:function(e){var n=this.$('a[rel="more"]');this.autoScroll=!1,this.reloadMethod="append",n.addClass("disabled"),t(".button-text",n).hide(),void 0!==this.loadingIndicator&&this.loadingIndicator.show(),e.preventDefault(),this._advance(1)},_onOptionsChange:function(){var e,t,i,r,s,o,a;if(e=this.getViewOptions(),t=n.clone(this.autoPagingKeys),t.unshift(n.keys(e.changedAttributes())),i=n.without.apply(n,t),i.length){for(r={},s=0,o=this.autoPagingKeys.length;s<o;s++)a=this.autoPagingKeys[s],"page"===a?r.page=1:r[a]=null;e.set(r,{slient:!0})}},_advance:function(e){var t=this.getViewOptions();return this._page(Math.max(1,t.get("page")+e)),!1},_page:function(e){return this.getViewOptions().set({page:e}),this._scroll=this.autoScroll,!1},setScroll:function(e){this._scroll=!!e},_textIsSelected:function(e){var t="";return window.getSelection?t=window.getSelection():document.getSelection?t=document.getSelection():document.selection&&(t=document.selection.createRange().text),e===t.toString()},_startAutoReload:function(){if(this.autoReload){var e=this,n=this.getViewOptions(),i=this._scroll,r=n.toJSON();this._scroll=!1,this.reload(r,function(){i&&(e.options&&e.options.scrollTo?t("html, body").animate({scrollTop:e.options.scrollTo},0):t("html, body").animate({scrollTop:0},0))})}},linkView:function(e,t){this.linkedViews.push({view:e,options:t})},unlinkView:function(e){for(var t=0,n=this.linkedViews.length;t<n;t++)if(this.linkedViews[t].view===e)return void this.linkedViews.splice(t,1)},appendWithProvider:function(e,n,i){var r=this;window.setTimeout(function(){e(function(e){var i=r.$('a[rel="more"]'),s=t(e),o=s.find(r.appendSelector).children(),a=s.data("options"),l=r.getViewOptions();l.set(a,{silent:!0}),r.$el.data("options",a),0!==o.length?(r.$el.find(r.appendSelector).append(o),r.trigger("reload"),t(".button-text",i).show(),i.removeClass("disabled")):i.text("No results found"),void 0!==r.loadingIndicator&&r.loadingIndicator.hide(),n&&n()})},0)},reload:function(e,n,i){var r,s,o,a,l=this,c=function(e,t,n,i){"append"===l.reloadMethod?e.appendWithProvider(a.register(e.serverTemplate),function(){n&&n()},i):e.reloadWithProvider(a.register(e.serverTemplate),function(){t&&t.once&&l.unlinkView(e),n&&n()},i)};for(e.adamantium="pageViewed",e=t.extend(l.getViewOptions().toJSON(),e),a=l._loader||(l._loader=l.constructor.createTemplateLoader()),a.reset(e),c(l,null,n,i),r=0,s=this.linkedViews.length;r<s;r++)o=this.linkedViews[r],c(o.view,o.options,i);a.execute()},reloadWithProvider:function(e,n,i){var r=this;r.trigger("before-reload"),r.model&&r.model.get("hide_loading_class")||r.$el.addClass("view-reload"),window.setTimeout(function(){r.$el.addClass("loading"),e(function(e){var s=t(e);if(r.model&&r.model.get("hide_loading_class")||s.addClass("view-reload loading"),r.$el.replaceWith(s),r.setElement(s),"undefined"==typeof i||i){var o=s.attr("data-canonical"),a=r.historyMethod&&r.historyMethod+"State";a&&o&&window.history[a]&&(window.history[a]({url:window.location.href,options:r.getViewOptions().toJSON()},null,o),r.trigger("history-update"))}window.setTimeout(function(){s.removeClass("loading"),r.trigger("reload"),n&&n()},0)})},0)},reloadHTML:function(e,n){e=t.extend(this.getViewOptions().toJSON(),e),this.constructor.loadHTML(e,n)},getViewOptions:function(){return this.serverViewOptions||(this.serverViewOptions=new i.Model(this._getViewOptions()),this.serverViewOptions.on("change",this._onOptionsChange,this),this.serverViewOptions.on("change",n.debounce(n.bind(this._startAutoReload,this),this.autoReloadDelay))),this.serverViewOptions},_getViewOptions:function(){try{return JSON.parse(this.$el.attr("data-options")||"{}")}catch(e){return{}}}},{createTemplateLoader:function(e){var t=this.prototype.serverView;if(!t)throw new Error('"serverView" property not set');return new r(t,e,this.prototype.templateLoaderUrl)},loadHTML:function(e,t){var n,i;if(n=this.prototype.serverTemplate,!n)throw new Error('"serverTemplate" property not set');i=this.createTemplateLoader(e),i.register(n,t),i.execute()},load:function(e,n){var i=this;this.loadHTML(e,function(e){var r=new i({el:t(e)});n&&n(r)})}});return o}),define("text!shared/templates/message_modal.tmpl",[],function(){return'<span class="close-btn" data-dismiss="modal"></span>\n\n<div class="send-message" data-module="New Private Message Modal">\n    <h2 style="color: #2b2927;"><%= title %></h2>\n\n    <div class="wrapper">\n        <form action="/ajax/add/message" method="post">\n            <input type="text" name="username" <% if (readOnly) { %> readonly<% } %> value="<%= recipientUsername %>" placeholder="Name" maxlength="<%= userNameMaxLength %>">\n            <div class="username-container"></div>\n            <input type="text" name="subject" value="<%= subject %>" placeholder="Subject" maxlength="<%= subjectMaxLength %>">\n            <textarea name="message-note-body" rows="1" cols="1" placeholder="Message"></textarea>\n            <button class="btn" type="submit">Send Message</button>\n        </form>\n    </div>\n</div>\n\n<div class="success" style="display: none;">\n    <h2 style="color: #2b2927;"><%= sentTitle %></h2>\n\n    <div class="wrapper">Your message has been sent to <span class="username"><%= recipientUsername %></span>. <span class="view-message"></span></div>\n</div>'}),define("text!shared/templates/loading.tmpl",[],function(){return'<span class="cm-loading">\n\t<span class="loading-dot"></span>\n\t<span class="loading-dot"></span>\n\t<span class="loading-dot"></span>\n</span>'}),define("shared/loading",["require","jquery","underscore","text!shared/templates/loading.tmpl"],function(e){var t=e("jquery"),n=e("underscore"),i=e("text!shared/templates/loading.tmpl"),r={size:"small",color:"white"},s=function(e,i){if(!e)throw new Error("el not defined - Loader needs a target element");this.options=n.extend({},r,i),this.$el=t(e),this.render()};return s.prototype.render=function(){var e=n.template(i);this.loading=t(e()),"large"===this.options.size&&this.loading.addClass("cm-loading-large"),"dark"===this.options.color&&this.loading.addClass("cm-loading-dark"),this.loading.addClass("hidden"),this.$el.append(this.loading)},s.prototype.toggle=function(e){var t=!this.loading.hasClass("hidden"),n=e?"show":"hide";if(t!==e)return this[n]()},s.prototype.show=function(){return this.loading.removeClass("hidden"),this},s.prototype.hide=function(){return this.loading.addClass("hidden"),this},s.prototype.remove=function(){return this.loading.remove(),this},s.setupButton=function(e,t){e.html("<span>"+e.html()+"</span>");var n=e.children(),i=new s(e,t),r=!1;return i.toggle=function(e){e?i.show():i.hide()},i.show=function(){if(!r){r=!0;var t=e.outerWidth();e.css({width:t||"auto"}),e.addClass("disabled"),n.hide(),s.prototype.show.apply(this,arguments)}},i.hide=function(){r&&(r=!1,n.show(),e.removeClass("disabled"),s.prototype.hide.apply(this,arguments))},i.remove=function(){n.show(),e.removeClass("disabled"),s.prototype.remove.apply(this,arguments)},i},s}),define("text!shared/templates/modal.tmpl",[],function(){return'<% if (closeBtn) { %>\n\t<div class="close-btn"></div>\n<% } %>'}),define("shared/plugins/modal",["require","exports","module","jquery","underscore","config","shared/loading","backbone","shared/models/session","../../event_bus","text!shared/templates/modal.tmpl"],function(e,t,n){var i=e("jquery"),r=e("underscore"),s=e("config"),o=e("shared/loading"),a=e("backbone"),l=e("shared/models/session"),c=e("../../event_bus"),u=(e("text!shared/templates/modal.tmpl"),function(e,t){var n=this;this.enabled=!1,this.options=t||{},this.isShowing=!1,this.hideDelay=null,this.triggerProp=null,this.$el=i(e),this.$el.on("click.dismiss.modal",'[data-dismiss="modal"]',r.bind(this.hide,this)),d.getInstance().options.preventSessionClose=t.preventSessionClose,d.getInstance().options.preventClose=t.preventClose,d.getInstance().options.disableBackdropClick=t.disableBackdropClick,d.getInstance().on("hide",function(){t&&t.backdrop!==!1&&(c.trigger("modal:cancel",n.$el.attr("id")),n.hide())}),c.on("modal:show",function(e){e!==n&&n.hide(null,{backdrop:!1})})});i.extend(u.prototype,{show:function(){if(!this.enabled){this.enabled=!0;var e=this,t=i.Event("beforeShow");if(this.$el.trigger(t),this.isShowing||t.isDefaultPrevented())return!1;this.options.disableScroll&&i("body").addClass("no-scroll"),this.options.disableBackdrop||d.show(),this._modal(),this._escape(),this._enforceFocus(),c.trigger("modal:show",this),i(window).triggerHandler("show.modal",this.$el),setTimeout(function(){e.isShowing=!0,e.$el.focus().trigger("show"),e.options.tracking&&analytics.track("Modal",r.extend(e.options.tracking,{Action:"Open",Module:e.options.method||e.options.tracking.method}))},400)}},hide:function(e,t){if((l.isLoggedIn()!==!1||this.options.preventSessionClose!==!0)&&this.options.preventClose!==!0){e&&e.preventDefault&&e.preventDefault();var n=this,s=i.Event("beforeHide");if(this.$el.trigger(s),this.isShowing&&!s.isDefaultPrevented()){if(e&&e.delay)return void(this.hideDelay=r.delay(r.bind(this.hide,this),e.delay));clearTimeout(this.hideDelay),this.enabled&&(this.enabled=!1,t&&t.backdrop===!1||d.hide(),this._modal(),i(document).off("focusin.modal"),setTimeout(r.bind(function(){c.trigger("modal:hide",n),i(window).triggerHandler("hide.modal",n.$el),n.$el.trigger("hide"),n.isShowing=!1,n.$el.addClass("hidden"),n.$el.removeClass("close")},this),400),this.options.disableScroll&&i("body").removeClass("no-scroll"),this.options.tracking&&analytics.track("Modal",r.extend(this.options.tracking,{Action:"Close"})))}}},_modal:function(){this.isShowing?this.$el.addClass("close").removeClass("visible"):(this.$el.parent().length||this.$el.appendTo(document.body),this.$el.removeClass("hidden"),this.$el[0].offsetWidth,this.$el.addClass("visible"))},_enforceFocus:function(){var e=this;i(document).on("focusin.modal",function(t){e.$el[0]===t.target||e.$el.has(t.target).length||e.$el.focus()})},_escape:function(){var e=this;this.isShowing?this.$el.off("keyup.dismiss.modal"):this.$el.on("keyup.dismiss.modal",function(t){27===t.which&&e.hide()})}}),u.show=function(){var t={};return function(n,o){if(!s||!s.modals[n])return void console.warn('No modal especified in config with the name of "'+n+'"');var a,l,c,u;return(c=t[n])?(c.show(),c.delegateEvents&&c.delegateEvents(),c):(a=i(s.modals[n]).appendTo(i("body")),u=a.attr("data-require"),u?(l=e(u),c=t[n]=new l(r.extend({el:a},o)),c.show(),c):(a.modal(o),c=t[n]=a.data("modal")))}}(),u.showRemote=function(e,t){var n,r="remote:"+e+":"+JSON.stringify(t);return s.modals.hasOwnProperty(r)?u.show(r):(n=d.getInstance(),n.show(),n.toggleLoading(!0),void i.ajax({url:"/ajax/render",data:{view:e,options:JSON.stringify(t)},complete:function(){n.toggleLoading(!1)},success:function(e){s.modals[r]=e,u.show(r,t)},error:function(){n.hide()}}))};var d=u.Backdrop=a.View.extend({events:{click:"onClickBackdrop"},initialize:function(){this.visible=!1},toggleLoading:function(e){this.loading||(this.loading=new o(this.el,{size:"large"})),this.loading.toggle(e)},render:function(){this.$el.attr({id:"modal-overlay"})},onClickBackdrop:function(){this.options.disableBackdropClick||this.hide()},show:function(){var e=this;e.visible||(e.visible=!0,e.timeout&&window.clearTimeout(e.timeout),e.$el.appendTo(document.body),e.el.offsetWidth,e.delegateEvents(),e.trigger("show"),window.setTimeout(function(){e.$el.addClass("visible")},0))},hide:function(){if((l.isLoggedIn()!==!1||this.options.preventSessionClose!==!0)&&this.options.preventClose!==!0){var e=this;e.visible&&(e.visible=!1,e.$el.removeClass("visible"),e.trigger("hide"),this.timeout=window.setTimeout(function(){e.$el.detach()},400))}}},{getInstance:function(){return d.instance=d.instance||new d,d.instance.render(),d.instance},show:function(){d.getInstance().show()},hide:function(){d.getInstance().hide()}}),h=i.fn.modal;return i.fn.modal=function(e,t){return this.each(function(){var n=i(this),s=n.data("modal"),o=r.extend({},i.fn.modal.defaults,n.data(),"object"==typeof e&&e);s||n.data("modal",s=new u(this,o)),"string"==typeof e?s[e](t||{}):o.show&&(s.options=o,s.show())})},i.fn.modal.noConflict=function(){return i.fn.modal=h,this},i.fn.modal.defaults={show:!0,overlay:!0,beforeHide:i.noop,onHide:i.noop},u}),define("shared/modals/message",["require","exports","module","jquery","underscore","adamantium/view","globals","text!shared/templates/message_modal.tmpl","shared/util","vendor/jquery/tipsy","shared/models/session","shared/plugins/modal","shared/plugins/mentions"],function(e,t,n){var i=e("jquery"),r=e("underscore"),s=e("adamantium/view"),o=e("globals"),a=e("text!shared/templates/message_modal.tmpl"),l=e("shared/util"),c=(e("vendor/jquery/tipsy"),e("shared/models/session")),u=(e("shared/plugins/modal"),e("shared/plugins/mentions")),d=!!(c&&c.attributes&&c.attributes.hasShop),h=s.extend({id:"modal-send-message",className:d?"modal":"modal extra-content",events:{"click .tag .close":"onTagClick","submit form":"onSubmitMessage"},template:r.template(a),modal:null,$tipsy:null,render:function(e){return this.options=r.extend({},this.options,e),this.html(this.template({title:this.options.title||"Send a Private Message",sentTitle:this.options.sentTitle||"Private Message Sent!",subject:this.options.subject||"",readOnly:!!this.options.readOnly,recipientUsername:this.options.recipientUsername,userNameMaxLength:c.USERNAME_MAX_LENGTH,subjectMaxLength:128,isShopOwner:d})),this._initTipsy('input[name="username"], input[name="subject"], input[name="message-note-body"], button.btn'),this.options.readOnly||this._initAutoComplete(),this},_initTipsy:function(e){this.$tipsy=this.$(e),this.$tipsy.tipsy({trigger:"manual",gravity:"w",offset:10,fade:!0,html:!0})},_initAutoComplete:function(){var e=this,t=i("body");t.on("autocompleteopen",".ui-autocomplete-input",function(){var e=i(this).data("ui-autocomplete"),t=e.menu;t.element.children().first().addClass("active"),t.option("active",1)}),t.on("hover.autocomplete.message",".ui-autocomplete .ui-menu-item",function(){e.$(".ui-menu-item").removeClass("active")}),u.fetchFollowing(r.bind(function(t){var n=[];i.each(t,function(e,t){var i=t.name;t.name!==t.username&&(i=t.name+" ("+t.username+")"),n.push({id:t.id,name:t.name,username:t.username,avatar:t.avatar,value:t.username,label:i})}),e.$field("username").autocomplete({minLength:1,source:function(e,t){var r=i.ui.autocomplete.filter(n,e.term);t(r.slice(0,10))},focus:function(e,t){return!1},select:function(t,n){return e.$field("username").hide().val(n.item.username),e.$(".username-container").html('<div class="tag">'+n.item.label+'<a href="#" class="close">×</a></div>').show(),!1}}).data("ui-autocomplete")._renderItem=function(e,t){return i("<li>").data("ui-autocomplete-item",t).append('<img src="'+t.avatar+'"><a>'+t.label+"</a>").appendTo(e)}},this))},reset:function(){this.$field("message-note-body").val(""),this.disableSubmitButton(!1),this.$(".send-message").show(),this.$(".success").hide()},show:function(e){if(!c.attributes.isAuthenticated){window.sessionStorage.setItem("postAuth","message:");const t=encodeURIComponent(window.location.pathname);return void window.location.assign("/sign-up?r="+t)}this.render(e),this.$el.modal({tracking:{Type:"New Private Message",Module:e.title}}),this.$el.removeClass("success")},hideTipsy:function(){this.$tipsy.tipsy("hide")},disableSubmitButton:function(e){var t=this.$("button.btn");t.prop("disabled",e).toggleClass("disabled",e)},onTagClick:function(e){e.preventDefault(),this.$(".username-container").hide().html(""),this.$field("username").val("").show().focus()},onSubmitMessage:function(e){e.preventDefault();var t=i(e.target),n=t.serialize();this.hideTipsy();var r=i.trim(this.$field("username").val()),s=i.trim(this.$field("subject").val()),o=i.trim(this.$field("message-note-body").val());return""===r?void l.showThenHideTipsy(this.$field("username"),"Please enter a username"):""===s?void l.showThenHideTipsy(this.$field("subject"),"Please enter a subject"):""===o?void l.showThenHideTipsy(this.$field("message-note-body"),"Please enter a message"):(this.disableSubmitButton(!0),void this.sendRequest(t.attr("action"),n))},sendRequest:function(e,t){i.post(e,t).then(r.bind(function(e){return"object"!=typeof e?this.throwError():void this.onSuccess(e)},this),r.bind(function(e){var t=JSON.parse(e.responseText);t.error?this.onError(t.error):this.throwError()},this))},throwError:function(){l.showThenHideTipsy(this.$("button.btn"),"Unknown Error"),this.disableSubmitButton(!1)},onSuccess:function(e){analytics.track("Messaged",{"Recipient Username":e.userName}),this.$(".success .wrapper span.username").html(e.userName),this.$(".success .wrapper span.view-message").html('<a href="/account/messages/'+e.messageID+'">View Message <span class="rarr">&rarr;</span></a>'),this.$el.addClass("success"),o.sendToMessage&&(window.location.href="/account/messages/"+e.messageID),this.$field("subject").val(""),this.$(".username-container").hide().html("a"),this.$field("username").show(),this.$(".send-message").hide(),this.$(".success").show(),this.hideTipsy(),this.$el.modal("hide",{delay:5e3}),i("body").off("autocompleteopen",".ui-autocomplete-input").off("hover.autocomplete.message")},onError:function(e){l.showThenHideTipsy(this.$("button.btn"),e.message),this.disableSubmitButton(!1)},$field:function(e){return this.$('form [name="'+e+'"]')}}),f=new h,p=t.showPrivateFeedbackModal=function(e){f.show({recipientUsername:e.recipientUsername,title:"Send Private Feedback",sentTitle:"Private Feedback Sent!",readOnly:!0,subject:"Feedback on "+r.escape(e.title)})};i(function(){const e=document.createElement("script");e.setAttribute("src","//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"),document.head.appendChild(e),i(document).on("click",'[data-modal="message"]',function(e){e.preventDefault(),f.show({readOnly:i(this).data("read-only"),recipientUsername:i(this).data("recipient-username")})}),i(document).on("click",'[data-modal="private-feedback"]',function(e){e.preventDefault(),p({recipientUsername:i(this).data("recipient-username"),title:i(this).data("subject")})});const t=window.sessionStorage.hasOwnProperty("postAuth");if(t){const n=window.sessionStorage.getItem("postAuth");[delayedAction,id]=n.split(":"),"message"===delayedAction&&(window.sessionStorage.removeItem("postAuth"),
c.attributes.isAuthenticated&&i('[data-modal="message"]').click())}})}),define("shared/plugins/sliders",["require","exports","module","jquery"],function(e,t,n){var i=e("jquery");i(function(){i.fn.sliders=function(e,t){return 0===this.length?this:(this.each(function(){var e=i(this),t=null,n=null,r=e.find("li"),s=r.first().width();s/(e.children().length-1);r.on("failure","img",function(){i(this).closest("li").remove(),r=e.find("li")});var o=function(e){r.removeClass("active"),i(r[e]).addClass("active")},a=function(){slide>=r.length&&(slide=0),o(slide),++slide},l=function(){n=setTimeout(function(){a(),t=setInterval(function(){a()},1300)},650)};e.on("mouseenter",function(e){slide=1,l()}),e.on("mouseout",function(e){clearTimeout(n),clearInterval(t),o(0)})}),void(t&&t()))}})}),define("shared/tracking_helper",["require","exports","module","underscore"],function(e,t,n){var i=(e("underscore"),["3D","3d","Add-Ons","Fonts","Graphics","Photos","Templates","Themes"]);t.hasSubcategory=function(e){if(0==/^[a-zA-Z0-9- ]*$/.test(e))return!0},t.formatTracking=function(e){return e.toLowerCase().split(" ").map(function(e){return e[0].toUpperCase+e.subString(1)}).join(" ").replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,"")},t.getCategory=function(e){0==e.indexOf("/")&&(e=e.replace("/",""));var t=e.split("/")[0];return t=t.charAt(0).toUpperCase()+t.slice(1)},t.getSubcategory=function(e,t){0==t.indexOf("/")&&(t=t.replace("/",""));var n=t.substring(t.indexOf("/")+1),r=n.replace(/(^|\/|-)(\S)/g,function(e){return e.toUpperCase()});return r=r.replace(/\//g," - "),r=""!=e?r+" - "+e:r,i.indexOf(r)>-1&&(r="All"),r},t.getClickedValue=function(e){var t=e.split("/").pop();return t.charAt(0).toUpperCase()+t.slice(1)}}),define("shared/plugins/share",["require","exports","module","jquery","globals","../../event_bus","shared/tracking_helper"],function(e,t){var n=e("jquery"),i=e("globals"),r=e("../../event_bus"),s=e("shared/tracking_helper"),o={shareWindow:null,initialize:function(){this.attachEvents(),this.attachShortURL()},attachEvents:function(){var e=this;n("body").on("click","a[data-share]",function(t){return e.preShare(n(this)),!1}),n("body").on("click","input[data-short-url]",function(e){var t=n(this),r=n(e.currentTarget),o={"Share Asset Type":t.data("asset-type")||i.page_type_text,Channel:"Link",Title:t.data("title")?t.data("title"):document.title,"Share Asset URL":t.data("url")||window.location.href,"Share Text":"",Module:t.closest("[data-module]").data("module")};if(i.tracking_category){var a=r.closest("li").data("directory")||n('input[name="category-directory"]').val();o.Category=s.getCategory(a),o["Sub-Category"]=s.getSubcategory("",a)}t.select(),analytics.track("Shared",o)})},attachShortURL:function(e){var t=this;n("[data-share]",e).each(function(){var e=n(this),i=e.data("share");"twitter"===i&&t.loadShortURL(n(this))}),n("[data-short-url]",e).each(function(){var e=n(this);e.val()||e.val(window.location.href),n.when(t.loadShortURL(e)).done(function(t){null!==t&&e.val(t)})})},loadShortURL:function(e){var t=e.data("url")?e.data("url"):window.location.href+"?",i=e.data("title")?e.data("title"):document.title,r="twitter"===e.data("share")?"Twitter":"Link",s=n.Deferred();return e.data("short-url")?s.resolve(e.data("short-url")||t):(n.ajax({type:"POST",url:"/ajax/short-url",data:{url:t,source:r,medium:this.getMedium(),campaign:this.getCampaign(),content:i},success:function(n){"error"===n.status?s.resolve(t):(e.data("short-url",n.short_url),s.resolve(n.short_url))},dataType:"json"}),s.promise())},share:function(e){var t,s,a,l=e.data("share"),c=e.data("url")?e.data("url"):window.location.href,u=280,d=650,h=e.data("title")?e.data("title"):document.title,f=!!e.data("short-url")&&e.data("short-url"),p="",m=e.parents("[data-module]:first").data("module"),g=e.data("asset-type")||i.page_type_text,v=new Date,y=v.getFullYear()+("0"+(v.getMonth()+1)).slice(-2);switch(l){case"facebook":s="Facebook",t="https://www.facebook.com/sharer.php?u=";break;case"pinterest":s="Pinterest",u=350,d=670,t="https://www.pinterest.com/pin/create/button/?",t+="media="+encodeURIComponent(e.data("media")),t+="&description="+encodeURIComponent(e.data("description")),t+="&url=";break;case"twitter":s="Twitter",u=252,d=500,t="https://twitter.com/share?",t+="text="+encodeURIComponent(e.data("description")),t+="&url=",p=e.data("description")}if(!e.data("skip-utm")){var b=this.getCampaign(),w=s,_=this.getMedium(),x=h.replace(/\/\s*|#/g,""),C=c.match(/\?\w+=\w+/)?"&":"?";c+=C+"utm_source="+w,c+="&utm_medium="+_,c+="&utm_campaign="+b,c+="&utm_content="+x,c+="&ts="+y}if(a=f?t+f:t+encodeURIComponent(c),this.shareWindow=popup({w:d,h:u,u:a}),this.shareWindow){var k=setInterval(function(){o.shareWindow.closed&&(clearInterval(k),r.trigger("shareWindow:closed",l,e))},500),F={"Share Asset Type":g,Channel:s,Module:m,"Share Asset URL":c,Title:h,"Share Text":p};if(i.tracking_category){for(var S=n.parseJSON(i.tracking_category.CategoryBranchJSON),T=0;T<S.length;T++){const A=T+1;F["Category - ID "+A]=S[T].id,F["Category - Level "+A]=S[T].title}F.Category=i.tracking_category.Category,F.Subcategory=i.tracking_category.Subcategory}g&&g.toLowerCase().indexOf("blog")>=0&&(F.Title=h+" ~ Creative Market Blog"),analytics.track("Shared",F)}return!1},preShare:function(e){var t=this,i=e.data("share");return"twitter"!==i?void this.share(e):void n.when(this.loadShortURL(e)).done(function(n){t.share(e)})},getCampaign:function(){return i.page_type_text+" Social Share"},getMedium:function(){return"CM Social Share"}};return o}),define("members/views/user_card",["require","vendor/jquery/tipsy","jquery","adamantium/view"],function(e){var t=(e("vendor/jquery/tipsy"),e("jquery")),n=e("adamantium/view"),i=n.extend({serverView:"card",serverTemplate:"members",templateLoaderUrl:"/members/card",initialize:function(){this.model=this.getViewOptions(),this.on("reload",this.onReload,this)},load:function(e){return this.deferred=t.Deferred(),this.model.set({userID:e}),this.deferred.promise()},onReload:function(){this.deferred.resolve(this.$el)}});return i}),define("shared/plugins/user_card",["require","exports","module","jquery","vendor/jquery/tipsy","members/views/user_card"],function(e,t){var n=e("jquery"),i=(e("vendor/jquery/tipsy"),e("members/views/user_card")),r={initialize:function(){this.attachEvents()},attachEvents:function(){var e=this;this.tipsyTimeout=!1,this.currentTarget=!1,n(document).on("mouseenter","[data-user-card]",function(t){var i=n(this);e.attachTipsy(i),e.hover(t)}),n(document).on("mouseleave","[data-user-card]",function(t){var i=n(this);e.attachTipsy(i),e.blur(t)})},attachTipsy:function(e){e.tipsy({html:!0,trigger:"manual",offset:-7,className:"user-card-tipsy",title:function(){var e=n(this).data("user-card");return n("#user-card-"+e).html()}})},hover:function(e){var t=n(e.currentTarget),i=t.data("user-card");this.currentTarget=t,n("#user-card-"+i).length>0?this.startTimeout(t):this.loadCard(t)},blur:function(e){return this.currentTarget=!1,clearTimeout(this.tipsyTimeout),!(n(e.relatedTarget).closest(".tipsy").length>0)&&void n(e.currentTarget).tipsy("hide")},loadCard:function(e){var t=new i,r=e.data("user-card"),s=this;n.when(t.load(r)).done(function(t){e.parent().append(t),s.currentTarget===e&&s.showTipsy(e)})},startTimeout:function(e){var t=this;n("[data-user-card]").tipsy("hide"),clearTimeout(this.tipsyTimeout),this.tipsyTimeout=setTimeout(function(){t.showTipsy(e)},500)},showTipsy:function(e){e.tipsy("show"),n(".tipsy").on("mouseleave",function(e){n(this).hide()}),window.cmPictureFill()}};return r}),define("shared/views/notice",["require","adamantium/view","shared/cookies"],function(e){var t=e("adamantium/view"),n=e("shared/cookies"),i=t.extend({events:{"click .dismiss":"onDismiss"},onDismiss:function(){var e=this,t=this.$el.attr("data-dismiss");t&&n.set("cmnot"+t,"1",432e3),e.$el.fadeOut(400,function(){e.remove()})}},{autoInit:function(){$(".notice-msg").each(function(){new i({el:this})})}});return i}),function(e){"function"==typeof define&&define.amd?define("vendor/backbone/backbone.stickit",["underscore","backbone","exports"],e):"object"==typeof exports?e(require("underscore"),require("backbone"),exports):e(_,Backbone,{})}(function(e,t,n){n._handlers=[],n.addHandler=function(t){t=e.map(e.flatten([t]),function(t){return e.extend({updateModel:!0,updateView:!0,updateMethod:"text"},t)}),this._handlers=this._handlers.concat(t)},n.ViewMixin={_modelBindings:null,unstickit:function(t,n){if(e.isObject(n))return void e.each(e.keys(n),function(e){this.unstickit(t,e)},this);var i=[],r=[];e.each(this._modelBindings,function(e,s){t&&e.model!==t||n&&e.config.selector!=n||(r.push(e.config._destroy),e.model.off(e.event,e.fn),i.push(e.model),delete this._modelBindings[s])},this),e.invoke(e.uniq(i),"trigger","stickit:unstuck",this.cid),e.each(e.uniq(r),function(e){e.call(this)},this),this._modelBindings=e.compact(this._modelBindings),this.$el.off(".stickit"+(t?"."+t.cid:""),n)},stickit:function(t,n){var i=t||this.model,r=n||e.result(this,"bindings")||{};this._modelBindings||(this._modelBindings=[]),this.addBinding(i,r);var s=this.remove;s.stickitWrapped||(this.remove=function(){var e=this;return this.unstickit(),s&&(e=s.apply(this,arguments)),e}),this.remove.stickitWrapped=!0},addBinding:function(t,n,i){var s,p,m,g,v,y=t||this.model,b=".stickit."+y.cid,w=i||{},_=e.uniqueId();if(!e.isString(n)){var x=n;return void e.each(x,function(e,t){this.addBinding(y,t,x[t])},this)}v=n,s=":el"===v?this.$el:this.$(v),this.unstickit(y,v),s.length&&(e.isString(w)&&(w={observe:w}),e.isFunction(w.observe)&&(w.observe=w.observe.call(this)),g=u(s,w),g.selector=v,m=g.observe,g.bindId=_,g.view=this,p=e.extend({stickitChange:g},g.setOptions),g._destroy=function(){r(this,g.destroy,s,y,g)},d(this,s,g,y,m),h(this,s,g,y,m),m&&(e.each(g.events,function(t){var n=t+b,i=function(t){var n=g.getVal.call(this,s,t,g,e.rest(arguments));o(this,g.updateModel,n,t,g)&&l(y,m,n,p,this,g)};i=e.bind(i,this),":el"===v?this.$el.on(n,i):this.$el.on(n,v,i)},this),e.each(e.flatten([m]),function(e){a(y,this,"change:"+e,g,function(e,t,n){var i=n&&n.stickitChange&&n.stickitChange.bindId||null;i!==_&&f(this,s,g,c(e,m,g,this),e)})},this),f(this,s,g,c(y,m,g,this),y,!0)),r(this,g.initialize,s,y,g))}},e.extend(t.View.prototype,n.ViewMixin);var i=function(t,n){var i=(n||"").split("."),r=e.reduce(i,function(e,t){return e[t]},t);return null==r?t:r},r=function(t,n){if(n)return(e.isString(n)?i(t,n):n).apply(t,e.rest(arguments,2))},s=function(e){return e.find("option").not(function(){return!this.selected})},o=function(t,n){return e.isBoolean(n)?n:!(!e.isFunction(n)&&!e.isString(n))&&r.apply(this,arguments)},a=function(e,t,n,i,r){e.on(n,r,t),t._modelBindings.push({model:e,event:n,fn:r,config:i})},l=function(t,n,i,s,o,a){var l={};a.onSet&&(i=r(o,a.onSet,i,a)),a.set?r(o,a.set,n,i,s,a):(l[n]=i,e.isArray(n)&&e.isArray(i)&&(l=e.reduce(n,function(t,n,r){return t[n]=e.has(i,r)?i[r]:null,t},{})),t.set(l,s))},c=function(t,n,i,s){var o,a=function(e){return t[i.escape?"escape":"get"](e)},l=function(e){return null==e?"":e};return o=e.isArray(n)?e.map(n,a):a(n),i.onGet&&(o=r(s,i.onGet,o,i)),e.isArray(o)?e.map(o,l):l(o)},u=n.getConfiguration=function(t,i){var r=[{updateModel:!1,updateMethod:"text",update:function(e,t,n,i){e[i.updateMethod]&&e[i.updateMethod](t)},getVal:function(e,t,n){return e[n.updateMethod]()}}];r=r.concat(e.filter(n._handlers,function(e){return t.is(e.selector)})),r.push(i);var s=e.extend.apply(e,r);return s.visible&&!e.has(s,"updateView")?s.updateView=!1:e.has(s,"updateView")||(s.updateView=!0),s},d=function(t,n,i,r,s){var o=["autofocus","autoplay","async","checked","controls","defer","disabled","hidden","indeterminate","loop","multiple","open","readonly","required","scoped","selected"];e.each(i.attributes||[],function(l){var u,d,h="";l=e.clone(l),u=l.observe||(l.observe=s),d=function(){var i=e.indexOf(o,l.name,!0)>-1?"prop":"attr",s=c(r,u,l,t);"class"===l.name?(n.removeClass(h).addClass(s),h=s):n[i](l.name,s)},e.each(e.flatten([u]),function(e){a(r,t,"change:"+e,i,d)}),d()})},h=function(t,n,i,s,o){if(null!=i.visible){var l=function(){var a=i.visible,l=i.visibleFn,u=c(s,o,i,t),d=!!u;(e.isFunction(a)||e.isString(a))&&(d=!!r(t,a,u,i)),l?r(t,l,n,d,i):n.toggle(d)};e.each(e.flatten([o]),function(e){a(s,t,"change:"+e,i,l)}),l()}},f=function(e,t,n,i,s,a){o(e,n.updateView,i,n)&&(r(e,n.update,t,i,s,n),a||r(e,n.afterUpdate,t,i,n))};return n.addHandler([{selector:'[contenteditable="true"]',updateMethod:"html",events:["input","change"]},{selector:"input",events:["propertychange","input","change"],update:function(e,t){e.val(t)},getVal:function(e){return e.val()}},{selector:"textarea",events:["propertychange","input","change"],update:function(e,t){e.val(t)},getVal:function(e){return e.val()}},{selector:'input[type="radio"]',events:["change"],update:function(e,t){e.filter('[value="'+t+'"]').prop("checked",!0)},getVal:function(e){return e.filter(":checked").val()}},{selector:'input[type="checkbox"]',events:["change"],update:function(n,i,r,s){if(n.length>1)i||(i=[]),n.each(function(n,r){var s=t.$(r),o=e.indexOf(i,s.val())>-1;s.prop("checked",o)});else{var o=e.isBoolean(i)?i:i===n.val();n.prop("checked",o)}},getVal:function(n){var i;if(n.length>1)i=e.reduce(n,function(e,n){var i=t.$(n);return i.prop("checked")&&e.push(i.val()),e},[]);else{i=n.prop("checked");var r=n.val();"on"!==r&&null!=r&&(i=i?n.val():null)}return i}},{selector:"select",events:["change"],update:function(n,s,o,a){var l,c=a.selectOptions,u=c&&c.collection||void 0,d=n.prop("multiple");if(!c){c={};var h=function(e){return e.map(function(){return{value:this.value,label:this.text}}).get()};n.find("optgroup").length?(u={opt_labels:[]},n.find("> option").length&&(u.opt_labels.push(void 0),e.each(n.find("> option"),function(e){u[void 0]=h(t.$(e))})),e.each(n.find("optgroup"),function(e){var n=t.$(e).attr("label");u.opt_labels.push(n),u[n]=h(t.$(e).find("option"))})):u=h(n.find("option"))}c.valuePath=c.valuePath||"value",c.labelPath=c.labelPath||"label";var f=function(n,r,s){e.each(n,function(n){var o=t.$("<option/>"),a=n,l=function(t,n){o.text(t),a=n,o.data("stickit_bind_val",a),e.isArray(a)||e.isObject(a)||o.val(a)};"__default__"===n?l(c.defaultOption.label,c.defaultOption.value):l(i(n,c.labelPath),i(n,c.valuePath)),!d&&null!=a&&null!=s&&a===s||e.isObject(s)&&e.isEqual(a,s)?o.prop("selected",!0):d&&e.isArray(s)&&e.each(s,function(t){e.isObject(t)&&(t=i(t,c.valuePath)),(t===a||e.isObject(t)&&e.isEqual(a,t))&&o.prop("selected",!0)}),r.append(o)})};n.find("*").remove();var p=function(e,t){var n=window;return 0===t.indexOf("this.")&&(n=e),t=t.replace(/^[a-z]*\.(.+)$/,"$1"),i(n,t)};if(l=e.isString(u)?p(this,u):e.isFunction(u)?r(this,u,n,a):u,l instanceof t.Collection&&(l=l.toJSON()),c.defaultOption&&f(["__default__"],n),e.isArray(l))f(l,n,s);else if(l.opt_labels)e.each(l.opt_labels,function(e){var i=t.$("<optgroup/>").attr("label",e);f(l[e],i,s),n.append(i)});else{var m,g=[];for(var v in l)m={},m[c.valuePath]=v,m[c.labelPath]=l[v],g.push(m);f(e.sortBy(g,c.comparator||c.labelPath),n,s)}},getVal:function(e){var n;return n=e.prop("multiple")?t.$(s(e).map(function(){return t.$(this).data("stickit_bind_val")})).get():s(e).data("stickit_bind_val")}}]),t.Stickit=n,t.Stickit}),define("shared/views/link_builder",["require","exports","module","jquery","backbone","vendor/backbone/backbone.stickit","event_bus"],function(e,t,n){var i=e("jquery"),r=e("backbone"),s=(e("vendor/backbone/backbone.stickit"),e("event_bus")),o=r.Model.extend({valid_campaigns:["blog_","product_","freegood_","outsidesource_","other_"],valid_sources:["CMtwitter","CMfacebook","CMgoogle","CMblog","CMlinkedin","CMpinterest","CMtumblr","CMinstagram","CMdribbble"],defaults:{short_url:"",url:"",source:"",campaign:"",source_value:""},validate:function(e,t){return _.contains(this.valid_campaigns,e.campaign)?""==e.url?"Invalid url":_.contains(this.valid_sources,e.source)?void 0:"Invalid source":"Invalid campaign"},getContextID:function(){var e=this.get("campaign"),t=document.createElement("a");t.href=this.get("url").replace(/\/+$/,"");var n=t.pathname.split("/");if("blog_"===e){if(!_.isUndefined(n[5]))return n[5]}else if(_.contains(["product_","freegood_"],e)){if(!_.isUndefined(n[2])){var i=n[2],r=i.match(/^(\d+-).*/);return i.replace(r[1],"")}}else if(_.contains(["outsidesource_","other_"],e))return this.get("source_value");return""},getMedium:function(){return"CMtwitter"===this.get("source")?"tweet":"post"},getURL:function(){var e=this.getContextID()||"";return composed_url=this.get("url")+"?"+["utm_source="+this.get("source"),"utm_medium="+this.getMedium(),"utm_campaign="+this.get("campaign")+e].join("&")},getShortURL:function(){var e=this;i.ajax({url:"/admin/ajax/link-builder",type:"GET",dataType:"text",data:{url:this.getURL()},success:function(t){e.set("short_url",t)}})}}),a=r.View.extend({events:{"click input":"handleFocus"},template:_.template('<p><strong><%= title %></strong><br><input type="text" value="<%= short_url %>" /></p>'),initialize:function(e){this.options=_.extend({},e),s.on("clear:links",function(e){this.remove()},this),this.model.on("change:short_url",this.render,this),this.model.getShortURL()},render:function(){return this.$el.html(this.template({short_url:this.model.get("short_url"),url:this.model.getURL(),source:this.model.get("source"),title:this.model.get("title")})),this},handleFocus:function(e){i(e.target).select()}}),l=r.View.extend({events:{'change [name="utm_campaign"]':"handleCampaignClick",'change [name="source"]':"handleSourceClick",'change [name="source_value"]':"handleSourceClick"},bindings:{'[name="url"]':"url",'[name="utm_campaign"]':"campaign",'[name="source_value"]':"source_value"},initialize:function(){this.model=new o,this.model.on("change:short_url",this.updateURL,this),this.model.set("url",window.location.href),this.model.on("change:url change:campaign",function(){s.trigger("clear:links")},this)},handleCampaignClick:function(e){this.$("#source-value").toggle(_.contains(["outsidesource_","other_"],i(e.target).val())).focus(),this.model.set("campaign",i(e.currentTarget).val()),this.processURLs()},handleSourceClick:function(e){s.trigger("clear:links",i(e.target).val()),this.processURLs()},processURLs:function(){var e=this;this.$('[name="source"]:checked').each(function(t){e.isValid(this)})},isValid:function(e){var t=i(e).val(),n=this.model.clone();return n.set({source:t,source_value:this.$("#source-value input").val(),title:i(e).attr("title")}),n.isValid()?void new a({model:n,source:t}).$el.appendTo(i("#links")):(alert(n.validationError),!1)}});t.init=function(){new l({el:i("#link-builder")})}}),String.prototype.includes||(String.prototype.includes=function(e,t){"use strict";return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&this.indexOf(e,t)!==-1}),define("shared/polyfills/includes_polyfill",function(){}),define("shared/likes",["require","underscore","event_bus","apis/facebook","shared/models/session","shared/tracking_helper"],function(e){var t=e("underscore"),n=e("event_bus"),i=e("apis/facebook"),r=e("shared/models/session"),s=e("shared/tracking_helper"),o={};o.toggle=function(e,o,a,l){var c=o?"like":"unlike",l=l||{};if(!r.attributes.isAuthenticated){window.sessionStorage.setItem("postAuth","like:"+e.id),window.sessionStorage.setItem("postAuthProps",JSON.stringify({product:e,url:a,trackProps:l}));const u=encodeURIComponent(window.location.pathname);return void window.location.assign("/sign-up?r="+u)}n.trigger("like:product",e,o),o&&a&&i.isConnected().then(function(){i.like(a+"?fb_ref=cm_facebook_like")});var d=e.directory?e.directory:$('input[name="category-directory"]').val(),h=s.getSubcategory("",d),f=e.certifiedStatus||null;$.post("/ajax/"+c+"/"+e.id,function(){o&&(t.extend(l,{"Product ID":e.id,"Product Name":e.title,Category:s.getCategory(d),Subcategory:h,"Certified Status":""!==f?f:null}),analytics.track("Liked",l))})},o.fetch=function(e,t){return e&&e.length&&r.isLoggedIn()?void $.ajax({type:"POST",url:"/ajax/fetch-likes",data:{products:e},success:t,error:function(){t([])}}):t([])};const a=window.sessionStorage.hasOwnProperty("postAuth");if(a){const l=window.sessionStorage.getItem("postAuth");[delayedAction,id]=l.split(":"),"like"===delayedAction&&(window.sessionStorage.removeItem("postAuth"),parsed=JSON.parse(window.sessionStorage.getItem("postAuthProps")),window.sessionStorage.removeItem("postAuthProps"),parsed.product&&parsed.url&&parsed.trackProps&&r.attributes.isAuthenticated&&o.toggle(parsed.product,!0,parsed.url,parsed.trackProps))}return o}),define("product/views/base",["require","exports","module","backbone","underscore"],function(e,t,n){var i=e("backbone"),r=e("underscore");return i.View.extend({initialize:function(){this.model&&this.model.on("change",r.bind(this.onModelChange,this))},onModelChange:function(){},assign:function(e,t){t.setElement(e),r.isFunction(t.onAssign)&&t.onAssign(),t.render()}})}),define("text!product/templates/collection/item.tmpl",[],function(){return'<div class="thumbwrap"><div class="crop-area"></div></div>\n<div class="info">\n<% if (isNew) { %>\n\t<div class="input-background"></div>\n\t<h3 class="title input"><%= title %></h3>\n<% } else { %>\n\t<h3 class="title"><%= title %></h3>\n\t<p class="items"></p>\n<% } %>\n</div>'}),define("text!product/templates/collection/num_items.tmpl",[],function(){return"<%= numItems %> Item<% if (numItems != 1) { %>s<% } %>"}),define("text!product/templates/collection/thumb.tmpl",[],function(){return'<% if (isPrivate || is_wishlist) { %>\n\t<span class="draft-overlay" original-title="This Collection is private" title="This Collection is private"></span>\n<% } %>\n<% if (thumb && thumb.src_1x){ %>\n\t<span data-src="<%= thumb.src_1x %>" data-picture="img" data-src-retina="<%= thumb.src_2x %>" class="thumbnail">\n\t\t<noscript><img src="<%= thumb.src_1x %>" class="thumbnail"></noscript>\n\t</span>\n<% } else { %>\n\t<span class="faux-img thumbnail"></span>\n<% } %>\n'}),define("product/views/collection",["require","exports","module","jquery","underscore","product/views/base","shared/tooltip","text!product/templates/collection/item.tmpl","text!product/templates/collection/num_items.tmpl","text!product/templates/collection/thumb.tmpl"],function(e,t,n){var i=e("jquery"),r=e("underscore"),s=e("product/views/base"),o=e("shared/tooltip"),a=e("text!product/templates/collection/item.tmpl"),l=e("text!product/templates/collection/num_items.tmpl"),c=e("text!product/templates/collection/thumb.tmpl");return s.extend({template:r.template(a),numItemsTemplate:r.template(l),thumbTemplate:r.template(c),active:!1,tagName:"li",className:"collection-item",parentView:null,isPrivate:!1,events:{click:"onClick","keydown .input":"onKeyDown","keyup .input":"onKeyUp"},isActive:function(){return this.active},render:function(){this.$el.html(this.template(this.model.toJSON())),this.$title=this.$(".title"),this.$background=this.$(".input-background"),this.$input=this.$(".input"),this.updateView(),this.updateThumb(),this.updateNumItems(),this.$el.find("span.draft-overlay").tipsy({offset:4}),this.$el.on("mouseover","span.draft-overlay",function(){i(this).tipsy("show").addClass("showing-tooltip")}),this.$el.on("mouseout","span.draft-overlay",function(){i(this).tipsy("hide").removeClass("showing-tooltip")})},onModelChange:function(){this.updateView()},getParentView:function(){return this.parentView},getText:function(){return i.trim(this.$input.text())},updatePlaceholder:function(){this.$background.height(this.$input.outerHeight()-5),this.$background.width(this.$input.outerWidth()+17);var e=this.getText();""===e?this.$background.text("Collection Name"):this.$background.text("")},updateThumb:function(){var e={isPrivate:this.model.get("isPrivate"),is_wishlist:this.model.get("is_wishlist"),thumb:{src_1x:this.model.getThumb("s"),src_2x:this.model.getThumb("s-r")}};this.$(".crop-area").html(i(this.thumbTemplate(e))),window.cmPictureFill()},updateNumItems:function(){var e=this.model.getNumItems();this.$(".items").text(this.numItemsTemplate({numItems:e}))},updateView:function(){this.$input.scrollTop(0),this.model.get("selected")?this.$el.addClass("selected"):this.$el.removeClass("selected")},endEdit:function(e){var t=this.getText();return""===t?1!==this.collection.length&&(this.clearValidationError(),e||this.destroy(),!1):this.model.collection.validateNewTitle(t,this.model)?(this.clearValidationError(),this.$input.removeClass("active"),this.model.set({title:t}),this.model.set({isPrivate:this.isPrivate}),this.updateView(),this.active=!1,this.blur(),!0):(this.onValidationError(),!1)},onValidationError:function(){var e="Duplicate Title";this.parentView.onError(),this.clearValidationError(),this.focus(),this.model.set({error:!0},{silent:!0}),this.$input.addClass("error"),this.$input.tipsy(r.extend({fallback:e},o.DEFAULT_OPTS)),this.$input.tipsy("show")},clearValidationError:function(){this.model.set({error:!1},{silent:!0}),this.$input.removeClass("error"),this.$input.tipsy("hide")},updateValidationError:function(){this.model.get("error")&&this.$input.tipsy("show")},onKeyDown:function(e){if(13===e.which)return this.endEdit(),e.preventDefault(),!1},onKeyUp:function(e){this.updatePlaceholder()},onClick:function(e){e.preventDefault();var t=this.model.get("isNew"),n=i(e.target);if(t&&n.closest(".title").length)this.focus();else{if(this.parentView.validateActiveViews()===!1)return!1;t&&this.$input.hasClass("active")?this.endEdit(!0):(this.model.toggleSelected(),this.updateThumb(),this.updateNumItems(),this.parentView.onSelect())}return!1},focus:function(e){return(!e||this.parentView.validateActiveViews()!==!1)&&(this.$background.show(),this.active=!0,this.$input.addClass("active"),this.$input.attr("contenteditable",!0),this.$input.text(this.getText()),this.$input.focus(),void document.execCommand("selectAll",!1,null))},blur:function(){this.$input.removeClass("active"),this.$input.blur(),this.$input.attr("contenteditable",!1),this.$input.text(this.getText()),document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this.parentView.clearError()},destroy:function(){this.$el.remove(),this.parentView.removeChild(this)}})}),define("product/models/collection",["require","exports","module","backbone","underscore","product/views/collection"],function(e,t,n){var i=e("backbone"),r=e("underscore"),s=e("product/views/collection");return i.Model.extend({view:null,defaults:{cid:null,title:"",numItems:0,thumb:null,thumbs:null,screenshot:null,selected_prev:!1,selected:!1,isNew:!1,is_wishlist:!1,isPrivate:!1,error:!1},initialize:function(){this.on("remove",r.bind(this.onRemove,this))},getView:function(){return this.view||(this.view=new s({model:this,collection:this.collection})),this.view},getNumItems:function(){var e=this.get("numItems");return this.get("selected_prev")===!1&&this.get("selected")?e+1:this.get("selected_prev")&&this.get("selected")===!1?e-1:e},getThumb:function(e){var t,n,i=this.view.getParentView().getThisThumb(),s=this.get("screenshots");return r.isNull(s)&&(s=[]),this.get("isNew")&&!this.get("selected")?null:!1===this.get("selected_prev")&&this.get("selected")&&0===this.get("numItems")?i[e]:this.get("isNew")?i[e]:(t=s[s.length-1],n=s[s.length-2],t?this.get("selected_prev")&&!1===this.get("selected")?1===this.get("numItems")?null:i[e]===t[e]?n[e]:t[e]:this.get("selected_prev")&&this.get("selected")||!1===this.get("selected_prev")&&this.get("selected")?i[e]:t[e]:null)},toggleSelected:function(){var e=this.get("selected");this.set({selected:!e})},onRemove:function(){this.view&&this.view.remove()}})}),define("product/collections/collection",["require","exports","module","backbone","underscore","product/models/collection"],function(e,t,n){var i=e("backbone"),r=e("underscore"),s=e("product/models/collection");return i.Collection.extend({thumb:null,model:s,validateNewTitle:function(e,t){var n=this.reject(function(e){return e.cid===t.cid}),i=r.map(n,function(e){return e.get("title")});return r.indexOf(i,e)===-1},getProductID:function(){return this.product.id}})}),define("product/models/view_state",["require","exports","module","backbone"],function(e,t,n){var i=e("backbone");return i.Model.extend({defaults:{loaded:!1,loading:!1,old_state:null}})}),define("text!product/templates/collection/modal.tmpl",[],function(){return'<div class="close-btn"></div>\n<div class="modal-loading-spinner"></div>\n<div class="wrapper">\n\t<h2>Manage Collections</h2>\n\t<div class="collections">\n\t\t<ul class="collections-list"></ul>\n\t</div>\n\t<div class="button-wrapper">\n\t\t<a href="#" class="btn btn-new create-new-collection">+ Create New Collection</a>\n\t\t<a href="#" class="btn add-to-collection">Save to Collection</a>\n\t</div>\n</div>'}),define("product/modals/collection",["require","exports","module","jquery","underscore","globals","shared/models/session","product/collections/collection","product/models/collection","event_bus","shared/loading","adamantium/view","product/models/view_state","shared/plugins/modal","shared/tooltip","text!product/templates/collection/modal.tmpl"],function(e,t,n){var i=e("jquery"),r=e("underscore"),s=e("globals"),o=e("shared/models/session"),a=e("product/collections/collection"),l=e("product/models/collection"),c=e("event_bus"),u=e("shared/loading"),d=e("adamantium/view"),h=e("product/models/view_state"),f=(e("shared/plugins/modal"),e("shared/tooltip")),p=e("text!product/templates/collection/modal.tmpl"),m=d.extend({_cid:0,ajaxEndpoint:"/ajax/collection",className:"modal",id:"modal-add-to-collection",loading:null,locked:!1,template:r.template(p),this_thumb:null,viewstate:new h,saveBtnText:{none:"Save Collections",single:"Save to Collection",multi:"Save to Collections"},events:{"click .create-new-collection":"createNew","click .add-to-collection":"submit","click .close-btn":"hide",click:"onClick"},initialize:function(e){this.viewstate.on("change",this.updateView,this),this.collection.on("add",this.onAdd,this),this.product=e.product},render:function(){return this.loading=new u(this.$(".modal-loading-spinner"),{size:"large",color:"dark"}),this.loading.show(),this.$button=this.$(".add-to-collection"),this.$list=this.$(".collections-list"),this},updateSubviews:function(){this.collection.map(function(e){e.getView().updateView()})},show:function(){var e=this,t="Collection";return o.isLoggedIn()?(e.html(e.template()),e.locked=!1,e.$button=e.$(".add-to-collection"),e.$list=e.$(".collections-list"),e.loading=new u(e.$(".modal-loading-spinner"),{size:"large",color:"dark"}),e.loading.show(),e.viewstate.set({loading:!0}),e.loadCollections(),e.$el.modal({tracking:{Type:"Add to Collection",Method:t}}),e.$el.on("hide",r.bind(e.onHide,e)),e.$el.on("show",r.bind(e.onShow,e)),void e.onSelect()):void alert("You must be logged in to add this to your collections!")},updateView:function(){window.cmPictureFill();var e=this.viewstate.changedAttributes();e.loading?(this.$(".modal-loading-spinner").show(),this.$(".wrapper").hide()):(this.$(".modal-loading-spinner").hide(),this.$(".wrapper").fadeIn(),this.updateSubviews(),0===this.collection.length&&this.$(".create-new-collection").trigger("click"))},loadCollections:function(){var e="/ajax/collections";this.product&&this.product.id!==!1&&(e+="?productID="+this.product.id),i.ajax(e,{dataType:"JSON",success:r.bind(function(e,t,n){var i=this.onAjax(e);this.viewstate.set({loaded:!0,loading:!1,old_state:i})},this),error:r.bind(function(e,t,n){alert("You must be logged in to add this to your collections!")},this)})},submit:function(e){if(e.preventDefault(),this.validateActiveViews()===!1)return!1;if(this.locked)return!1;this.locked=!0;var t=this.getChangedState();return c.trigger("collections:save",t),i.ajax(this.ajaxEndpoint,{type:"POST",data:{context:JSON.stringify(t),type:"Add To Collection"},success:r.bind(function(e,n,i){if(e.error)this.onSubmitFail();else{this.onSubmitSuccess();var o=this.product.certifiedStatus||null,a=r.extend(this.options.trackProps,{"Product ID":this.product.id,"Product Name":this.product.title,
Category:this.product.category,Subcategory:this.product.subCategory,Price:s.purchase?this.product.price/100:this.product.price,"Certified Status":""!==o?o:null});t.selected_collections.length&&analytics.track("Added To Collection",a),t.deselected_collections.length&&analytics.track("Removed from Collection",a),t.new_collections.forEach(function(e){analytics.track("Collection Added",{Title:e.title})})}},this),error:r.bind(function(e,t,n){this.onSubmitFail()},this)}),!1},onAjax:function(e){var t=[],n=this.product.id;return r.each(e.results,function(e){var i={cid:e.id,title:""!==e.title?e.title:"Wish List",numItems:e.numProducts,thumb:e.thumb,thumbs:e.thumbs,screenshots:e.screenshots,is_wishlist:1===e.isWishlist,isPrivate:1===e.isPrivate};r.indexOf(e.products,n)>-1&&(t.push(e.id),i.selected=!0,i.selected_prev=!0);var s=new l(i);this.collection.add(s)},this),t},onAdd:function(e){var t=e.getView();t.parentView=this,this.$list.prepend(t.$el),t.render(),e.get("isNew")&&t.focus(),t.updateView(),t.updatePlaceholder(),s.isMobile||this.$list.scrollTo(0)},onClick:function(e){return e.preventDefault(),this.validateActiveViews(),!1},onSelect:function(){var e;e=0===this.numSelected()?this.saveBtnText.none:this.numSelected()>1?this.saveBtnText.multi:this.saveBtnText.single,this.$button.text(e)},onError:function(){this.$list.addClass("error")},clearError:function(){this.$list.removeClass("error")},makeFormError:function(e){this.$(".add-to-collection");this.clearFormError();this.$button.tipsy(r.extend({fallback:e},f.DEFAULT_OPTS)),this.$button.tipsy("show")},clearFormError:function(){this.$button.tipsy("hide")},clearSubValidationErrors:function(){var e=function(e){e.getView().clearValidationError()};this.collection.map(e)},onHide:function(){this.viewstate.set({loaded:!1,loading:!1,old_state:null},{silent:!0}),this.clearSubValidationErrors(),this.remove()},onShow:function(){s.isMobile&&i(window).scrollTo(0,1)},hide:function(){this.$el.modal("hide")},onSubmitSuccess:function(){this.viewstate.set({loaded:!1,loading:!1,old_state:null},{silent:!0}),this.hide()},onSubmitFail:function(){var e="Error, please try again later";this.makeFormError(e)},createNew:function(e){if(this.validateActiveViews()){var t=new l({isNew:!0,cid:"new"+this._cid,selected:!0});this._cid++,this.collection.add(t)}return!1},removeChild:function(e){this.collection.remove(e.model)},getThisThumb:function(){return this.this_thumb},getModelAttr:function(e){return function(t){return t.get(e)}},getChangedState:function(){var e=function(e){return e.toJSON()},t=function(t){return r.pluck(r.map(t,e),"cid")},n=this.collection.filter(this.getModelAttr("isNew")),i=this.viewstate.get("old_state"),s=this.collection.filter(this.getModelAttr("selected")),o=r.filter(s,this.getModelAttr("isNew")),a=r.reject(s,this.getModelAttr("isNew")),l=r.difference(i,t(a)),c=r.difference(t(a),i),u=function(e){return""===e.get("title")};n=r.reject(n,u);var d={productID:this.product.id,new_collections:r.map(n,e),old_selected_collections:i,selected_new_collections:t(o),selected_collections:t(a),selected_collections_delta:c,deselected_collections:l};return d},numSelected:function(){return this.collection.filter(this.getModelAttr("selected")).length},validateActiveViews:function(){var e=function(e){return e.getView().isActive()},t=this.collection.filter(e),n=function(e){return e.getView().endEdit()},i=r.all(r.map(t,n,this),r.identity,this);return i?this.clearError():this.onError(),i}}),g=t.collect=function(e,t,n,i){var r=new a,s=new m({collection:r,product:e,trackProps:i||{}});s.this_thumb={s:t,"s-r":n},s.show()};t.init=function(){i(function(){i('[data-hoard="collect"]').click(function(e){e.preventDefault();var t=s.purchase,n=i(e.currentTarget).parents("[data-module]").data("module"),r=n?{Module:n}:{};s.tracking_category&&(t.category=s.tracking_category.Category,t.subCategory=s.tracking_category.Subcategory),s.purchase&&g(t,i(this).data("product-thumb"),i(this).data("product-thumb-retina"),r)})})}}),define("free_goods/views/download_button",["require","exports","module","adamantium/view","event_bus","shared/loading","shared/util"],function(e,t,n){var i=e("adamantium/view"),r=e("event_bus"),s=(e("shared/loading"),e("shared/util")),o=i.extend({_label:"",loading:null,loadingDelay:null,_isLoading:!1,directory:"",events:{click:"onClick"},initialize:function(){this.session=this.options.session,this.model.on("purchase",this.onPurchase,this).on("sync-error",this.onError,this)},disableButton:function(){this._isLoading=!0},enableButton:function(){this._isLoading=!1},registerUnload:function(){},unregisterUnload:function(){},onClick:function(e){e.preventDefault(),this.session.get("isAuthenticated")||window.location.assign("/sign-up?r=/free-goods");var t=this,n=$(e.currentTarget),i=n.data("directory"),s="Download";t.model.isFreeGood&&(s+=" - Free Good","undefined"!=typeof t.model.attributes.freeGoodType&&(s+=" "+t.model.attributes.freeGoodType)),r.trigger("directory:create",i),t.model.process().then(function(){t.model.downloadFile()})},onPurchase:function(){this.trigger("purchase"),this.enableButton()},onError:function(e,t){var n="Could not download free good";t.status&&(t=JSON.parse(t.responseText),n=t.msg),s.showThenHideTipsy(this.$el,n)}});return o}),define("shared/taxamo",["require","exports","module","jquery"],function(e,t,n){var i=e("jquery");n.exports={getTaxAmounts:function(e){e=e||{};var t=i.ajax({type:"POST",url:"/calculate-vat",dataType:"json",data:{countryID:e.countryID||0,amounts:e.amounts},beforeSend:function(){return"object"==typeof e.amounts&&!!Object.keys(e.amounts).length},dataFilter:function(e){var t=JSON.parse(e),n={countryID:0,amounts:{}};if(t.success){n.countryID=t.country_id,n.is_vat_country=t.is_vat_country;var i=t.amounts||{};for(var r in i)n.amounts[r]={amount:i[r].tax||0,signature:i[r].signature}}return JSON.stringify(n)}});return t}}}),define("product/models/purchase",["require","jquery","underscore","event_bus","backbone","globals","config","shared/taxamo","shared/feature_switch","shared/tracking_helper"],function(e){var t=e("jquery"),n=e("underscore"),i=e("event_bus"),r=e("backbone"),s=e("globals"),o=e("config"),a=e("shared/taxamo"),l=(e("shared/feature_switch"),e("shared/tracking_helper")),c=r.Model.extend({urlRoot:"/ajax/purchases",isProcessing:!1,lastExternalCharge:null,lastCreditCharge:null,lastPaymentMethod:null,lastSavedCreditCard:!1,isPurchasePending:!1,userHasTaxStatus:!1,isForced:!1,lockForceState:!1,taxSignatures:{},directory:"",initialize:function(e,t){if(t||(t={}),n.isUndefined(t.session))throw new Error("Session instance needed for Purchase Model.");this.session=t.session,this.vent=t.vent,e.countryID&&(this.userHasTaxStatus=!0),this.isFreeGood()||this.setTaxAmounts(!0),i.on("directory:create",this.onDirectoryCreate,this),i.on("directory:get",this.getDirectory,this),this.on("change:session",this._updateSession,this),this.on("sync",this.onSync,this),this.on("error",this.onError,this)},getPriceAttributeByLicenseID:function(e){return e==o.extendedLicenseID?"price_extended":"price"},getPriceAttribute:function(){return"price"},getTaxAmount:function(){return this.get("taxAmount_"+this.getPriceAttribute())||0},getKeyByIDLicenseID:function(e,t){return e+"-"+t},getLicenseIDByKey:function(e){var t=e.split("-");return t[1]},getPercentage:function(e,t){return Math.floor(100*e/t)||0},setTaxAmounts:function(e){e=e||!1;var t,n,r=this,s=o.priceMap||{},l={};l.countryID=this.get("countryID")||0,l.amounts={};for(var c in s)if(s.hasOwnProperty(c)){t=s[c],n=r.getKeyByIDLicenseID(r.id,c);var u=r.getPromoAmountSaved(6==c);u&&(t-=u),t=parseInt(t,10)||0,0!=t&&(l.amounts[n]=t)}a.getTaxAmounts(l).then(function(e){e.countryID&&r.set("countryID",e.countryID),r.lockForceState||(r.isForced=!0),r.set("isVatCountry",e.is_vat_country,{silent:!0});for(var t in e.amounts){var n=r.getLicenseIDByKey(t);r.taxSignatures[t]=e.amounts[t].signature,e.amounts.hasOwnProperty(t)&&r.set("taxAmount_"+r.getPriceAttributeByLicenseID(n),e.amounts[t].amount)}r.get("countryID")&&(r.trigger("tax_refresh"),i.trigger("reflow"))})},_updateSession:function(){var e=this.get("session");n.isObject(e)&&(this.session.set(e),this.unset("session",{silent:!0}))},setExternalMethod:function(e){this.set("method",e)},setProcessing:function(e,t){this.isProcessing=e||!1,this.trigger("isProcessing",e,t)},onDirectoryCreate:function(e){this.directory=e},getDirectory:function(){return this.directory},onSync:function(){this.setProcessing(!1,"sync")},onError:function(){this.setProcessing(!1,"error")},isPurchased:function(){return this.get("isPurchased")||!1},isFirstPurchase:function(){return this.get("isFirstPurchase")||!1},isFreeGood:function(){return this.get("isFreeGood")||!1},isSplitTransaction:function(){return this.getCreditCharge()&&this.getExternalCharge()},isCreditsTransaction:function(){return 0===this.getExternalCharge()},getCreditCharge:function(){return this._splitTransaction("credit")},getExternalMethod:function(){return this.get("method")||"creditcard"},getExternalCharge:function(){return this._splitTransaction("external")},getPaymentMethod:function(){return this.isSplitTransaction()?"Split Transaction":this.isCreditsTransaction()?"Credits":"paypal"===this.getExternalMethod()?"Paypal":"Credit Card"},getPrice:function(){return this.get("price")||0},getFloatPrice:function(){return this.getPrice()/100},getFormattedPrice:function(){var e=Math.round(this.getFloatPrice().toFixed(2));return 0===e?"&mdash;":"$"+e},getMinPrice:function(){return this.get("MIN_ORDER")||200},getMinChargePromoCode:function(){return this.get("MIN_CHARGE_PROMO_CODE")||100},getPromoCode:function(){return this.get("promoCode")||null},getBody:function(){return{}},getLicenseID:function(){return this.get("licenseID")||0},toJSON:function(){var e=n.clone(this.attributes);return e.formattedPrice=this.getFormattedPrice(),e},getPromoAmountSaved:function(e){var t=this.getPromoCode();if(e=e||!1,null!==t){var n=t.amountSaved_cents;return(6==this.get("licenseID")||e)&&(n=t.amountSaved_extended_cents),this.set("isPromoCodeApplied",!0),n}return 0},_splitTransaction:function(e){var t,i=this.session.numCredits(),r=this.getPrice(),s=this.getMinPrice(),o=this.getPromoCode(),a=0;this.get("isPromoCodeApplied")&&null!==o&&(a=this.getPromoAmountSaved(),a>0&&(r-=a,r<200&&(s=this.getMinChargePromoCode())));var l=this.getTaxAmount();return n.isNumber(l)&&0!=l&&(r+=l),t=i>=r?"credit"===e?r:0:i+s>r?"credit"===e?r-s:s:"credit"===e?i<0?0:i:i<0?r:r-i,t%100!==0?(t=(t/100).toFixed(2),retf=parseFloat(t),n.isNaN(retf)||(t=retf)):t/=100,t},_cacheTransaction:function(){this.lastExternalCharge=this.getExternalCharge(),this.lastCreditCharge=this.getCreditCharge(),this.lastPaymentMethod=this.getPaymentMethod()},process:function(){return this.setProcessing(!0),this._cacheTransaction(),this.save.apply(this,arguments)},sync:function(e,s,o){switch(o||(o={}),e){case"read":r.Model.prototype.sync.apply(this,arguments);break;default:if("update"!==e&&"create"!==e)throw new Error('Processing "'+e+'" not implemented.');var a=new t.Deferred,l=this;a.fail(function(e){l.trigger("error",l,e),l.trigger("sync-error",l,e)});var c=function(e){var r=0;l.get("isPromoCodeApplied")&&(r=l.getPromoCode().id);var c=l.isFreeGood()?"?free-good":"";if("undefined"!=typeof s.id){var u=t.ajax(n.extend({type:"POST",dataType:"json",url:s.url+c,data:{payment:JSON.stringify(n.extend({},e,{externalMethod:l.getExternalMethod(),promoCodeID:r})),model:JSON.stringify(l.getBody()),referrer:document.referrer}},o));l.lastSavedCreditCard=e&&e.saveCard||!1,u.done(function(e){l.track(function(){e&&"redirect"===e.status?window.location.href=e.url:(l.trigger("purchase",arguments),i.trigger("product:purchase",l),a.resolve.apply(this,arguments))})}),u.fail(function(e,t,n){var i={Failure:!0,"Failure Message":n?n.toString():"Unknown"};l.track(i,function(){a.reject(e)})})}};if(this.isFreeGood())c();else if(0===this.getExternalCharge())c();else if("creditcard"===this.getExternalMethod()){var u=s.session.fetchCreditCardDetails();u.done(c),u.fail(function(e,t){a.reject(t)})}else c();return a.promise()}},track:function(e,i){n.isFunction(e)&&(i=e,e={});var r={"Payment Method":this.lastPaymentMethod,Price:this.getFloatPrice(),Category:this.get("category"),Subcategory:this.get("subCategory"),"Product Name":this.get("title"),value:this.getFloatPrice(),url:window.location.href};if(t('input[name="category-directory"]').val()){var a=t('input[name="category-directory"]').val();r.Category=l.getCategory(a),r.Subcategory=l.getSubcategory("",a)}switch(this.type){case"credits":r.Type="Credits",r.label="Credits";break;case"product":if(r.Type="Product",r.label="Product",r["Product ID"]=this.id,r["Product Like Count"]=this.get("numLikes")||0,r["Product Collection Count"]=this.get("numFavorites")||0,n.isUndefined(this.get("isFirstPurchase"))||(r["Is First Purchase"]=this.get("isFirstPurchase")),s.recommendation){var c=s.recommendation.upRatings||0,u=s.recommendation.downRatings||0,d=u+c;r["Recommendations Up"]=c,r["Recommendations Down"]=u,r["Recommendations Percentage"]=d?this.getPercentage(c,d)+"%":0}var h=this.getLicenseID();h&&(r.License=o.licenses[h]);break;case"bundle":r.Type="Bundle",r.label="Bundle",r["Bundle ID"]=this.id}n.isEmpty(this.attributes.conversionPixel)||(this.isFreeGood()||analytics.track("First Purchase",{category:"product"!==this.type?this.type:this.get("category"),label:this.type,value:this.getFloatPrice()}),this.trackConversionPixel()),this.isFreeGood()&&(r.Type="Free Good",r.label="Free",r.Price=0,r.value=0);var f=this.getPromoCode();this.get("isPromoCodeApplied")&&null!==f&&(r["Discount Code"]=!0,r["Discount Amount"]=f.amountSaved),n.defaults(e,r),analytics.track("Purchased",e,{},function(){i&&i()})},trackConversionPixel:function(){if("undefined"!=typeof this.attributes.conversionPixel){var e=this.attributes.conversionPixel;analytics.track(e.facebook,{value:this.getFloatPrice(),currency:"USD"}),window.pintrk&&(pintrk("load","2613634286800"),pintrk("page"),pintrk("track",e.pinterest))}}});return c}),define("product/models/product_purchase",["require","jquery","underscore","backbone","globals","event_bus","product/models/purchase","shared/tracking_helper"],function(e){var t=e("jquery"),n=e("underscore"),i=(e("backbone"),e("globals")),r=(e("event_bus"),e("product/models/purchase")),s=e("shared/tracking_helper"),o=r.extend({type:"product",url:"/checkout",defaults:{isPurchased:!1,recommendation:!1,numLicenses:0,countryID:0},isOwner:function(){return this.get("isOwner")||!1},getPriceAttribute:function(){var e="price";return this.get("licenseID")==i.extendedLicenseID&&(e="price_extended"),e},getBody:function(){var e={id:this.get("id")},t=this.getLicenseID();n.isUndefined(t)||(e.licenseID=t);var i=this.getTaxAmount();return i>0&&(e.taxAmount=i/100),e.taxSignature=this.taxSignatures[this.getKeyByIDLicenseID(this.id,t)],e.countryID=this.get("countryID"),e.isForced=this.isForced||!1,e},downloadFile:function(){var e=t("#hiddenDownloader");e.length||(e=t("<iframe />",{id:"hiddenDownloader"}),t("body").append(e)),e.attr("src",this._downloadUri()),this.trackDownload()},_downloadUri:function(){return"https://"+i.domain+"/api/internal/download-product/"+this.id+"?pp="+(new Date).getTime()},trackDownload:function(){var e,n,i=this.get("certifiedStatus")||null;t('input[name="category-directory"]').val()?(e=t('input[name="category-directory"]').val(),n=s.getSubcategory("",e)):(e=this.getDirectory(),n=s.getSubcategory("",e)),analytics.track("Downloaded",{Type:this.get("isFreeGood")?"Free Good":"Product","Free Good Type":this.get("freeGoodType"),"Product ID":this.id,"Product Name":this.get("title"),Category:this.get("category"),Subcategory:n,"Certified Status":""!==i?i:null})}});return o}),define("text!shared/templates/thumbnail_actions.tmpl",[],function(){return'<div class="product-card-actions">\n    <% if (freeGood && freeGoodType === \'Category\') { %>\n        <button id="btn-free-good-<%= productID %>" class="btn btn-link thumbnail-action-download thumbnail-action-selected" data-free data-id="<%= productID %>" data-category="<%= productCategory %>" data-tracking="Download Free Good - <%= freeGoodType %>" data-directory="<%= productCategoryUrl %>">\n            <i aria-label="Free Download" role="img" class="download-icon-filled"></i>\n            <div class="text-container">\n                <span class="text">Download</span>\n            </div>\n        </button>\n    <% } %>\n\t<button class="btn btn-link thumbnail-action-like">\n\t\t<i aria-label="Like Product" role="img" class="svg-icon-favorites"></i>\n\t\t<div class="text-container">\n\t\t\t<span class="text">Like</span>\n\t\t</div>\n\t</button>\n\t<button class="btn btn-link thumbnail-action-favorite mobile-hidden">\n\t\t<i aria-label="Save Product" role="img" class="svg-icon-collections"></i>\n\t\t<div class="text-container">\n\t\t\t<span class="text">Save</span>\n\t\t</div>\n\t</button>\n\t<% if (!freeGood && cart && !owner && !userOwns) { %>\n\t\t<button class="btn btn-link thumbnail-action-cart mobile-hidden">\n\t\t\t<i aria-label="Add to Cart" role="img" class="cart-icon svg-icon-cart"></i>\n\t\t\t<div class="text-container">\n\t\t\t\t<span class="text">Cart</span>\n\t\t\t</div>\n\t\t</button>\n\t<% } %>\n</div>\n<a href="#" class="btn-pin-it overlay mobile-hidden" data-url="<%= url %>" data-media="<%= media %>" data-description="<%= description %>" data-share="pinterest"></a>\n\n<% if (showAdminActions && isSearchPage) { %>\n\t<div class="product-card-actions-admin">\n\t\t<button class="btn-search-judgement thumbnail-action-search-judgement" data-search-judgement-id data-search-query="<%= searchQuery %>" title="Pass search judgement">\n\t\t\t<i aria-label="Pass search judgement" role="img" class=""></i>\n\t\t</button>\n\t</div>\n<% } %>\n'}),define("text!shared/templates/cart_full_modal.tmpl",[],function(){return'<div class="Modal-inner">\n    <div class="Modal-container">\n        <div class="Modal-content">\n            <span class="close-modal" data-dismiss="modal"><i class="icon-cross-medium-dark"></i></span>\n            <h1>Your cart is full</h1>\n            <br />\n            <p>\n                Your cart already contains the maximum number of licenses.\n                Please check out before purchasing additional items.\n            </p>\n            <button class="btn btn-small" data-dismiss="modal">OK</button>\n        </div>\n    </div>\n</div>\n'}),define("shared/modals/cartFullAlert",["require","exports","module","jquery","underscore","adamantium/view","text!shared/templates/cart_full_modal.tmpl"],function(e,t,n){var i=e("jquery"),r=e("underscore"),s=e("adamantium/view"),o=e("text!shared/templates/cart_full_modal.tmpl"),a=s.extend({id:"modal-alert-modal",className:"Modal is-light is-small",template:r.template(o),modal:null,render:function(e){return this.options=r.extend({},this.options,e),this.html(this.template({})),this},show:function(e){var t=this;t.render(e),t.$el.modal({tracking:{Type:"Your cart is full",Module:"Alert Message"}}),i("#modal-overlay").remove(),i("body").on("click","#modal-alert-modal",function(e){i("#modal-alert-modal").modal("hide"),e.preventDefault()})}}),l=new a;t.showCartFullModal=function(e){l.show({readOnly:!0})}}),define("purchase_rewrite_vue/api/addProductToCart",[],function(){return function(e,t,n){return t=t||null,n=n||1,new Promise(function(i,r){$.ajax({type:"POST",url:"/purchase/cart/item",data:{productID:e,licenseID:t,quantity:n},success:function(e){i({cartItemId:e.cartItemID,numItems:e.numItems})},error:function(e){r(e.responseJSON)}})})}}),define("purchase_rewrite_vue/api/removeCartItemRequireJs",[],function(){return function(e){return new Promise(function(t,n){$.ajax({type:"DELETE",url:"/purchase/cart/item/"+e,success:function(e){t({numItems:e.numItems})},error:function(e){n(e.responseJSON)}})})}}),define("shared/views/thumbnail_actions",["require","exports","module","../../shared/polyfills/includes_polyfill","jquery","underscore","shared/likes","globals","../../event_bus","shared/feature_switch","shared/models/session","product/modals/collection","shared/tracking_helper","free_goods/views/download_button","product/models/product_purchase","text!shared/templates/thumbnail_actions.tmpl","shared/modals/cartFullAlert","purchase_rewrite_vue/api/addProductToCart","purchase_rewrite_vue/api/removeCartItemRequireJs"],function(e,t,n){e("../../shared/polyfills/includes_polyfill");var i=e("jquery"),r=e("underscore"),s=e("shared/likes"),o=e("globals"),a=e("../../event_bus"),l=e("shared/feature_switch"),c=e("shared/models/session"),u=e("product/modals/collection"),d=e("shared/tracking_helper"),h=e("free_goods/views/download_button"),f=e("product/models/product_purchase"),p=r.template(e("text!shared/templates/thumbnail_actions.tmpl")),m=e("shared/modals/cartFullAlert"),g=e("purchase_rewrite_vue/api/addProductToCart"),v=e("purchase_rewrite_vue/api/removeCartItemRequireJs"),y=function(){i(document).on("click",".thumbnail-action-like",C),i(document).on("click",".btn-search-judgement",F),i(document).on("click",".react-like",C),i(document).on("click",".thumbnail-action-favorite",k),i(document).on("click",".thumbnail-action-cart",E),a.on("search:mount:vue",b),a.on("vue:thumbnail:mount",b),a.on("like:product",A),a.on("judge:product",D),a.on("session:create",_),a.on("collections:save",T),a.on("vue:collections:save",T),c.isLoggedIn()?_():w(),postAuth=window.sessionStorage.getItem("postAuth"),postAuth&&([delayedAction,id]=postAuth.split(":"),"collect"===delayedAction&&(window.sessionStorage.removeItem("postAuth"),parsed=JSON.parse(window.sessionStorage.getItem("postAuthProps")),window.sessionStorage.removeItem("postAuthProps"),parsed.product&&parsed.trackProps&&c.attributes.isAuthenticated&&u.collect(parsed.product,parsed.src,parsed.src_retina,parsed.trackProps)))},b=function(e,t,n){return _(e,t,n)},w=function(e,t){i("[data-likeable]").each(function(){if((!i(this)[0].actionsRendered||t)&&!i(this).parents("figure.screenshot-preview").length){var n=i(this),r=n.is("a")?n:n.children("a"),s=n.data("id"),o=!1,a=!1,u="";APP.addToApp.check(["GLOBALS","user","is_admin"],APP)&&(o=APP.GLOBALS.user.is_admin),APP.addToApp.check(["GLOBALS","page_type"],APP)&&(a="search"==APP.GLOBALS.page_type),APP.addToApp.check(["GLOBALS","search","query"],APP)&&(u=APP.GLOBALS.search.query),APP.GLOBALS.productData&&n.find(".product-card-actions").length&&n.find(".product-card-actions").remove(),APP.GLOBALS.productData&&n.find(".btn-pin-it".length)&&n.find(".btn-pin-it").remove(),n[0].actionsRendered=!0;var d={url:n.attr("data-url"),media:n.attr("data-media"),owner:"0"!==n.attr("data-owner")&&""!==n.attr("data-owner")&&n.attr("data-owner"),userOwns:"0"!==n.attr("data-owned")&&""!==n.attr("data-owned")&&n.attr("data-owned"),description:n.attr("data-description"),cart:APP.GLOBALS.cartEnabled,productID:s,productCategory:n.attr("data-category"),productCategoryUrl:n.attr("data-directory"),freeGood:"0"!==n.attr("data-free-good")&&""!==n.attr("data-free-good")&&n.attr("data-free-good"),freeGoodType:n.attr("data-free-good-type"),signedIn:c.isLoggedIn(),isSearchPage:a,searchQuery:u,showAdminActions:!(!o||!l.isEnabled("fs_search-judgements"))},h=i(p(d));h.appendTo(n),I(n),r.removeClass("like-loaded"),e&&e(n,s),r.addClass("like-loaded")}})},_=t.refresh=function(e,t,n){t="undefined"!=typeof t&&t,e="undefined"!=typeof e?e:P(),x(e,n,function(e){w(function(t,i){if(r.indexOf(e.likes,i)!==-1&&(t.find(".thumbnail-action-like i").addClass("svg-icon-favorites-filled"),t.find(".thumbnail-action-like").addClass("thumbnail-action-selected"),t.find(".thumbnail-action-like .text").text("Liked")),l.isEnabled("fs_search-judgements")&&e.judgements){for(var s=0;s<e.judgements.length;s++)i===e.judgements[s].productID&&(e.judgements[s].judgement!==-1?(t.find(".thumbnail-action-search-judgement i").addClass("has-penalty"),t.find(".thumbnail-action-search-judgement").attr("title","You gave this item a penalty. Click to undo.")):t.find(".thumbnail-action-search-judgement").attr("title","Does this search result not belong here? Click to give it a penatly."));t.find(".thumbnail-action-search-judgement").data("searchQuery",n)}if(r.indexOf(e.favorites,i)!==-1&&S(t,!0),e.cartItems){var o=e.cartItems.find(function(e){return e.productID===i}),a=o?o.cartItemID:null;t.data("cartItemId",a),a&&(t.find(".thumbnail-action-cart i").addClass("svg-icon-cart-filled"),t.find(".thumbnail-action-cart").addClass("thumbnail-action-selected"),t.find(".thumbnail-action-cart .text").text("Added"))}},t)})},x=function(e,t,n){if(!e||!e.length)return n([]);var r={products:e};l.isEnabled("fs_search-judgements")&&("undefined"!=typeof t?r.textQuery=t:APP.addToApp.check(["GLOBALS","search","query"],APP)&&(r.textQuery=APP.GLOBALS.search.query)),i.ajax({type:"POST",url:"/ajax/fetch-hoarding",data:r,success:n,error:function(){n([])}})},C=function(e){var t=i(e.currentTarget),n=t.parents("[data-likeable]:first"),r=n.attr("data-canonical"),o=!t.hasClass("thumbnail-action-selected"),a=n.data("certified-status")?"Active":null,l={id:n.attr("data-id"),title:n.attr("data-title"),category:n.attr("data-category"),subCategory:n.attr("data-subcategory"),directory:n.attr("data-directory"),certifiedStatus:a};e.preventDefault(),s.toggle(l,o,r,{Module:t.attr("data-module")||"Product Thumbnail"})},k=function(e){var t,n,r=i(e.currentTarget),s=r.closest("li").attr("data-directory")||"",o=r.parents("[data-likeable]:first"),a=(o.attr("data-id"),r.parents("[data-module]").attr("data-module")),l=a?{Module:a}:{},h=o.data("certified-status")?"Active":null,f=o.find("a.thumbwrap span");if(f.length?(t=f.attr("data-src"),n=f.attr("data-src-retina")):(t=o.attr("data-src"),n=o.attr("data-src_retina")),e.preventDefault(),APP.GLOBALS.productData){var p={contextID:o.attr("data-id"),thumbnail:t,categoryParent:d.getCategory(s),category:d.getSubcategory("",s),trackingCategories:[d.getCategory(s),d.getSubcategory("",s)],price:o.attr("data-price"),title:o.attr("data-title"),certifiedStatus:h};if(c.attributes.isAuthenticated)APP.EventBus.$emit("collectionsModal:open",{id:o.attr("data-collection-modal"),product:p});else{const m=encodeURIComponent(window.location.pathname);window.location="/sign-up?r="+m}}else{var p={id:o.attr("data-id"),title:o.attr("data-title"),category:d.getCategory(s),subCategory:d.getSubcategory("",s),price:o.attr("data-price"),certifiedStatus:h};if(!c.attributes.isAuthenticated){window.sessionStorage.setItem("postAuth","collect:"+p.id),window.sessionStorage.setItem("postAuthProps",JSON.stringify({product:p,src:t,src_retina:n,trackProps:l}));const m=encodeURIComponent(window.location.pathname);return void window.location.assign("/sign-up?r="+m)}u.collect(p,t,n,l)}},F=function(e){var t=i(e.currentTarget),n=t.parents("[data-likeable]:first"),r=!t.find("i").hasClass("has-penalty"),s={id:n.attr("data-id"),title:n.attr("data-title"),category:n.attr("data-category"),subCategory:n.attr("data-subcategory"),directory:n.attr("data-directory")};e.preventDefault();var o=r?"add":"remove",l=t.data("searchQuery"),c=new URLSearchParams(window.location.search),u=c.get("categoryIDs"),d=null;null!==u&&u.length&&(u=u.split(","),d=u[u.length-1]),a.trigger("judge:product",s,r),i.post("/search-judgements/penalty/"+o,{productID:n.attr("data-id"),query:l,categoryID:d}).success(function(e){e.success===!1&&t.find("i").removeClass("has-penalty")})},S=function(e,t){var n=e.find(".thumbnail-action-favorite i");0!==n.length&&(n.parent().toggleClass("thumbnail-action-selected",t),t?n.addClass("svg-icon-collections-added"):n.removeClass("svg-icon-collections-added"),e.find(".thumbnail-action-favorite .text").html(t?"Saved":"Save"))},T=function(e){i('[data-likeable][data-id="'+e.productID+'"]').each(function(){var t=!1;(e.selected_collections.length||e.selected_new_collections.length)&&(t=!0),S(i(this),t)})},A=function(e,t){i('[data-likeable][data-id="'+e.id+'"]').each(function(){var e=i(this);i(".thumbnail-action-like",e).toggleClass("thumbnail-action-selected",t).attr("title",t?"You like this. Click to undo.":"Like this?"),i(".svg-icon-favorites",e).toggleClass("svg-icon-favorites-filled",t),e.find(".thumbnail-action-like .text").html(t?"Liked":"Like")})},D=function(e,t){i('[data-likeable][data-id="'+e.id+'"]').each(function(){var e=i(this);i(".thumbnail-action-search-judgement",e).attr("title",t?"You gave this item a penalty. Click to undo.":"Does this search result not belong here? Click to give it a penatly."),i(".thumbnail-action-search-judgement i",e).toggleClass("has-penalty",t)})},P=function(){var e=[];return i("[data-likeable]").each(function(){e.push(parseInt(i(this).attr("data-id"),10))}),r.uniq(e)},E=function(e){e.preventDefault();var t={1:"SimpleLicense",2:"GPL 2.0",3:"Standard License V1",4:"Extended License V1",5:"Standard License",6:"Extended License",7:"Personal",8:"Commercial",9:"Extended Commercial"},n=i(e.currentTarget),r=n.parents("[data-likeable]:first"),s=r.attr("data-id"),o=r.attr("data-license"),a=n.parents("[data-module]").attr("data-module"),l=r.attr("data-directory")||"";if(r.data("categories")&&r.data("categories").length>0)var c=r.data("categories")[0];var u,h={trackProps:a?{Module:a}:{},id:s,title:r.attr("data-title"),category:d.getCategory(l),subCategory:d.getSubcategory("",l),price:r.attr("data-price"),licenseSelected:t[o],licenseID:o,name:r.attr("data-title"),categories:c},f=!r.data("cartItemId");if(f)u=g(s);else{var p=r.data("cartItemId");u=v(p)}h.text=f?"Added to Cart":"Deleted Cart Item",h.module=r.attr("data-module"),M(h),u.then(function(e){var t=e.numItems;if(window.APP.EventBus.$emit("cart:changed",{numProducts:t}),r.find(".thumbnail-action-cart").toggleClass("thumbnail-action-selected",f),r.find(".thumbnail-action-cart i:first").toggleClass("svg-icon-cart-filled",f),r.find(".thumbnail-action-cart .text").html(f?"Added":"Cart"),f){var n=e.cartItemId;r.data("cartItemId",n)}else r.data("cartItemId",null);"/cart"===window.location.pathname&&window.location.reload()},function(e){10031004===e.reasonCode?m.showCartFullModal():10031005===e.reasonCode&&m.showCartFullModal()})},M=function(e){var t={"Page Type":o.page_type_text||"",Module:e.module,Type:"Product",Category:e.category,"Sub-Category":e.subCategory,Name:e.name,Price:e.price,License:e.licenseSelected,"Product ID":parseInt(e.id,10)};if(e.categories&&e.categories.length>0)for(var n=0;n<e.categories.length;n++){var i=n+1;t["Category - ID "+i]=e.categories[n].id,t["Category - Level "+i]=e.categories[n].title}analytics.track(e.text,t)},I=function(e){var t=e.find("[data-free]");if(t.length>0){var n=e.closest("li[itemscope]"),i=new f({id:n.data("id"),title:n.data("title"),category:n.data("category"),subCategory:n.data("subcategory"),freeGoodType:n.data("freeGoodType"),isFreeGood:!0},{session:c,vent:EventBus});if(t.length){new h({el:t[0],session:c,model:i})}}};i(y)}),define("shared/site_modal",["require","jquery","config","shared/plugins/modal"],function(e){var t=e("jquery"),n=e("config"),i=e("shared/plugins/modal"),r={initialize:function(){this.shouldDisplay()},shouldDisplay:function(){if(n.show_modal){var e=n.show_modal;if("welcome"===e&&window.optimizelySuppressWelcome)return;switch(window.modalTrigger){case"exit":this.showOnExit(e);break;case"first_page_exit":sessionStorage.siteViewed?this.showOnEnter(e):(this.showOnExit(e),sessionStorage.siteViewed=1);break;case"scroll":this.showOnScroll(e);break;default:this.showOnEnter(e)}}else n.show_modal_exit&&this.showOnExit(n.show_modal_exit)},showOnEnter:function(e){e&&window.setTimeout(function(){i.show(e)},window.modal_delay||0)},showOnExit:function(e){function n(){window.clearTimeout(s),s=window.setTimeout(function(){i.show(e),t(document).off({mouseleave:n,mouseenter:r})},window.modal_delay||0)}function r(){window.clearTimeout(s)}var s;t(document).on({mouseleave:n,mouseenter:r})},showOnScroll:function(e,n){var i=this,r=n||50,s=!1;t(window).scroll(function(){var n=t(window).scrollTop(),o=t(document).height(),a=t(window).height(),l=n/(o-a)*100;l>r&&!s&&(i.showOnEnter(e),
s=!0)})}};return r}),define("initialize",["require","exports","module","jquery","config","event_bus","globals","apis/facebook","shared/cookies","shared/feature_switch","shared/models/session","shared/plugins/modal","shared/plugins/share","shared/plugins/user_card","shared/views/notice","shared/views/link_builder","shared/views/thumbnail_actions","shared/site_modal"],function(e,t,n){var i=e("jquery"),r=(e("config"),e("event_bus"),e("globals"),e("apis/facebook")),s=e("shared/cookies"),o=(e("shared/feature_switch"),e("shared/models/session")),a=(e("shared/plugins/modal"),e("shared/plugins/share")),l=e("shared/plugins/user_card"),c=e("shared/views/notice"),u=e("shared/views/link_builder"),d=(e("shared/views/thumbnail_actions"),e("shared/site_modal"));return IS_TOUCH_DEVICE=!!("ontouchstart"in document.documentElement)&&/android|blackberry|iphone|ipad|ipod|iemobile/i.test(navigator.userAgent),function(){IS_TOUCH_DEVICE?i("html").addClass("touchevents"):i("html").addClass("no-touchevents")}(),function(){i("body");a.initialize(),l.initialize(),d.initialize(),c.autoInit(),u.init(),function(){if("undefined"!=typeof window.history.replaceState&&0===i("#dont-clear-notification-token").length){var e=window.location.href,t=e.replace(/[?&]n=[^?&#]+/,"");t!==e&&window.history.replaceState(null,document.title,t)}}(),i.fn.tipsy&&i("[rel=tipsy]").tipsy({gravity:"s",html:!0,fade:!0,opacity:1}),function(){function e(e,t,n){i(n).closest("#site-banner").length&&analytics.track("Clicked",{Text:"Facebook Like",Action:e,Module:"Site Banner"})}var t,n=i("#site-banner");n.length&&(t=n.data("date"),i("#site-banner .close").on("click",function(e){var n=i(".flash.flash-show");return n.length&&n.css({top:0}),i("#site-banner").fadeOut(),i("#wrap").css({paddingTop:0}),i("#wrap").removeClass("site-banner-seen"),i("#navigation-global").removeClass("has-banner"),s.set("cmsbh"+t,1,31536e3),analytics.track("Clicked",{Text:"Close Banner",Module:"Site Banner"}),!1}),i("#site-banner .pinterest-follow").on("click",function(e){analytics.track("Clicked",{Text:"Pinterest Follow",Module:"Site Banner"})}),r.onFB("edge.create",e.bind(null,"Like")),r.onFB("edge.remove",e.bind(null,"Unlike")),i("#wrap.site-banner-seen").length&&i("#wrap.site-banner-seen").css({paddingTop:n.height()}),n.hasClass("animate")&&(i("#wrap").animate({paddingTop:n.height(),delay:800,queue:!1},600,"linear"),n.show().animate({top:0,delay:800,queue:!1},600,"linear",function(){i("#wrap").css({paddingTop:n.height()})}),i("#wrap").addClass("site-banner-seen"),s.set("cmsbs"+t,1,31536e3)))}(),i("#widget-embeds input, #widget-embeds textarea").on("click",function(e){i(this).focus().select()}),o.setFacebookLoginStatus()}}),define("creativemarket",["require","jquery","underscore","globals","event_bus","shared/csrf_request","shared/extend_natives","shared/regex","shared/util","vendor/jquery/select2","vendor/jquery/tipsy","vendor/jquery/scrollto","shared/plugins/text_width","shared/plugins/auto_resize","shared/plugins/auto_resize_text_input","shared/plugins/checkbox_range","shared/plugins/mentions","shared/plugins/follow_btn","shared/popup","shared/modals/message","shared/plugins/sliders","initialize"],function(e){var t=e("jquery"),n=(e("underscore"),e("globals"),e("event_bus"),e("shared/csrf_request"),e("shared/extend_natives"),e("shared/regex")),i=e("shared/util"),r=(e("vendor/jquery/select2"),e("vendor/jquery/tipsy"),e("vendor/jquery/scrollto"),e("shared/plugins/text_width"),e("shared/plugins/auto_resize"),e("shared/plugins/auto_resize_text_input"),e("shared/plugins/checkbox_range"),e("shared/plugins/mentions"),e("shared/plugins/follow_btn"),e("shared/popup"),e("shared/modals/message"),e("shared/plugins/sliders"),e("initialize")),s={};return s.REGEX_EMAIL_ADDRESS=n.EMAIL_ADDRESS,s.REGEX_USERNAME=n.USERNAME,s.REGEX_URL=n.URL,s.toggleAll=i.toggleAll,s.confirmRedirect=i.confirmRedirect,s.formatFileSize=i.formatFileSize,s.buildAjaxUpdaterRequest=i.buildAjaxUpdaterRequest,s.goToAnchor=i.goToAnchor,s.intval=i.intval,s.truncate=i.truncate,s.md5=i.md5,s.showThenHideTipsy=i.showThenHideTipsy,s.getRandStr=i.getRandStr,t.ajaxSetup({cache:!0}),t(r),s}),define("common",["require","creativemarket"],function(e){e("creativemarket")}),function(e){"object"==typeof exports?module.exports=e(require("backbone"),require("underscore")):"function"==typeof define&&define.amd&&define("backbone.validation",["backbone","underscore"],e)}(function(e,t){return e.Validation=function(t){"use strict";var n={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},i=function(){var i=function(e,n){return e&&e[n]?t.isFunction(e[n])?e[n]():e[n]:null},s=function(e){return t.reduce(t.keys(i(e,"validation")||{}),function(e,t){return e[t]=void 0,e},{})},o=function(e,n){var r=i(e,"validation")?i(e,"validation")[n]||{}:{};return(t.isFunction(r)||t.isString(r))&&(r={fn:r}),t.isArray(r)||(r=[r]),t.reduce(r,function(e,n){return t.each(t.without(t.keys(n),"msg"),function(t){e.push({fn:l[t],val:n[t],msg:n.msg})}),e},[])},a=function(e,n,i,r){return t.reduce(o(e,n),function(t,s){var o=s.fn.call(l,i,n,s.val,e,r);return o!==!1&&t!==!1&&(o&&!t?s.msg||o:t)},"")},c=function(e,n){var i,r,s={},o=!0,l=t.clone(n);for(r in n)i=a(e,r,n[r],l),i&&(s[r]=i,o=!1);return{invalidAttrs:s,isValid:o}},u=function(e,n){return{preValidate:function(e,n){return a(this,e,n,t.extend({},this.attributes))},isValid:function(e){if(t.isString(e))return!a(this,e,this.get(e),t.extend({},this.attributes));if(t.isArray(e)){for(var n=0;n<e.length;n++)if(a(this,e[n],this.get(e[n]),t.extend({},this.attributes)))return!1;return!0}return e===!0&&this.validate(),!this.validation||this._isValid},validate:function(i,r){var o=this,a=!i,l=t.extend({},n,r),u=t.extend(s(o),o.attributes,i),d=i||u,h=c(o,u);o._isValid=h.isValid;for(var f in u){var p=h.invalidAttrs.hasOwnProperty(f),m=d.hasOwnProperty(f);p&&(m||a)&&l.invalid(e,f,h.invalidAttrs[f],l.selector),p||l.valid(e,f,l.selector)}if(t.defer(function(){o.trigger("validated",o._isValid,o,h.invalidAttrs),o.trigger("validated:"+(o._isValid?"valid":"invalid"),o,h.invalidAttrs)}),!l.forceUpdate&&t.intersection(t.keys(h.invalidAttrs),t.keys(d)).length>0)return h.invalidAttrs}}},d=function(e,n,i){t.extend(n,u(e,i))},h=function(e){delete e.validate,delete e.preValidate,delete e.isValid},f=function(e){d(this.view,e,this.options)},p=function(e){h(e)};return{version:"0.6.2",configure:function(e){t.extend(n,e)},bind:function(i,s){var o=i instanceof e.View?i.model:i,a=i.collection;if(s=t.extend({},n,r,s),"undefined"==typeof o&&"undefined"==typeof a)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";o&&d(i,o,s),a&&(a.each(function(e){d(i,e,s)}),a.bind("add",f,{view:i,options:s}),a.bind("remove",p))},unbind:function(e){var t=e.model,n=e.collection;t&&h(e.model),n&&(n.each(function(e){h(e)}),n.unbind("add",f),n.unbind("remove",p))},mixin:u(null,n)}}(),r=i.callbacks={valid:function(e,t,n){e.$("["+n+"~="+t+"]").removeClass("invalid").removeAttr("data-error")},invalid:function(e,t,n,i){e.$("["+i+"~="+t+"]").addClass("invalid").attr("data-error",n)}},s=i.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},o=i.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",pattern:"{0} must be a valid {1}"},a=i.labelFormatters={none:function(e){return e},sentenceCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toUpperCase():" "+e.toLowerCase()}).replace("_"," ")},label:function(e,t){return t.labels[e]||a.sentenceCase(e,t)}},l=i.validators=function(){var e=String.prototype.trim?function(e){return null===e?"":String.prototype.trim.call(e)}:function(e){var t=/^\s+/,n=/\s+$/;return null===e?"":e.toString().replace(t,"").replace(n,"")},i=function(e,t){return a[n.labelFormatter](e,t)},r=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.replace(/\{(\d+)\}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})},l=function(e){return t.isNumber(e)||t.isString(e)&&e.match(s.number)},c=function(n){return!(t.isNull(n)||t.isUndefined(n)||t.isString(n)&&""===e(n))};return{fn:function(e,n,i,r,s){return t.isString(i)&&(i=r[i]),i.call(r,e,n,s)},required:function(e,n,s,a,l){var u=t.isFunction(s)?s.call(a,e,n,l):s;return!(!u&&!c(e))&&(u&&!c(e)?r(o.required,i(n,a)):void 0)},acceptance:function(e,n,s,a){if("true"!==e&&(!t.isBoolean(e)||e===!1))return r(o.acceptance,i(n,a))},min:function(e,t,n,s){if(!l(e)||e<n)return r(o.min,i(t,s),n)},max:function(e,t,n,s){if(!l(e)||e>n)return r(o.max,i(t,s),n)},range:function(e,t,n,s){if(!l(e)||e<n[0]||e>n[1])return r(o.range,i(t,s),n[0],n[1])},length:function(t,n,s,a){if(!c(t)||e(t).length!==s)return r(o.length,i(n,a),s)},minLength:function(t,n,s,a){if(!c(t)||e(t).length<s)return r(o.minLength,i(n,a),s)},maxLength:function(t,n,s,a){if(!c(t)||e(t).length>s)return r(o.maxLength,i(n,a),s)},rangeLength:function(t,n,s,a){if(!c(t)||e(t).length<s[0]||e(t).length>s[1])return r(o.rangeLength,i(n,a),s[0],s[1])},oneOf:function(e,n,s,a){if(!t.include(s,e))return r(o.oneOf,i(n,a),s.join(", "))},equalTo:function(e,t,n,s,a){if(e!==a[n])return r(o.equalTo,i(t,s),i(n,s))},pattern:function(e,t,n,a){if(!c(e)||!e.toString().match(s[n]||n))return r(o.pattern,i(t,a),n)}}}();return i}(t),e.Validation}),function(e){function t(e,t){return function(n){return l(e.call(this,n),t)}}function n(e){return function(t){return this.lang().ordinal(e.call(this,t))}}function i(){}function r(e){o(this,e)}function s(e){var t=this._data={},n=e.years||e.year||e.y||0,i=e.months||e.month||e.M||0,r=e.weeks||e.week||e.w||0,s=e.days||e.day||e.d||0,o=e.hours||e.hour||e.h||0,l=e.minutes||e.minute||e.m||0,c=e.seconds||e.second||e.s||0,u=e.milliseconds||e.millisecond||e.ms||0;this._milliseconds=u+1e3*c+6e4*l+36e5*o,this._days=s+7*r,this._months=i+12*n,t.milliseconds=u%1e3,c+=a(u/1e3),t.seconds=c%60,l+=a(c/60),t.minutes=l%60,o+=a(l/60),t.hours=o%24,s+=a(o/24),s+=7*r,t.days=s%30,i+=a(s/30),t.months=i%12,n+=a(i/12),t.years=n}function o(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function a(e){return e<0?Math.ceil(e):Math.floor(e)}function l(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function c(e,t,n){var i,r=t._milliseconds,s=t._days,o=t._months;r&&e._d.setTime(+e+r*n),s&&e.date(e.date()+s*n),o&&(i=e.date(),e.date(1).month(e.month()+o*n).date(Math.min(i,e.daysInMonth())))}function u(e){return"[object Array]"===Object.prototype.toString.call(e)}function d(e,t){var n,i=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),s=0;for(n=0;n<i;n++)~~e[n]!==~~t[n]&&s++;return s+r}function h(e,t){return t.abbr=e,j[e]||(j[e]=new i),j[e].set(t),j[e]}function f(e){return e?(!j[e]&&L&&console.error("We have manually edited the code to remove moments languages. Edit the moment.js source code line 508 to re-enable them."),j[e]):E.fn._lang}function p(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function m(e){var t,n,i=e.match(N);for(t=0,n=i.length;t<n;t++)re[i[t]]?i[t]=re[i[t]]:i[t]=p(i[t]);return function(r){var s="";for(t=0;t<n;t++)s+="function"==typeof i[t].call?i[t].call(r,e):i[t];return s}}function g(e,t){function n(t){return e.lang().longDateFormat(t)||t}for(var i=5;i--&&q.test(t);)t=t.replace(q,n);return te[t]||(te[t]=m(t)),te[t](e)}function v(e){switch(e){case"DDDD":return z;case"YYYY":return B;case"YYYYY":return V;case"S":case"SS":case"SSS":case"DDD":return U;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return H;case"X":return W;case"Z":case"ZZ":return Y;case"T":return G;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return R;default:return new RegExp(e.replace("\\",""))}}function y(e,t,n){var i,r=n._a;switch(e){case"M":case"MM":r[1]=null==t?0:~~t-1;break;case"MMM":case"MMMM":i=f(n._l).monthsParse(t),null!=i?r[1]=i:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=t&&(r[2]=~~t);break;case"YY":r[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":r[0]=~~t;break;case"a":case"A":n._isPm="pm"===(t+"").toLowerCase();break;case"H":case"HH":case"h":case"hh":r[3]=~~t;break;case"m":case"mm":r[4]=~~t;break;case"s":case"ss":r[5]=~~t;break;case"S":case"SS":case"SSS":r[6]=~~(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,i=(t+"").match(Z),i&&i[1]&&(n._tzh=~~i[1]),i&&i[2]&&(n._tzm=~~i[2]),i&&"+"===i[0]&&(n._tzh=-n._tzh,n._tzm=-n._tzm)}null==t&&(n._isValid=!1)}function b(e){var t,n,i=[];if(!e._d){for(t=0;t<7;t++)e._a[t]=i[t]=null==e._a[t]?2===t?1:0:e._a[t];i[3]+=e._tzh||0,i[4]+=e._tzm||0,n=new Date(0),e._useUTC?(n.setUTCFullYear(i[0],i[1],i[2]),n.setUTCHours(i[3],i[4],i[5],i[6])):(n.setFullYear(i[0],i[1],i[2]),n.setHours(i[3],i[4],i[5],i[6])),e._d=n}}function w(e){var t,n,i=e._f.match(N),r=e._i;for(e._a=[],t=0;t<i.length;t++)n=(v(i[t]).exec(r)||[])[0],n&&(r=r.slice(r.indexOf(n)+n.length)),re[i[t]]&&y(i[t],n,e);e._isPm&&e._a[3]<12&&(e._a[3]+=12),e._isPm===!1&&12===e._a[3]&&(e._a[3]=0),b(e)}function _(e){for(var t,n,i,s,a=99;e._f.length;){if(t=o({},e),t._f=e._f.pop(),w(t),n=new r(t),n.isValid()){i=n;break}s=d(t._a,n.toArray()),s<a&&(a=s,i=n)}o(e,i)}function x(e){var t,n=e._i;if(J.exec(n)){for(e._f="YYYY-MM-DDT",t=0;t<4;t++)if(X[t][1].exec(n)){e._f+=X[t][0];break}Y.exec(n)&&(e._f+=" Z"),w(e)}else e._d=new Date(n)}function C(t){var n=t._i,i=$.exec(n);n===e?t._d=new Date:i?t._d=new Date((+i[1])):"string"==typeof n?x(t):u(n)?(t._a=n.slice(0),b(t)):t._d=n instanceof Date?new Date((+n)):new Date(n)}function k(e,t,n,i,r){return r.relativeTime(t||1,!!n,e,i)}function F(e,t,n){var i=O(Math.abs(e)/1e3),r=O(i/60),s=O(r/60),o=O(s/24),a=O(o/365),l=i<45&&["s",i]||1===r&&["m"]||r<45&&["mm",r]||1===s&&["h"]||s<22&&["hh",s]||1===o&&["d"]||o<=25&&["dd",o]||o<=45&&["M"]||o<345&&["MM",O(o/30)]||1===a&&["y"]||["yy",a];return l[2]=t,l[3]=e>0,l[4]=n,k.apply({},l)}function S(e,t,n){var i=n-t,r=n-e.day();return r>i&&(r-=7),r<i-7&&(r+=7),Math.ceil(E(e).add("d",r).dayOfYear()/7)}function T(e){var t=e._i,n=e._f;return null===t||""===t?null:("string"==typeof t&&(e._i=t=f().preparse(t)),E.isMoment(t)?(e=o({},t),e._d=new Date((+t._d))):n?u(n)?_(e):w(e):C(e),new r(e))}function A(e,t){E.fn[e]=E.fn[e+"s"]=function(e){var n=this._isUTC?"UTC":"";return null!=e?(this._d["set"+n+t](e),this):this._d["get"+n+t]()}}function D(e){E.duration.fn[e]=function(){return this._data[e]}}function P(e,t){E.duration.fn["as"+e]=function(){return+this/t}}for(var E,M,I="2.0.0",O=Math.round,j={},L="undefined"!=typeof module&&module.exports,$=/^\/?Date\((\-?\d+)/i,N=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,q=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,R=/\d\d?/,U=/\d{1,3}/,z=/\d{3}/,B=/\d{1,4}/,V=/[+\-]?\d{1,6}/,H=/[0-9]*[a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF]+\s*?[\u0600-\u06FF]+/i,Y=/Z|[\+\-]\d\d:?\d\d/i,G=/T/i,W=/[\+\-]?\d+(\.\d{1,3})?/,J=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,K="YYYY-MM-DDTHH:mm:ssZ",X=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Z=/([\+\-]|\d\d)/gi,Q="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),ee={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},te={},ne="DDD w W M D d".split(" "),ie="M D H h m s w W".split(" "),re={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return l(this.year()%100,2)},YYYY:function(){return l(this.year(),4)},YYYYY:function(){return l(this.year(),5)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return l(~~(this.milliseconds()/10),2)},SSS:function(){return l(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+l(~~(e/60),2)+":"+l(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+l(~~(10*e/6),4)},X:function(){return this.unix()}};ne.length;)M=ne.pop(),re[M+"o"]=n(re[M]);for(;ie.length;)M=ie.pop(),re[M+M]=t(re[M],2);for(re.DDDD=t(re.DDD,3),i.prototype={set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,i;for(this._monthsParse||(this._monthsParse=[]),t=0;t<12;t++)if(this._monthsParse[t]||(n=E([2e3,t]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(i.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,i){var r=this._relativeTime[n];return"function"==typeof r?r(e,t,n,i):r.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return S(e,this._week.dow,this._week.doy)},_week:{dow:0,doy:6}},E=function(e,t,n){return T({_i:e,_f:t,_l:n,_isUTC:!1})},E.utc=function(e,t,n){return T({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},E.unix=function(e){return E(1e3*e)},E.duration=function(e,t){var n,i=E.isDuration(e),r="number"==typeof e,o=i?e._data:r?{}:e;return r&&(t?o[t]=e:o.milliseconds=e),n=new s(o),i&&e.hasOwnProperty("_lang")&&(n._lang=e._lang),n},E.version=I,E.defaultFormat=K,E.lang=function(e,t){return e?(t?h(e,t):j[e]||f(e),void(E.duration.fn._lang=E.fn._lang=f(e))):E.fn._lang._abbr},E.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),f(e)},E.isMoment=function(e){return e instanceof r},E.isDuration=function(e){return e instanceof s},E.fn=r.prototype={clone:function(){return E(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._d},toJSON:function(){return E.utc(this).format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return null==this._isValid&&(this._a?this._isValid=!d(this._a,(this._isUTC?E.utc(this._a):E(this._a)).toArray()):this._isValid=!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){var t=g(this,e||E.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return n="string"==typeof e?E.duration(+t,e):E.duration(e,t),c(this,n,1),this},subtract:function(e,t){var n;return n="string"==typeof e?E.duration(+t,e):E.duration(e,t),c(this,n,-1),this},diff:function(e,t,n){var i,r,s=this._isUTC?E(e).utc():E(e).local(),o=6e4*(this.zone()-s.zone());return t&&(t=t.replace(/s$/,"")),"year"===t||"month"===t?(i=432e5*(this.daysInMonth()+s.daysInMonth()),r=12*(this.year()-s.year())+(this.month()-s.month()),r+=(this-E(this).startOf("month")-(s-E(s).startOf("month")))/i,"year"===t&&(r/=12)):(i=this-s-o,r="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?i/864e5:"week"===t?i/6048e5:i),n?r:a(r)},from:function(e,t){return E.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(E(),e)},calendar:function(){var e=this.diff(E().startOf("day"),"days",!0),t=e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this))},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<E([this.year()]).zone()||this.zone()<E([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null==e?t:this.add({d:e-t})},startOf:function(e){switch(e=e.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.day(0),this},endOf:function(e){return this.startOf(e).add(e.replace(/s?$/,"s"),1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+E(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+E(e).startOf(t)},isSame:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)===+E(e).startOf(t)},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return E.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var t=O((E(this).startOf("day")-E(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},isoWeek:function(e){var t=S(this,1,4);return null==e?t:this.add("d",7*(e-t))},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},lang:function(t){return t===e?this._lang:(this._lang=f(t),this)}},M=0;M<Q.length;M++)A(Q[M].toLowerCase().replace(/s$/,""),Q[M]);A("year","FullYear"),E.fn.days=E.fn.day,E.fn.weeks=E.fn.week,E.fn.isoWeeks=E.fn.isoWeek,E.duration.fn=s.prototype={weeks:function(){return a(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*this._months},humanize:function(e){var t=+this,n=F(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},lang:E.fn.lang};for(M in ee)ee.hasOwnProperty(M)&&(P(M,ee[M]),D(M.toLowerCase()));P("Weeks",6048e5),E.lang("en",{ordinal:function(e){var t=e%10,n=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),L&&(module.exports=E),"undefined"==typeof ender&&(this.moment=E),"function"==typeof define&&define.amd&&define("moment",[],function(){return E})}.call(this),function(e){e.fn.shorten=function(t){"use strict";if(e(this).data("jquery.shorten"))return!1;e(this).data("jquery.shorten",!0);var n={showChars:100,ellipsesText:"...",moreText:"more",lessText:"less",errMsg:null};return t&&e.extend(n,t),e(document).off("click",".morelink"),e(document).on({click:function(){var t=e(this);return t.hasClass("less")?(t.removeClass("less"),t.html(n.moreText),t.parent().prev().prev().show(),t.parent().prev().hide()):(t.addClass("less"),t.html(n.lessText),t.parent().prev().prev().hide(),t.parent().prev().show()),!1}},".morelink"),this.each(function(){var t=e(this),i=t.html(),r=t.text().length;if(r>n.showChars){var s=i.substr(0,n.showChars);if(s.indexOf("<")>=0){for(var o=!1,a="",l=0,c=[],u=null,d=0,h=0;h<=n.showChars;d++)if("<"!=i[d]||o||(o=!0,u=i.substring(d+1,i.indexOf(">",d)),"/"==u[0]?u!="/"+c[0]?n.errMsg="ERROR en HTML: the top of the stack should be the tag that closes":c.shift():"br"!=u.toLowerCase()&&c.unshift(u)),o&&">"==i[d]&&(o=!1),o)a+=i.charAt(d);else if(h++,l<=n.showChars)a+=i.charAt(d),l++;else if(c.length>0){for(j=0;j<c.length;j++)a+="</"+c[j]+">";break}s=e("<div/>").html(a+'<span class="ellip">'+n.ellipsesText+"</span>").html()}var f='<div class="shortcontent">'+s+'</div><div class="allcontent">'+i+'</div><span><a href="javascript://nop/" class="morelink">'+n.moreText+"</a></span>";t.html(f),t.find(".allcontent").hide(),e(".shortcontent p:last",t).css("margin-bottom",0)}})}}(jQuery),define("shorten",function(){}),define("shared/form",["require","jquery","underscore"],function(e){var t={},n=e("jquery"),i=e("underscore"),r=i.template('<div class="marker-error marker-error-left notvisible" data-error="<%= error %>"><i class="icon-exclamation-mark"></i></div>');return t.setError=function(e,n,i){e.toggleClass("input-error",!!n),t.setMarker(e,n,i)},t.setMarker=function(e,t,n){e[0];t?this.addMarker(e,t,n):this.removeMarker(e)},t.removeMarker=function(e){var t=e[0].$marker;t&&(t.tipsy("hide"),t.remove())},t.addMarker=function(e,i,s){s=n.extend({side:"left"},s),e[0].$marker&&t.removeMarker(e);var o=n(r({error:i}));e[0].$marker=o;var a=e.position();o.insertAfter(e).css({position:"absolute",top:a.top+e.outerHeight()/2-o.height()/2}),"right"===s.side?o.removeClass("marker-error-left").css({left:a.left+e.outerWidth()-3}):o.css({left:-o.width()+3}),o.tipsy({title:"data-error",gravity:"left"===s.side?"e":"w",offset:8,fade:!0,fadeSpeed:400}),o.stop().animate({opacity:1},400)},t.clearErrors=function(e){n(".input-error").removeClass("input-error");var t=n(".marker-error",e);t.tipsy("hide").remove()},t.reskinCheckboxes=function(e){var t=function(e,t,n,i){e.prop("checked",n),t.toggleClass("cm-checkbox-checked",n),"undefined"!=typeof i&&t.toggleClass("disabled",i)};n("input[type=checkbox]",e).each(function(){if(!this.skinned){this.skinned=!0;var e=n(this).hide(),i=n("<span>").addClass("cm-checkbox"),r=e.is(":checked"),s=e.hasClass("disabled"),o=e.attr("value");o&&"on"!==o||(o="1"),e[0].$skinned=i,i[0].$input=e,i.insertBefore(e),e.attr("value",o),t(e,i,r,s)}}),e.on("change","input[type=checkbox]",function(e){if(!e||!e.emulated){var i=n(this),r=i[0].$skinned;r&&t(i,r,i.is(":checked"),i.hasClass("disabled"))}}),e.on("tap click",".cm-checkbox",function(e){if(!n(this).hasClass("disabled")){var i=n(this),r=i[0].$input||n(),s=!r.is(":checked");return t(r,i,s),r.trigger("change",{emulated:!0}),!1}}),e.on("tap click",".checkbox-group",function(e){return n(e.target).hasClass("cm-checkbox")||n(".cm-checkbox",this).trigger("click"),!1})},t.reskinRadioButtons=function(e){var t={},i=function(e,t,n,i){e.prop("checked",n),t.toggleClass("cm-radiobtn-checked",n),"undefined"!=typeof i&&t.toggleClass("disabled",i)};n("input[type=radio]",e).each(function(){if(!this.skinned){this.skinned=!0;var e=n(this).hide(),r=e.is(":checked"),s=e.attr("name")||"",o=e.hasClass("disabled"),a=n("<span>").addClass("cm-radiobtn");e[0].$skinned=a,a[0].$input=e,a.insertBefore(e),i(e,a,r,o),t.hasOwnProperty(s)||(t[s]=[]),t[s].push(a)}}),e.on("change","input[type=radio]",function(e){if(!e||!e.emulated){var t=n(this),r=t[0].$skinned;r&&i(t,r,t.is(":checked"),t.hasClass("disabled"))}}),e.on("tap click",".cm-radiobtn",function(){if(!n(this).hasClass("disabled")){for(var e=n(this),r=e[0].$input||n(),s=r.attr("name")||"",o=t[s]||[],a=0;a<o.length;a++)o[a][0]!==this&&o[a].removeClass("cm-radiobtn-checked");return i(r,e,!0),r.trigger("change",{emulated:!0}),!1}}),e.on("tap click",".radiobtn-group",function(e){return n(e.target).hasClass("cm-radiobtn")||n(".cm-radiobtn",this).trigger("click"),!1})},t.init=function(e){e=n(e),t.reskinCheckboxes(e),t.reskinRadioButtons(e)},t}),function(e){"function"==typeof define&&define.amd?define("vendor/transit",["jquery"],e):e(jQuery)}(function(e){"use strict";function t(e){var t=["Moz","Webkit","O","ms"],n=e.charAt(0).toUpperCase()+e.substr(1);if(e in d.style)return e;for(var i=0;i<t.length;++i){var r=t[i]+n;if(r in d.style)return r}}function n(){return d.style[h.transform]="",d.style[h.transform]="rotateY(90deg)",""!==d.style[h.transform]}function i(e){return"string"==typeof e&&this.parse(e),this}function r(e,t,n){t===!0?e.queue(n):t?e.queue(t,n):n()}function s(t){var n=[];for(var i in t)t.hasOwnProperty(i)&&(i=e.camelCase(i),i=e.transit.propertyMap[i]||i,i=l(i)),e.inArray(i,n)===-1&&n.push(i);return n}function o(t,n,i,r){var o=s(t);e.cssEase[i]&&(i=e.cssEase[i]);var a=""+u(n)+" "+i;parseInt(r,10)>0&&(a+=" "+u(r));for(var l=[],c=0;c<o.length;c++){var d=o[c];
l.push(d+" "+a)}return l.join(", ")}function a(t,n){n||(e.cssNumber[t]=!0),e.transit.propertyMap[t]=h.transform,e.cssHooks[t]={get:function(n){var i=e(n).css("transit:transform");return i.get(t)},set:function(n,i){var r=e(n),s=r.css("transit:transform");s.setFromString(t,i),r.css("transit:transform",s)}}}function l(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function c(e,t){return"string"!=typeof e||e.match(/^[\-0-9\.]+$/)?""+e+t:e}function u(t){var n=t;return e.fx.speeds[n]&&(n=e.fx.speeds[n]),c(n,"ms")}e.transit={version:"0.1.3",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var d=document.createElement("div"),h={},f=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;h.transition=t("transition"),h.transitionDelay=t("transitionDelay"),h.transform=t("transform"),h.transformOrigin=t("transformOrigin"),h.transform3d=n(),e.extend(e.support,h);var p={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},m=h.transitionEnd=p[h.transition]||null;d=null,e.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)"},e.cssHooks["transit:transform"]={get:function(t){return e(t).data("transform")||new i},set:function(t,n){var r=n;r instanceof i||(r=new i(r)),"WebkitTransform"!==h.transform||f?t.style[h.transform]=r.toString():t.style[h.transform]=r.toString(!0),e(t).data("transform",r)}},e.fn.jquery<"1.8.0"&&(e.cssHooks.transformOrigin={get:function(e){return e.style[h.transformOrigin]},set:function(e,t){e.style[h.transformOrigin]=t}},e.cssHooks.transition={get:function(e){return e.style[h.transition]},set:function(e,t){e.style[h.transition]=t}}),a("scale"),a("translate"),a("rotate"),a("rotateX"),a("rotateY"),a("rotate3d"),a("perspective"),a("skewX"),a("skewY"),a("x",!0),a("y",!0),i.prototype={setFromString:function(e,t){var n="string"==typeof t?t.split(","):t.constructor===Array?t:[t];n.unshift(e),i.prototype.set.apply(this,n)},set:function(e){var t=Array.prototype.slice.apply(arguments,[1]);this.setter[e]?this.setter[e].apply(this,t):this[e]=t.join(",")},get:function(e){return this.getter[e]?this.getter[e].apply(this):this[e]||0},setter:{rotate:function(e){this.rotate=c(e,"deg")},rotateX:function(e){this.rotateX=c(e,"deg")},rotateY:function(e){this.rotateY=c(e,"deg")},scale:function(e,t){void 0===t&&(t=e),this.scale=e+","+t},skewX:function(e){this.skewX=c(e,"deg")},skewY:function(e){this.skewY=c(e,"deg")},perspective:function(e){this.perspective=c(e,"px")},x:function(e){this.set("translate",e,null)},y:function(e){this.set("translate",null,e)},translate:function(e,t){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==e&&(this._translateX=c(e,"px")),null!==t&&(this._translateY=c(t,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var e=(this.scale||"1,1").split(",");return e[0]&&(e[0]=parseFloat(e[0])),e[1]&&(e[1]=parseFloat(e[1])),e[0]===e[1]?e[0]:e},rotate3d:function(){for(var e=(this.rotate3d||"0,0,0,0deg").split(","),t=0;t<=3;++t)e[t]&&(e[t]=parseFloat(e[t]));return e[3]&&(e[3]=c(e[3],"deg")),e}},parse:function(e){var t=this;e.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(e,n,i){t.setFromString(n,i)})},toString:function(e){var t=[];for(var n in this)if(this.hasOwnProperty(n)){if(!h.transform3d&&("rotateX"===n||"rotateY"===n||"perspective"===n||"transformOrigin"===n))continue;"_"!==n[0]&&(e&&"scale"===n?t.push(n+"3d("+this[n]+",1)"):e&&"translate"===n?t.push(n+"3d("+this[n]+",0)"):t.push(n+"("+this[n]+")"))}return t.join(" ")}},e.fn.transition=e.fn.transit=function(t,n,i,s){var a=this,l=0,c=!0;"function"==typeof n&&(s=n,n=void 0),"function"==typeof i&&(s=i,i=void 0),"undefined"!=typeof t.easing&&(i=t.easing,delete t.easing),"undefined"!=typeof t.duration&&(n=t.duration,delete t.duration),"undefined"!=typeof t.complete&&(s=t.complete,delete t.complete),"undefined"!=typeof t.queue&&(c=t.queue,delete t.queue),"undefined"!=typeof t.delay&&(l=t.delay,delete t.delay),"undefined"==typeof n&&(n=e.fx.speeds._default),"undefined"==typeof i&&(i=e.cssEase._default),n=u(n);var d=o(t,n,i,l),f=e.transit.enabled&&h.transition,p=f?parseInt(n,10)+parseInt(l,10):0;if(0===p){var g=function(e){a.css(t),s&&s.apply(a),e&&e()};return r(a,c,g),a}var v={},y=function(n){var i=!1,r=function(){if(i&&a.unbind(m,r),p>0)for(var e=0;e<a.length;e++){var t=a[e];t.style[h.transition]=v[t]||null}"function"==typeof s&&s.apply(a),"function"==typeof n&&n()};p>0&&m&&e.transit.useTransitionEnd?(i=!0,a.bind(m,r)):window.setTimeout(r,p);for(var o=0;o<a.length;o++){var l=a[o];p>0&&(l.style[h.transition]=d),e(l).css(t)}},b=function(e){var t=0;"MozTransition"===h.transition&&t<25&&(t=25),window.setTimeout(function(){y(e)},t)};return r(a,c,b),this},e.transit.getTransitionValue=o});